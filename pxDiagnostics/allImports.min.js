var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var d=0,e={next:function(){if(d<a.length){var c=d++;return{value:b(c,a[c]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill=function(a,b,d,e){if(b){d=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var c=a[e];c in d||(d[c]={});d=d[c]}a=a[a.length-1];e=d[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.polyfill("Array.prototype.entries",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,d){return[a,d]})}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(d,e,c){return d==a&&"q"==e&&c==b}}));return!0===b.q}catch(d){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();
$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(u){return!1}}function d(){}function e(a){if(!$jscomp.owns(a,f)){var b=new d;$jscomp.defineProperty(a,f,{value:b})}}function c(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof d)return a;e(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var f="$jscomp_hidden_"+Math.random();c("freeze");c("preventExtensions");c("seal");var l=0,q=function(a){this.id_=(l+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};q.prototype.set=function(a,b){e(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=b;return this};q.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};q.prototype.has=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};q.prototype.delete=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return q},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(n){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var d=new WeakMap,e=function(a){this.data_={};this.head_=l();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};e.prototype.set=function(a,b){a=0===a?0:a;var d=c(this,a);d.list||(d.list=this.data_[d.id]=[]);d.entry?d.entry.value=b:(d.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},d.list.push(d.entry),this.head_.previous.next=d.entry,this.head_.previous=d.entry,this.size++);return this};e.prototype.delete=function(a){a=c(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};e.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=l();this.size=0};e.prototype.has=function(a){return!!c(this,a).entry};
e.prototype.get=function(a){return(a=c(this,a).entry)&&a.value};e.prototype.entries=function(){return f(this,function(a){return[a.key,a.value]})};e.prototype.keys=function(){return f(this,function(a){return a.key})};e.prototype.values=function(){return f(this,function(a){return a.value})};e.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var c=function(a,b){var c=b&&typeof b;"object"==
c||"function"==c?d.has(b)?c=d.get(b):(c=""+ ++q,d.set(b,c)):c="p_"+b;var e=a.data_[c];if(e&&$jscomp.owns(a.data_,c))for(a=0;a<e.length;a++){var f=e[a];if(b!==b&&f.key!==f.key||b===f.key)return{id:c,list:e,index:a,entry:f}}return{id:c,list:e,index:-1,entry:void 0}},f=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},l=function(){var a={};return a.previous=
a.next=a.head=a},q=0;return e},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,d){return d})}},"es8","es3");$jscomp.checkStringArgs=function(a,b,d){if(null==a)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,d){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var c=b.length,f=a.length;d=Math.max(0,Math.min(d|0,b.length));for(var l=0;l<f&&d<c;)if(b[d++]!=a[l++])return!1;return l>=f}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(a,d){var b=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===d&&(d=b.length);d=Math.max(0,Math.min(d|0,b.length));for(var c=a.length;0<c&&0<d;)if(b[--d]!=a[--c])return!1;return 0>=c}},"es6","es3");
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(a){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var e="";a;)if(a&1&&(e+=b),a>>>=1)b+=b;return e}},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function d(a){return a instanceof c?a:new c(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var e=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){e(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(m){this.asyncThrow_(m)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var c=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(g){b.reject(g)}};c.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};c.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof c)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};c.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(g){this.reject_(g);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};c.prototype.reject_=function(a){this.settle_(2,a)};c.prototype.fulfill_=function(a){this.settle_(1,a)};c.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};c.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var f=new b;c.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};c.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(m){c.reject(m)}};c.prototype.then=function(a,b){function d(a,b){return"function"==typeof a?function(b){try{e(a(b))}catch(x){f(x)}}:b}var e,f,l=new c(function(a,b){e=a;f=b});this.callWhenSettled_(d(a,e),d(b,f));return l};
c.prototype.catch=function(a){return this.then(void 0,a)};c.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};c.resolve=d;c.reject=function(a){return new c(function(b,c){c(a)})};c.race=function(a){return new c(function(b,c){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())d(f.value).callWhenSettled_(b,
c)})};c.all=function(a){var b=$jscomp.makeIterator(a),e=b.next();return e.done?d([]):new c(function(a,c){function f(b){return function(c){l[b]=c;g--;0==g&&a(l)}}var l=[],g=0;do l.push(void 0),g++,d(e.value).callWhenSettled_(f(l.length-1),c),e=b.next();while(!e.done)})};return c},"es6","es3");
$jscomp.polyfill("Array.from",function(a){return a?a:function(a,d,e){d=null!=d?d:function(a){return a};var b=[],f="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if("function"==typeof f){a=f.call(a);for(var l=0;!(f=a.next()).done;)b.push(d.call(e,f.value,l++))}else for(f=a.length,l=0;l<f;l++)b.push(d.call(e,a[l],l));return b}},"es6","es3");var Options={debug:"off",emulation:"off"};module.exports.Options=Options;
var BtUtils={parseBool:function(a){switch(String(a).toLowerCase()){case "1":case "on":case "yes":case "true":a=!0;break;default:a=!1}return a},isEmpty:function(a){return 0===Object.keys(a).length},sprintf:function(a){for(var b=1;b<arguments.length;b++)a=a.replace(/%[sd]/,arguments[b]);return a}};module.exports.BtUtils=BtUtils;
var requireEnabled=BtUtils.parseBool(Options.require),fs=null,filename="bt-audio-in-log.txt",Logger=function(){var a=function(a){for(var b=1;b<arguments.length;b++)a=a.replace(/%[sd]/,arguments[b]);return a},b=function(){var a=new Date,b=a.getMonth(),c=a.getDate(),f=a.getHours(),l=a.getMinutes(),q=a.getSeconds(),g=("00"+a.getMilliseconds()).slice(-3);return a.getFullYear()+"-"+(9<b?"":"0")+b+"-"+(9<c?"":"0")+c+" "+(9<f?"":"0")+f+":"+(9<l?"":"0")+l+":"+(9<q?"":"0")+q+":"+g};this._log_stream=null;this.log=
function(){var d=this.constructor.name;var e={left:"(",right:") "};if(this.hasOwnProperty("identity")){d=this.identity.hasOwnProperty("name")?this.identity.name:d;var c=this.identity.hasOwnProperty("marker")?this.identity.marker:e}else c=e;e=arguments.length;d=c.left+d+c.right;if(arguments.hasOwnProperty("0")&&"string"===typeof arguments[0])arguments[0]=d+arguments[0];else{for(c=Object.keys(arguments).length;0<c;c--)arguments[c]=arguments[c-1];arguments[0]=d;arguments.length===e&&(arguments.length+=
1)}console.log.apply(this,arguments);e=a.apply(this,arguments);this._log_stream&&typeof("function"===this._log_stream)&&this._log_stream(e);requireEnabled&&fs&&(e="["+b()+"] "+e+"\n",fs.appendFile(filename,e,function(a){if(a)throw a;}))}};module.exports.Logger=Logger;var BaseEventManager=function(){this._listeners={};this._queue=[]};BaseEventManager.prototype.on=function(a,b){this._listeners[a]||(this._listeners[a]=[]);-1===this._listeners[a].indexOf(b)&&this._listeners[a].push(b)};
BaseEventManager.prototype.delListener=function(a,b){this._listeners[a]&&this._listeners[a].indexOf(b)};BaseEventManager.prototype.clearListeners=function(){this._listeners={}};BaseEventManager.prototype.fireEvent=function(a,b){var d=this._queue;d.push({event_name:a,original_event:b});this._queue=[];this._processEvents(d)};BaseEventManager.prototype.queueEvent=function(a,b){this._queue.push({event_name:a,original_event:b})};
BaseEventManager.prototype._processEvents=function(a){if(this._listeners){a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())if(b=b.value,this._listeners[b.event_name])for(var d in this._listeners[b.event_name])this._listeners[b.event_name][d](b.original_event)}};module.exports.BaseEventManager=BaseEventManager;
var genPin=function(){return Math.floor(899999*Math.random())+1E5},BluetoothController=function(){BaseEventManager.call(this);this.name="bluetoothctl (emulation)";this.identity={name:"bluetoothctl",marker:{left:"      # ",right:" # "}};this._options={auto_pairable:!1,auto_trust:!1};this.player=new Player;for(var a=this,b={},d=$jscomp.makeIterator(event_listeners.entries()),e=d.next();!e.done;b={$jscomp$loop$prop$value$55:b.$jscomp$loop$prop$value$55},e=d.next()){e=$jscomp.makeIterator(e.value);var c=
e.next().value;b.$jscomp$loop$prop$value$55=e.next().value;this.on(c,function(b){return function(c){b.$jscomp$loop$prop$value$55.apply(a,arguments)}}(b))}this._devices=new Map;this._pairing_requests=new Map;this._connection_requests=new Map;this._playback_requests=new Map;this._playlists=null;this._power=!1;this._power_state=1;this._defalut_timeout=5;this._scan=this._discoverable=this._pairable=this._pin_required=!1};BluetoothController.prototype=Object.create(BaseEventManager.prototype);
BluetoothController.constructor=BluetoothController;void 0!==Logger&&Logger.call(BluetoothController.prototype);BluetoothController.prototype.fireEvent=function(a,b){1>this._power_state||BaseEventManager.prototype.fireEvent.apply(this,arguments)};BluetoothController.prototype.power=function(a){this._power=a=BtUtils.parseBool(a);this.fireEvent("ctl_onPowerChanged",{value:a});!this._power&&0<this._power_state&&this.reset()};
BluetoothController.prototype.init=function(){this.queueEvent("ctl_onInit",{value:"started"});this.reset()};
BluetoothController.prototype.reset=function(){this.log("Resetting the controller.");this._setPowerState(0);this.power("on");this._pin_required=!1;this._pairable=this._options.auto_pairable;this._scan=this._discoverable=!1;this._devices.clear();this._pairing_requests.clear();this._connection_requests.clear();this._playback_requests.clear();this._playlists=new Map(Bluetooth_Devices.playlists);this.log("Restoring devices.");for(var a=$jscomp.makeIterator(Bluetooth_Devices.in_range),b=a.next();!b.done;b=
a.next())b=b.value,this._devices.set(b.mac,b),b.discovered=!1,b.paired=!1,b.trusted=!1,b.connected=!1,b.blocked=!1,-1!==Bluetooth_Devices.paired.indexOf(b.mac)&&this.pair(b.mac),-1!==Bluetooth_Devices.trusted.indexOf(b.mac)&&this.trust(b.mac),-1!==Bluetooth_Devices.connected.indexOf(b.mac)&&this.connect(b.mac),-1!==Bluetooth_Devices.blocked.indexOf(b.mac)&&this.block(b.mac);this.power("off");this._setPowerState(1);this.log("Controller was reset.")};
BluetoothController.prototype._setPowerState=function(a){if("undefined"===a||0>a||1<a)a=1;a!==this._power_state&&(this._power_state=a)};BluetoothController.prototype.pairable=function(a){this.isPowered(1)&&(this._pairable=a=BtUtils.parseBool(a),this.fireEvent("ctl_onPairableChanged",{value:a}))};BluetoothController.prototype.discoverable=function(a){this.isPowered(1)&&(this._discoverable=a=BtUtils.parseBool(a),this.fireEvent("ctl_onDiscoverableChanged",{value:a}))};
BluetoothController.prototype.isPowered=function(a){a=BtUtils.parseBool(a);!this._power&&a&&this.fireEvent("ctl_onError",{value:"ERROR_NOT_POWERED",message:"Power is off. Use power('on') to enable"});return this._power};BluetoothController.prototype.isPairable=function(){return this.isPowered(1)&&this._pairable};BluetoothController.prototype.isDiscoverable=function(){return this.isPowered(1)&&this._discoverable};BluetoothController.prototype.isScanning=function(){return this.isPowered(1)&&this._scan};
BluetoothController.prototype.scan=function(a){a=BtUtils.parseBool(a);var b=this;this.isPowered(1)&&((this._scan=a)?(this.fireEvent("ctl_onDiscoveryStarted",{value:a}),setTimeout(function(){if(b.isScanning()){for(var a=$jscomp.makeIterator(b.getDevicesByCriteria("blocked",!1)),e=a.next();!e.done;e=a.next())e=e.value,void 0!==e&&(e.discovered=!0);b.fireEvent("ctl_onDeviceListChanged",{value:b._devices})}},1E3*this._defalut_timeout)):this.fireEvent("ctl_onDiscoveryStopped",{value:a}))};
BluetoothController.prototype.pair=function(a){var b=!1;if(this.isPowered(1)){var d=this._devices.get(a);void 0===d||!d.discovered&&0!==this._power_state?this.fireEvent("ctl_onPairFailed",{device:{mac:a}}):(d.paired||(d.paired=!0,this.dropPairingRequest(a),this.hasOption("auto_trust","on")&&this.trust(a)),this.fireEvent("ctl_onPair",{device:d,result:b}),b=!0);return b}};
BluetoothController.prototype.unpair=function(a){if(this.isPowered(1)){var b=this._devices.get(a);void 0!==b&&b.paired?(b.connected&&this.disconnect(a),b.trusted&&this.untrust(a),b.paired=!1,this.fireEvent("ctl_onUnpair",{device:b,result:!0})):this.log("Device %s wasn't paired, but requested to unpair. Ignored.",a);return!0}};
BluetoothController.prototype.trust=function(a){var b=!1;if(this.isPowered(1)){var d=this._devices.get(a);void 0!==d&&d.paired&&!d.blocked?(d.trusted||(d.trusted=!0),b=!0,this.fireEvent("ctl_onTrust",{device:d,result:b})):this.fireEvent("ctl_onWarning",{value:"WARNING_WRONG_DEVICE",message:"device "+a+" can't be trusted"});return b}};
BluetoothController.prototype.untrust=function(a){if(this.isPowered(1)){var b=this._devices.get(a);void 0!==b&&b.trusted?(b.connected&&this.disconnect(a),b.trusted=!1,this.fireEvent("ctl_onUntrust",{device:b,result:!0})):this.log("Device %s wasn't trusted, but requested to untrust. Ignored.",a);return!0}};
BluetoothController.prototype.connect=function(a){var b=!1;if(this.isPowered(1)){var d=this._devices.get(a);if(d.trusted&&!d.connected){b=this.getMacsByCriteria("connected",!0);b=$jscomp.makeIterator(b);for(var e=b.next();!e.done;e=b.next())this.disconnect(e.value);d.connected=!0;d.active=2;this.player.init(this._playlists.get(d.mac));b=!0;this.dropConnectionRequest(a);this.fireEvent("ctl_onConnect",{device:d,result:b})}else this.fireEvent("ctl_onConnectFailed",{device:{mac:a}});return b}};
BluetoothController.prototype.disconnect=function(a){if(this.isPowered(1)){var b=this._devices.get(a);void 0!==b&&b.connected?(b.connected=!1,this.player.close(),this.log("Disconnected %s(%s)",b.name,b.mac),this.fireEvent("ctl_onDisconnect",{device:b,result:!0})):this.log("Device %s wasn't connected, but requested to disconnect. Ignored.",a);return!0}};
BluetoothController.prototype.block=function(a){var b=!1;if(this.isPowered(1)){var d=this._devices.get(a);void 0===d||d.blocked?this.fireEvent("ctl_onWarning",{value:"WARNING_WRONG_DEVICE",message:void 0!==d?"Device "+a+" is blocked":"Device "+a+" is unknown"}):(d.connected&&this.disconnect(a),d.trusted&&this.untrust(a),d.paired&&this.unpair(a),b=d.blocked=!0,this.fireEvent("ctl_onBlock",{device:d,result:b}));return b}};
BluetoothController.prototype.unblock=function(a){if(this.isPowered(1)){var b=this._devices.get(a);void 0!==b&&b.blocked?(b.blocked=!1,this.fireEvent("ctl_onUnblock",{device:b,result:!0})):this.log("Device %s wasn't blocked, but requested to unblock. Ignored.",a);return!0}};BluetoothController.prototype.info=function(a){if(this.isPowered(1))return this._devices.get(a)};
BluetoothController.prototype.remove=function(a){if(this.isPowered(1)){var b=!1,d=this._devices.get(a);void 0!==d?(this.fireEvent("ctl_onRemove",{device:d}),b=this._devices.delete(a)):this.fireEvent("ctl_onWarning",{value:"WARNING_WRONG_DEVICE",message:"Device "+a+" is unknown"});return b}};BluetoothController.prototype.list=function(){if(this.isPowered(1)){for(var a=[],b=$jscomp.makeIterator(this._devices.values()),d=b.next();!d.done;d=b.next())a.push(d.value);return a}};
BluetoothController.prototype.requirePin=function(a){this._pin_required=BtUtils.parseBool(a)};BluetoothController.prototype.isPinRequired=function(){return this._pin_required};BluetoothController.prototype.getMacsByCriteria=function(a,b){if(!this.isPowered(1))return[];for(var d=[],e=$jscomp.makeIterator(this._devices.keys()),c=e.next();!c.done;c=e.next()){c=c.value;var f=this._devices.get(c);f.hasOwnProperty(a)&&f[a]===b&&d.push(c)}return d};
BluetoothController.prototype.getDevicesByCriteria=function(a,b){if(!this.isPowered(1))return[];for(var d=[],e=$jscomp.makeIterator(this._devices.values()),c=e.next();!c.done;c=e.next())c=c.value,c.hasOwnProperty(a)&&c[a]===b&&d.push(c);return d};BluetoothController.prototype.getDevice=function(a){return this.isPowered(1)?this._devices.get(a):{}};BluetoothController.prototype.getDeviceByName=function(a){return this.isPowered(1)?this.getDevicesByCriteria("name",a)[0]:{}};
BluetoothController.prototype.setOption=function(a,b){b=BtUtils.parseBool(b);this._options.hasOwnProperty(a)&&this._options[a]===b||(this._options[a]=b,this.fireEvent("ctl_onSetOption",{option:a,value:b}))};BluetoothController.prototype.hasOption=function(a,b){b=BtUtils.parseBool(b);return this._options.hasOwnProperty(a)&&this._options[a]===b};
BluetoothController.prototype.dropPairingRequest=function(a){this._pairing_requests.has(a)?(this.log("Dropping pairing request for %s",a),this._pairing_requests.delete(a)):(this.log("Ignoring drop pairing request for %s: no such request present.",a),this.log("Pending pairing requests: ",this._pairing_requests))};
BluetoothController.prototype.dropConnectionRequest=function(a){this._connection_requests.has(a)?(this.log("Dropping connection request for %s",a),this._connection_requests.delete(a)):(this.log("Ignoring drop connection request for %s: no such request present.",a),this.log("Pending connection requests: ",this._connection_requests))};
BluetoothController.prototype.dropPlaybackRequest=function(a){this._playback_requests.has(a)?(this.log("Dropping playback request for %s",a),this._playback_requests.delete(a)):(this.log("Ignoring drop playback request for %s: no such request present.",a),this.log("Pending playback requests: ",this._playback_requests))};BluetoothController.prototype.getPlaylist=function(a){return this._playlists.get(a)};
BluetoothController.prototype.setAudioStream=function(a,b){if(this.isPowered(1)){var d=this._devices.get(a);void 0!==d&&d.connected?(d.audio_stream=b,b=!0):(b=!1,this.log("Cannot set audio stream for %s, because device is %s ",a,void 0===d?"unknown.":"not connected."));return b}};var event_listeners=new Map;
event_listeners.set("usr_pairingRequest",function(a){this.log("Got a user pairing request from %s (%s) (controller powered: %s; pairable: %s)",a.device.name,a.device.mac,this.isPowered(),this.isPairable());this.isPowered()&&this.isPairable()&&(a=JSON.parse(JSON.stringify(a.device)),a.pin=genPin(),this._pairing_requests.set(a.mac,a.pin),this.fireEvent("ctl_onPairingRequest",{device:a}))});
event_listeners.set("usr_ConnectionRequest",function(a){this.log("Got a user connection request from %s (%s) (controller powered: %s)",a.device.name,a.device.mac,this.isPowered());this.isPowered()&&(a=JSON.parse(JSON.stringify(a.device)),this._connection_requests.set(a.mac,""),this.fireEvent("ctl_onConnectionRequest",{device:a}))});
event_listeners.set("usr_PlaybackRequest",function(a){this.log("Got a user playbackRequest from %s (%s) (controller powered: %s)",a.device.name,a.device.mac,this.isPowered());this.isPowered()&&(a=JSON.parse(JSON.stringify(a.device)),this._playback_requests.set(a.mac,""),this.fireEvent("ctl_onPlaybackRequest",{device:a}))});BluetoothController.prototype.agent=function(a){throw"Not implemented";};BluetoothController.prototype.defaultAgent=function(a){throw"Not implemented";};
BluetoothController.prototype.advertise=function(a){throw"Not implemented";};BluetoothController.prototype.show=function(a){throw"Not implemented";};BluetoothController.prototype.select=function(a){throw"Not implemented";};module.exports.BluetoothController=BluetoothController;
var Bluetooth_Devices={in_range:[{mac:"18:65:90:5D:4D:CA",name:"Valley Seven",alias:"Valley Seven","class":"0x7a020c",icon:"phone",legacy:!1,uuid_vendor_specific:"00000000-deca-fade-deca-deafdecacafe",uuid_service_discovery_server:"00001000-0000-1000-8000-00805f9b34fb",uuid_autio_source:"0000110a-0000-100-8000-00805f9b34fb",uuid_av_remote_control_target:"0000110c-0000-1000-8000-00805f9b34fb",uuid_advanced_audio_distribution:"0000110d-0000-1000-8000-00805f9b34fb",uuid_a_v_remote_control:"0000110e-0000-1000-8000-00805f9b34fb",
uuid_nap:"00001116-0000-1000-8000-00805f9b34fb",uuid_handsfree_audio_gateway:"0000111f-0000-1000-8000-00805f9b34fb",uuid_phonebook_access_server:"0000112f-0000-1000-8000-00805f9b34fb",uuid_message_access_server:"00001132-0000-1000-8000-00805f9b34fb",uuid_pnp_information:"00001200-0000-1000-8000-00805f9b34fb",modalias:"bluetooth:v004Cp7006d0A30"},{mac:"90:72:40:69:BB:93",name:"iSport",alias:"iSport","class":"0x7a020c",icon:"phone",legacy:!1,uuid_vendor_specific:"00000000-deca-fade-deca-deafdecacafe",
uuid_service_discovery_server:"00001000-0000-1000-8000-00805f9b34fb",uuid_audio_source:"0000110a-0000-1000-8000-00805f9b34fb",uuid_av_remote_control_target:"0000110c-0000-1000-8000-00805f9b34fb",uuid_a_v_remote_control:"0000110e-0000-1000-8000-00805f9b34fb",uuid_nap:"00001116-0000-1000-8000-00805f9b34fb",uuid_handsfree_audio_gateway:"0000111f-0000-1000-8000-00805f9b34fb",uuid_phonebook_access_server:"0000112f-0000-1000-8000-00805f9b34fb",uuid_message_access_server:"00001132-0000-1000-8000-00805f9b34fb",
uuid_pnp_information:"00001200-0000-1000-8000-00805f9b34fb",modalias:"usb:v05ACp12A8d0A30"},{mac:"C8:7E:75:FC:F0:81",name:"B5722",alias:"B5722","class":"0x5a0204",icon:"phone",legacy:!1,uuid_av_remote_control_target:"0000110c-0000-1000-8000-00805f9b34fb",uuid_dialup_networking:"00001103-0000-1000-8000-00805f9b34fb",uuid_headset_ag:"00001112-0000-1000-8000-00805f9b34fb",uuid_generic_audio:"00001203-0000-1000-8000-00805f9b34fb",uuid_audio_source:"0000110a-0000-1000-8000-00805f9b34fb",uuid_obex_object_push:"00001105-0000-1000-8000-00805f9b34fb",
uuid_obex_file_transfer:"00001106-0000-1000-8000-00805f9b34fb",uuid_serial_port:"00001101-0000-1000-8000-00805f9b34fb",uuid_handsfree_audio_gateway:"0000111f-0000-1000-8000-00805f9b34fb"},{mac:"A8:66:7F:08:DA:27",name:"art",alias:"art","class":"0x38010c",icon:"computer",legacy:!1,uuid_vendor_specific:"00000000-deca-fade-deca-deafdecacafe",uuid_service_discovery_server:"00001101-0000-1000-8000-00805f9b34fb",uuid_audio_source:"0000110a-0000-1000-8000-00805f9b34fb",uuid_av_remote_control_target:"0000110c-0000-1000-8000-00805f9b34fb",
uuid_a_v_remote_control:"0000110e-0000-1000-8000-00805f9b34fb",uuid_nap:"00001116-0000-1000-8000-00805f9b34fb",uuid_handsfree_audio_gateway:"0000111f-0000-1000-8000-00805f9b34fb",uuid_phonebook_access_server:"0000112f-0000-1000-8000-00805f9b34fb",uuid_message_access_server:"00001132-0000-1000-8000-00805f9b34fb",uuid_pnp_information:"00001200-0000-1000-8000-00805f9b34fb",modalias:"bluetooth:v004Cp4A3Bd1011"},{mac:"CC:44:63:B9:5F:41",name:"iPad Pro",alias:"iPad Pro","class":"0x38010c",icon:"computer",
legacy:!1,uuid_vendor_specific:"00000000-deca-fade-deca-deafdecacafe",uuid_service_discovery_server:"00001100-0000-1000-8000-00805f9b34fb",uuid_audio_source:"0000110a-0000-1000-8000-00805f9b34fb",uuid_av_remote_control_target:"0000110c-0000-1000-8000-00805f9b34fb",uuid_a_v_remote_control:"0000110e-0000-1000-8000-00805f9b34fb",uuid_nap:"00001116-0000-1000-8000-00805f9b34fb",uuid_handsfree_audio_gateway:"0000111f-0000-1000-8000-00805f9b34fb",uuid_phonebook_access_server:"0000112f-0000-1000-8000-00805f9b34fb",
uuid_message_access_server:"00001132-0000-1000-8000-00805f9b34fb",uuid_pnp_information:"00001200-0000-1000-8000-00805f9b34fb",modalias:"bluetooth:v004Cp4A3Bd1011"},{mac:"AA:44:43:B9:5D:4C",name:"Black",alias:"Black","class":"0x7a020c",icon:"phone",legacy:!1,uuid_vendor_specific:"00000000-deca-fade-deca-deafdecacafe",uuid_service_discovery_server:"00001000-0000-1000-8000-00805f9b34fb",uuid_audio_source:"0000110a-0000-1000-8000-00805f9b34fb",uuid_av_remote_control_target:"0000110c-0000-1000-8000-00805f9b34fb",
uuid_a_v_remote_control:"0000110e-0000-1000-8000-00805f9b34fb",uuid_nap:"00001116-0000-1000-8000-00805f9b34fb",uuid_handsfree_audio_gateway:"0000111f-0000-1000-8000-00805f9b34fb",uuid_phonebook_access_server:"0000112f-0000-1000-8000-00805f9b34fb",uuid_message_access_server:"00001132-0000-1000-8000-00805f9b34fb",uuid_pnp_information:"00001200-0000-1000-8000-00805f9b34fb",modalias:"usb:v04ACp12A8d0A40"}],paired:[],trusted:["90:72:40:69:BB:93","C8:7E:75:FC:F0:81"],connected:[],blocked:["AA:44:43:B9:5D:4C"],
playlists:[["18:65:90:5D:4D:CA",{name:"Thin Lizzy",tracks:[{Album:"Chinatown",TrackNumber:1,Genre:"Rock",Duration:250055,NumberOfTracks:9,Title:"We Will Be Strong",Artist:"Thin Lizzy"},{Album:"Chinatown",TrackNumber:2,Genre:"Rock",Duration:240024,NumberOfTracks:9,Title:"Chinatown",Artist:"Thin Lizzy"},{Album:"Chinatown",TrackNumber:3,Genre:"Rock",Duration:250034,NumberOfTracks:9,Title:"Sweetheart",Artist:"Thin Lizzy"}]}],["C8:7E:75:FC:F0:81",{name:"Delerium - Poem (2001)",tracks:[{Album:"Poem",TrackNumber:1,
Genre:"Electronic",Duration:322800,NumberOfTracks:11,Title:"Terra Firma",Artist:"Delerium"},{Album:"Poem",TrackNumber:2,Genre:"Electronic",Duration:377736,NumberOfTracks:11,Title:"Innocente",Artist:"Delerium"},{Album:"Poem",TrackNumber:3,Genre:"Electronic",Duration:214600,NumberOfTracks:11,Title:"Aria",Artist:"Delerium"},{Album:"Poem",TrackNumber:4,Genre:"Electronic",Duration:378520,NumberOfTracks:11,Title:"Fallen Icons (feat. Jenifer McLaren)",Artist:"Delerium"},{Album:"Poem",TrackNumber:5,Genre:"Electronic",
Duration:312679,NumberOfTracks:11,Title:"Underwater",Artist:"Delerium"},{Album:"Poem",TrackNumber:6,Genre:"Electronic",Duration:366280,NumberOfTracks:11,Title:"Myth",Artist:"Delerium"},{Album:"Poem",TrackNumber:7,Genre:"Electronic",Duration:309280,NumberOfTracks:11,Title:"Nature's Kingdom",Artist:"Delerium"},{Album:"Poem",TrackNumber:8,Genre:"Electronic",Duration:319464,NumberOfTracks:11,Title:"Daylight",Artist:"Delerium"},{Album:"Poem",TrackNumber:9,Genre:"Electronic",Duration:483960,NumberOfTracks:11,
Title:"Temptation",Artist:"Delerium"},{Album:"Poem",TrackNumber:10,Genre:"Electronic",Duration:332160,NumberOfTracks:11,Title:"A Poem for Byzantium",Artist:"Delerium"},{Album:"Poem",TrackNumber:11,Genre:"Electronic",Duration:616369,NumberOfTracks:11,Title:"Amongst the Ruins",Artist:"Delerium"}]}],["90:72:40:69:BB:93",{name:"Asura",tracks:[{Album:"Life^2",TrackNumber:1,Genre:"Downtempo",Year:"2016",Duration:240033,NumberOfTracks:10,Title:"Golgotha",Artist:"Asura"},{Album:"Life^2",TrackNumber:2,Genre:"Downtempo",
Year:"2016",Duration:210112,NumberOfTracks:10,Title:"Back to Light",Artist:"Asura"},{Album:"Life^2",TrackNumber:3,Genre:"Downtempo",Year:"2016",Duration:200124,NumberOfTracks:10,Title:"Galaxies, Pt. 1",Artist:"Asura"},{Album:"Life^2",TrackNumber:3,Genre:"Downtempo",Year:"2016",Duration:200124,NumberOfTracks:10,Title:"Celestial tendencies",Artist:"Asura"}]}]]};module.exports.Bluetooth_Devices=Bluetooth_Devices;
var PlayerState=Object.freeze({stopped:1,paused:2,playing:3}),AudioInfo={album:"",artist:"",genre:"",title:"",year:"",duration:0,number_of_tracks:0,track_number:0,track_idx:-1,position:0,player_state:PlayerState.stopped},Player=function(){BaseEventManager.call(this);this.name="player (emulation)";this.identity={name:"player",marker:{left:"        ~",right:" ~ "}};this.playlist=null;this._options={speed_factor:1};this._avaliable=!1;this._ai=AudioInfo;this._stream_timer=this._tick_timer=null};
Player.prototype=Object.create(BaseEventManager.prototype);Player.constructor=Player;Player.prototype._setAi=function(a){if(0>a||a>this.playlist.length()-1)return!1;var b=this.playlist.tracks[a];this._ai.album=b.Album;this._ai.artist=b.Artist;this._ai.genre=b.Genre;this._ai.title=b.Title;this._ai.year=b.Year;this._ai.duration=b.Duration;this._ai.number_of_tracks=b.NumberOfTracks;this._ai.track_number=b.TrackNumber;this._ai.track_idx=a;this._ai.position=0;return!0};
Player.prototype.init=function(a){if("object"!==typeof a)return this.fireEvent("plr_onError",{value:"ERROR_INVALID_PLAYLIST",message:"Invalid playlist"}),!1;this.playlist=a;this.playlist.length=function(){return this.tracks.length};this._setAi(0);return this._avaliable=!0};Player.prototype.setOption=function(a,b){this._options.hasOwnProperty(a)&&this._options[a]===b||(this._options[a]=b)};
Player.prototype.close=function(){this._avaliable=!1;this._ai.player_state=PlayerState.stopped;clearInterval(this._tick_timer);this.playlist=null;this.fireEvent("plr_onClose",{audio_info:this._ai})};
Player.prototype.play=function(){if(this.isAvailable(1)){var a=this;clearInterval(this._tick_timer);this.isPaused()?this.fireEvent("plr_onResume",{audio_info:this._ai}):this.fireEvent("plr_onStart",{audio_info:this._ai});this._ai.player_state=PlayerState.playing;var b=333*this._options.speed_factor;this._tick_timer=setInterval(function(){a._ai.position+=b;a.isPlaying()||clearInterval(a._tick_timer);a._ai.position>=a._ai.duration&&(clearInterval(a._tick_timer),a.next())},333);this._stream_timer=setInterval(function(){a.isPlaying()?
a.fireEvent("plr_onStreamUpdate",{audio_info:a._ai}):clearInterval(a._stream_timer)},1E3)}};Player.prototype.pause=function(){this.isAvailable(1)&&(this._ai.player_state=PlayerState.paused,this.fireEvent("plr_onPause",{audio_info:this._ai}))};Player.prototype.stop=function(){this.isAvailable(1)&&(this._ai.player_state=PlayerState.stopped,this._ai.position=0,this.fireEvent("plr_onStop",{audio_info:this._ai}))};
Player.prototype.reset=function(){this.isAvailable(1)&&(this._ai.player_state=PlayerState.stopped,this._setAi(0),this.fireEvent("plr_onReset",{audio_info:this._ai}))};Player.prototype.restart=function(){this.isAvailable(1)&&(this._ai.position=0,this._ai.player_state=PlayerState.playing,this.fireEvent("plr_onRestart",{audio_info:this._ai}))};
Player.prototype.next=function(){if(this.isAvailable(1)){var a=this._ai.track_idx;++a;a>=this.playlist.length()&&(a-=this.playlist.length());this._setAi(a);this.fireEvent("plr_onNext",{audio_info:this._ai});this.isPlaying()&&this.play()}};Player.prototype.skipNext=function(){if(this.isAvailable(1)){var a=this._ai.track_idx;a+=2;a>=this.playlist.length()&&(a-=this.playlist.length());this._setAi(a);this.fireEvent("plr_onSkipNext",{audio_info:this._ai});this.isPlaying()&&this.play()}};
Player.prototype.previous=function(){if(this.isAvailable(1)){var a=this._ai.track_idx;--a;0>a&&(a+=this.playlist.length());this._setAi(a);this.fireEvent("plr_onPrevious",{audio_info:this._ai});this.isPlaying()&&this.play()}};Player.prototype.skipPrevious=function(){if(this.isAvailable(1)){var a=this._ai.track_idx;a-=2;0>a&&(a+=this.playlist.length());this._setAi(a);this.fireEvent("plr_onSkipPrevious",{audio_info:this._ai});this.isPlaying()&&this.play()}};Player.prototype.getAudioInfo=function(){return this._ai};
Player.prototype.isPlaying=function(){return this._ai.player_state===PlayerState.playing};Player.prototype.isPaused=function(){return this._ai.player_state===PlayerState.paused};Player.prototype.isStopped=function(){return this._ai.player_state===PlayerState.stopped};Player.prototype.isAvailable=function(a){!this._avaliable&&a&&this.fireEvent("plr_onError",{value:"STATUS_NOT_AVAILABLE",message:"Player is not available. Perform init first."});return this._avaliable};module.exports.Player=Player;
var BluetoothService=function(a){BaseEventManager.call(this);this.name="Bluetooth Service Manager service (emulation)";this.identity={name:"service manager",marker:{left:"    { ",right:" } "}};var b=this;this.name=this.service_name=a;this.api_version=1;this.onEvent={};this._bluetooth_event_subscriptions=[];this.bluetoothctl=new BluetoothController;a={};for(var d=$jscomp.makeIterator(bluetooth_controller_listeners.entries()),e=d.next();!e.done;a={$jscomp$loop$prop$value$57:a.$jscomp$loop$prop$value$57},
e=d.next()){e=$jscomp.makeIterator(e.value);var c=e.next().value;a.$jscomp$loop$prop$value$57=e.next().value;this.bluetoothctl.on(c,function(a){return function(c){a.$jscomp$loop$prop$value$57.apply(b,arguments)}}(a))}a={};d=$jscomp.makeIterator(plr_event_listeners.entries());for(e=d.next();!e.done;a={$jscomp$loop$prop$value$42$59:a.$jscomp$loop$prop$value$42$59},e=d.next())e=$jscomp.makeIterator(e.value),c=e.next().value,a.$jscomp$loop$prop$value$42$59=e.next().value,this.bluetoothctl.player.on(c,
function(a){return function(c){a.$jscomp$loop$prop$value$42$59.apply(b,arguments)}}(a));this.bluetoothctl.setOption("auto_pairable","on");this.bluetoothctl.setOption("auto_trust","on");this.bluetoothctl.init();this.deviceTypeFromIcon=function(a){var b="UNKNOWN";switch(a){case "phone":b="HUMAN INTERFACE DEVICE";break;case "computer":b="COMPUTER"}return b};this.deviceIdFromMac=function(a){a=String(a).split(":").join("");return parseInt(a,16)};this.macFromDeviceId=function(a){a=Number(a).toString(16).toUpperCase();
for(var b=a.length,c="",d=0;d<b;d+=2)c+=a.substr(d,2),d+2<b&&(c+=":");return c};this.devicePayloadFromRawData=function(a){var b=this.deviceIdFromMac(a.mac),c=this.deviceTypeFromIcon(a.icon);var d=a.hasOwnProperty("uuid_audio_source")?a.uuid_audio_source:"null";var e=a.hasOwnProperty("uuid_vendor_specific")?a.uuid_vendor_specific:"0";return{deviceID:b,name:a.name,deviceType:c,supportedProfile:d,manufacturer:e,MAC:a.mac}};this.genRSSI=function(){return Math.floor(74*Math.random())+-100};this.genRX=
function(a){return(a-2*a)/25+Math.random()}};BluetoothService.prototype=Object.create(BaseEventManager.prototype);BluetoothService.constructor=BluetoothService;Logger.call(BluetoothService.prototype);BluetoothService.prototype.setApiVersionNumber=function(a){"number"===typeof a&&(this.api_version=a)};BluetoothService.prototype.registerForEvents=function(a){a=JSON.parse(a);a.events.constructor===Array&&(this._bluetooth_event_subscriptions=a.events)};
BluetoothService.prototype.callMethod=function(a,b){this.log("Calling: %s with params: %s",a,b);b=JSON.stringify(JSON.parse(b));return this.__proto__.hasOwnProperty(a)?this[a](b):'{"success":false, "message": "unknown method '+a+'"}'};
BluetoothService.prototype.fireBluetoothEvent=function(a,b){var d=-1!==this._bluetooth_event_subscriptions.indexOf(a);"object"===typeof b&&(b=JSON.stringify(b));if("function"===typeof this.onEvent&&d)this.onEvent(a,b);else this.log('"onEvent" function is not yet defined for %s',this.identity.name),this.log("Firing to void: %s, payload: %s",a,b)};
BluetoothService.prototype.getStatusSupport=function(a){a={success:!1};this.bluetoothctl.isPowered()?(a.success=!0,a.status="AVAILABLE"):(a.success=!1,a.status="SOFTWARE_DISABLED");return JSON.stringify(a)};
BluetoothService.prototype.setBluetoothEnabled=function(a){var b={success:!1},d={newStatus:""},e=this;switch(JSON.parse(a).params[0]){case "BLUETOOTH_ENABLED":var c="on";break;case "BLUETOOTH_DISABLED":c="off"}this.bluetoothctl.on("ctl_onPowerChanged",function(a){b.success=!0;d.newStatus=a.value?"SOFTWARE_ENABLED":"SOFTWARE_DISABLED";e.fireBluetoothEvent("statusChanged",d)});this.bluetoothctl.power(c);return JSON.stringify(b)};
BluetoothService.prototype.setBluetoothDiscoverable=function(a){a=JSON.parse(a).params;var b={success:!1};a=BtUtils.parseBool(a[0]);this.bluetoothctl.on("ctl_onDiscoverableChanged",function(a){b.success=!0});this.bluetoothctl.discoverable(a);return JSON.stringify(b)};BluetoothService.prototype.setSinkDiscovery=function(a){return this.setBluetoothDiscoverable(a)};
BluetoothService.prototype.startDeviceDiscovery=function(a){var b={success:!1};a=JSON.parse(a).params[0];var d=this;this.bluetoothctl.on("ctl_onDiscoveryStarted",function(a){b.success=!0;b.status="AVAILABLE"});this.bluetoothctl.on("ctl_onError",function(a){b.success=!1;"ERROR_NOT_POWERED"===a.value&&(b.status="SOFTWARE_DISABLED")});this.bluetoothctl.scan("on");a?setTimeout(function(){d.bluetoothctl.isScanning()&&d.bluetoothctl.scan("off")},1E3*a):this.bluetoothctl.scan("off");return JSON.stringify(b)};
BluetoothService.prototype.stopDeviceDiscovery=function(a){var b={success:!1};this.bluetoothctl.on("ctl_onDiscoveryStopped",function(a){b.success=!0});this.bluetoothctl.scan("off");return JSON.stringify(b)};
BluetoothService.prototype.getDiscoveredDevices=function(a){var b={success:!1};a=[];this.bluetoothctl.on("ctl_onError",function(a){b.success=!1});var d=this.bluetoothctl.getDevicesByCriteria("discovered",!0);d=$jscomp.makeIterator(d);for(var e=d.next();!e.done;e=d.next()){e=e.value;var c={};c.deviceType=this.deviceTypeFromIcon(e.icon);c.deviceID=this.deviceIdFromMac(e.mac);c.name=e.name;c.paired=e.paired;c.connected=e.connected;a.push(c)}b.success=0<a.length;b.discoveredDevices=a;return JSON.stringify(b)};
BluetoothService.prototype.getPairedDevices=function(a){var b={success:!1};a=[];this.bluetoothctl.on("ctl_onError",function(a){b.success=!1});this.bluetoothctl.isPairable()||(this.log("Setting pairable on automatically"),this.bluetoothctl.pairable("on"));var d=this.bluetoothctl.getDevicesByCriteria("paired",!0);d=$jscomp.makeIterator(d);for(var e=d.next();!e.done;e=d.next()){e=e.value;var c={};c.deviceType=this.deviceTypeFromIcon(e.icon);c.deviceID=this.deviceIdFromMac(e.mac);c.name=e.name;c.connected=
e.connected;a.push(c)}b.success=0<a.length;b.pairedDevices=a;return JSON.stringify(b)};
BluetoothService.prototype.getConnectedDevices=function(a){var b={success:!1};a=[];this.bluetoothctl.on("ctl_onError",function(a){b.success=!1});var d=this.bluetoothctl.getDevicesByCriteria("connected",!0);d=$jscomp.makeIterator(d);for(var e=d.next();!e.done;e=d.next()){e=e.value;var c={};c.deviceType=this.deviceTypeFromIcon(e.icon);c.deviceID=this.deviceIdFromMac(e.mac);c.name=e.name;c.active=e.active;a.push(c)}b.success=0<a.length;b.connectedDevices=a;return JSON.stringify(b)};
BluetoothService.prototype.setDevicePairing=function(a){var b=JSON.parse(a).params,d={success:!1};this.log("Got a device pairing command: ",a);a=this.macFromDeviceId(b[0]);var e=!b[1];b[1]&&(d.success=this.bluetoothctl.pair(a));e&&(d.success=this.bluetoothctl.unpair(a));return JSON.stringify(d)};
BluetoothService.prototype.setDeviceConnection=function(a){var b=JSON.parse(a).params;this.log("Got a device connection command: ",a);a={success:!1};var d=this.macFromDeviceId(b[0]),e="DISCONNECT"===b[1];"CONNECT"===b[1]&&(a.success=this.bluetoothctl.connect(d));e&&(a.success=this.bluetoothctl.disconnect(d));return JSON.stringify(a)};
BluetoothService.prototype.setAudioStream=function(a){var b=JSON.parse(a).params;this.log("Got an audio stream setup command: ",a);a={success:!1};var d=this.macFromDeviceId(b[0]);a.success=this.bluetoothctl.setAudioStream(d,b[1]);return JSON.stringify(a)};BluetoothService.prototype.getDeviceInfo=function(a){a=JSON.parse(a).params;a=this.macFromDeviceId(a[0]);a=this.bluetoothctl.getDevice(a);a=this.devicePayloadFromRawData(a);a.rssi=this.genRSSI();a.signalStrength=this.genRX(a.rssi);return JSON.stringify(a)};
BluetoothService.prototype.setPlayback=function(a){a=JSON.parse(a).params;var b={success:!1};if(this.bluetoothctl.player.isAvailable()){switch(a[1]){case "PLAY":this.bluetoothctl.player.play();break;case "PAUSE":this.bluetoothctl.player.pause();break;case "STOP":this.bluetoothctl.player.stop();break;case "SKIP_NEXT":this.bluetoothctl.player.skipNext();break;case "RESTART":this.bluetoothctl.player.restart();break;case "SKIP_PREVIOUS":this.bluetoothctl.player.skipPrevious();break;default:this.log("Unknown setPlayback command %s. Ignored.",
a[0])}b.success=!0}else this.log("Player is not available. Ignoring setPlayback command.");return JSON.stringify(b)};
BluetoothService.prototype.getAudioInfo=function(a){var b={success:!1};a=JSON.parse(a).params[0];var d=this.macFromDeviceId(a);if(!this.bluetoothctl.getDevice(d))return this.log("Failed to get audio info for %s (mac: %s). Device is not connected.",a,d),b.success=!1,b;this.bluetoothctl.player.isAvailable()?(d=this.bluetoothctl.player.getAudioInfo(),b.deviceID=a,b.album=d.album,b.artist=d.artist,b.genre=d.genre,b.title=d.title,b.ui32Duration=d.duration,b.ui32NumberOfTracks=d.number_of_tracks,b.ui32TrackNumber=
d.track_number,b.success=!0):this.log("Player is not available. Ignoring getAudioInfo command.");return JSON.stringify(b)};
BluetoothService.prototype.respondToEvent=function(a){var b={success:!1};a=JSON.parse(a).params;switch(a[0].eventType){case "pairingRequest":"ACCEPTED"===a[0].responseValue?(b=this.setDevicePairing('{"params":['+a[0].deviceID+',"true"]}'),b=JSON.parse(b)):"REJECTED"===a[0].responseValue&&(this.bluetoothctl.dropPairingRequest(this.macFromDeviceId(a[0].deviceID)),b={success:!0});break;case "connectionRequest":"ACCEPTED"===a[0].responseValue?(b=this.setDeviceConnection('{"params":['+a[0].deviceID+',"CONNECT"]}'),
b=JSON.parse(b)):"REJECTED"===a[0].responseValue&&(this.bluetoothctl.dropConnectionRequest(this.macFromDeviceId(a[0].deviceID)),b={success:!0});break;case "playbackRequest":"ACCEPTED"===a[0].responseValue?(b=this.setPlayback('{"params":["PLAY"]}'),b=JSON.parse(b)):"REJECTED"===a[0].responseValue&&(this.bluetoothctl.dropPlaybackRequest(this.macFromDeviceId(a[0].deviceID)),b={success:!0})}return JSON.stringify(b)};var bluetooth_controller_listeners=new Map;
bluetooth_controller_listeners.set("ctl_onInit",function(a){this.log("Device init: %s.",a.value);this.fireBluetoothEvent("statusChanged",JSON.stringify({newStatus:"HARDWARE_AVAILABLE"}))});bluetooth_controller_listeners.set("ctl_onError",function(a){this.log("%s: %s",a.value,a.message)});bluetooth_controller_listeners.set("ctl_onWarning",function(a){this.log("%s: %s",a.value,a.message)});bluetooth_controller_listeners.set("ctl_onPowerChanged",function(a){this.log("Power is %s.",a.value?"ON":"OFF")});
bluetooth_controller_listeners.set("ctl_onDiscoveryStarted",function(a){this.log("Discovery started.",JSON.stringify(a))});bluetooth_controller_listeners.set("ctl_onDiscoveryStopped",function(a){this.log("Discovery stopped.",JSON.stringify(a))});bluetooth_controller_listeners.set("ctl_onDeviceListChanged",function(a){this.log("New devices found");this.fireBluetoothEvent("statusChanged",JSON.stringify({newStatus:"DISCOVERY_COMPLETED"}))});
bluetooth_controller_listeners.set("ctl_onDeviceFound",function(a){a=JSON.parse(JSON.stringify(a.device));this.log("A known device found: %s (%s)",a.name,a.mac);var b=this.devicePayloadFromRawData(a);delete b.supportedProfile;delete b.manufacturer;delete b.MAC;b.lastConnected=a.last_connected;this.fireBluetoothEvent("deviceFound",JSON.stringify(b))});bluetooth_controller_listeners.set("ctl_onPairableChanged",function(a){this.log("Pairable is %s.",a.value?"ON":"OFF")});
bluetooth_controller_listeners.set("ctl_onDiscoverableChanged",function(a){this.log("Discoverable is %s.",a.value?"ON":"OFF")});bluetooth_controller_listeners.set("ctl_onPair",function(a){this.log("Device paired:",a.device.mac);this.fireBluetoothEvent("statusChanged",JSON.stringify({newStatus:"PAIRING_CHANGE"}))});
bluetooth_controller_listeners.set("ctl_onPairFailed",function(a){this.log("Device pairing failed:",a.device.mac);this.fireBluetoothEvent("requestFailed",JSON.stringify({errorID:"PAIRING_FAILED",MAC:a.device.mac}))});bluetooth_controller_listeners.set("ctl_onUnpair",function(a){this.log("Device unpaired:",a.device.mac);this.fireBluetoothEvent("statusChanged",JSON.stringify({newStatus:"PAIRING_CHANGE"}))});
bluetooth_controller_listeners.set("ctl_onTrust",function(a){this.log("Device trusted:",a.device.mac);this.fireBluetoothEvent("statusChanged",JSON.stringify({newStatus:"TRUST_CHANGE"}))});bluetooth_controller_listeners.set("ctl_onUntrust",function(a){this.log("Device is not trusted now:",a.device.mac);this.fireBluetoothEvent("statusChanged",JSON.stringify({newStatus:"TRUST_CHANGE"}))});
bluetooth_controller_listeners.set("ctl_onConnect",function(a){this.log("Device connected:",a.device.mac);this.fireBluetoothEvent("statusChanged",JSON.stringify({newStatus:"CONNECTION_CHANGE"}));a=this.bluetoothctl.player.getAudioInfo();this.bluetoothctl.player.fireEvent("plr_onNext",{audio_info:a})});bluetooth_controller_listeners.set("ctl_onDisconnect",function(a){this.log("Device disconnected:",a.device.mac);this.fireBluetoothEvent("statusChanged",JSON.stringify({newStatus:"CONNECTION_CHANGE"}))});
bluetooth_controller_listeners.set("ctl_onConnectFailed",function(a){this.log("Device connecting failed:",a.device.mac);this.fireBluetoothEvent("requestFailed",JSON.stringify({newStatus:"CONNECTION_FAILED",MAC:a.device.mac}))});bluetooth_controller_listeners.set("ctl_onBlock",function(a){this.log("Device blocked:",a.device.mac)});bluetooth_controller_listeners.set("ctl_onUnblock",function(a){this.log("Device unblocked:",a.device.mac)});
bluetooth_controller_listeners.set("ctl_onPairingRequest",function(a){this.log("Pairing request from %s (%s)",a.device.name,a.device.mac);a=JSON.parse(JSON.stringify(a.device));var b=this.devicePayloadFromRawData(a),d=this.bluetoothctl.isPinRequired();b.pinRequired=d;b.pinValue=a.pin;this.fireBluetoothEvent("pairingRequest",JSON.stringify(b));d&&(b={pinValue:a.pin},this.fireBluetoothEvent("pinRequest",JSON.stringify(b)))});
bluetooth_controller_listeners.set("ctl_onConnectionRequest",function(a){this.log("Connection request from %s (%s)",a.device.name,a.device.mac);a=JSON.parse(JSON.stringify(a.device));a=this.devicePayloadFromRawData(a);this.fireBluetoothEvent("connectionRequest",JSON.stringify(a))});
bluetooth_controller_listeners.set("ctl_onPlaybackRequest",function(a){this.log("Playback request from %s (%s)",a.device.name,a.device.mac);a=JSON.parse(JSON.stringify(a.device));a=this.devicePayloadFromRawData(a);this.fireBluetoothEvent("playbackRequest",JSON.stringify(a))});var plr_event_listeners=new Map;
plr_event_listeners.set("plr_onStart",function(a){a=a.audio_info;this.log("Selected track: %s - %s - %s (pos: %d)",a.artist,a.album,a.title,a.position);a={Duration:a.duration,position:a.position};var b=this.bluetoothctl.getMacsByCriteria("connected",!0);0<b.length&&(a.deviceID=this.deviceIdFromMac(b[0]));this.fireBluetoothEvent("playbackStarted",JSON.stringify(a))});
plr_event_listeners.set("plr_onPause",function(a){a=a.audio_info;this.log("Player is on pause: %s - %s - %s (pos: %d)",a.artist,a.album,a.title,a.position);a={Duration:a.duration,position:a.position};var b=this.bluetoothctl.getMacsByCriteria("connected",!0);0<b.length&&(a.deviceID=this.deviceIdFromMac(b[0]));this.fireBluetoothEvent("playbackPaused",JSON.stringify(a))});
plr_event_listeners.set("plr_onResume",function(a){a=a.audio_info;this.log("Player resumed: %s - %s - %s (pos: %d)",a.artist,a.album,a.title,a.position);a={Duration:a.duration,position:a.position};var b=this.bluetoothctl.getMacsByCriteria("connected",!0);0<b.length&&(a.deviceID=this.deviceIdFromMac(b[0]));this.fireBluetoothEvent("playbackResumed",JSON.stringify(a))});
plr_event_listeners.set("plr_onStreamUpdate",function(a){a=a.audio_info;this.log("Player is playing: %s - %s - %s (pos: %d)",a.artist,a.album,a.title,a.position);a={Duration:a.duration,position:a.position};var b=this.bluetoothctl.getMacsByCriteria("connected",!0);0<b.length&&(a.deviceID=this.deviceIdFromMac(b[0]));this.fireBluetoothEvent("playbackResumed",JSON.stringify(a))});
plr_event_listeners.set("plr_onStop",function(a){a=a.audio_info;this.log("Player is stopped: %s - %s - %s (pos: %d)",a.artist,a.album,a.title,a.position);a={Duration:a.duration,position:a.position};var b=this.bluetoothctl.getMacsByCriteria("connected",!0);0<b.length&&(a.deviceID=this.deviceIdFromMac(b[0]));this.fireBluetoothEvent("playbackStopped",JSON.stringify(a))});
plr_event_listeners.set("plr_onRestart",function(a){a=a.audio_info;this.log("Player has restarted the track: %s - %s - %s (pos: %d)",a.artist,a.album,a.title,a.position)});plr_event_listeners.set("plr_onClose",function(a){a=a.audio_info;this.log("Player is closed: %s - %s - %s (pos: %d)",a.artist,a.album,a.title,a.position);a={};var b=this.bluetoothctl.getMacsByCriteria("connected",!0);0<b.length&&(a.deviceID=this.deviceIdFromMac(b[0]));this.fireBluetoothEvent("playbackEnded",JSON.stringify(a))});
plr_event_listeners.set("plr_onNext",function(a){a=a.audio_info;this.log("Player has moved to the next track: %s - %s - %s (pos: %d)",a.artist,a.album,a.title,a.position);a={album:a.album,artist:a.artist,genre:a.genre,title:a.title,ui32Duration:a.duration,ui32NumberOfTracks:a.number_of_tracks,ui32TrackNumber:a.track_number};var b=this.bluetoothctl.getMacsByCriteria("connected",!0);0<b.length&&(a.deviceID=this.deviceIdFromMac(b[0]));this.fireBluetoothEvent("playbackNewTrack",JSON.stringify(a))});
plr_event_listeners.set("plr_onSkipNext",function(a){a=a.audio_info;this.log("Player has skipped next track. Selected now: %s - %s - %s (pos: %d)",a.artist,a.album,a.title,a.position);a={album:a.album,artist:a.artist,genre:a.genre,title:a.title,ui32Duration:a.duration,ui32NumberOfTracks:a.number_of_tracks,ui32TrackNumber:a.track_number};var b=this.bluetoothctl.getMacsByCriteria("connected",!0);0<b.length&&(a.deviceID=this.deviceIdFromMac(b[0]));this.fireBluetoothEvent("playbackNewTrack",JSON.stringify(a))});
plr_event_listeners.set("plr_onPrevious",function(a){a=a.audio_info;this.log("Player has moved to the previous track: %s - %s - %s (pos: %d)",a.artist,a.album,a.title,a.position);a={album:a.album,artist:a.artist,genre:a.genre,title:a.title,ui32Duration:a.duration,ui32NumberOfTracks:a.number_of_tracks,ui32TrackNumber:a.track_number};var b=this.bluetoothctl.getMacsByCriteria("connected",!0);0<b.length&&(a.deviceID=this.deviceIdFromMac(b[0]));this.fireBluetoothEvent("playbackNewTrack",JSON.stringify(a))});
plr_event_listeners.set("plr_onSkipPrevious",function(a){a=a.audio_info;this.log("Player has skipped the previous track. Selected now: %s - %s - %s (pos: %d)",a.artist,a.album,a.title,a.position);a={album:a.album,artist:a.artist,genre:a.genre,title:a.title,ui32Duration:a.duration,ui32NumberOfTracks:a.number_of_tracks,ui32TrackNumber:a.track_number};var b=this.bluetoothctl.getMacsByCriteria("connected",!0);0<b.length&&(a.deviceID=this.deviceIdFromMac(b[0]));this.fireBluetoothEvent("playbackNewTrack",
JSON.stringify(a))});plr_event_listeners.set("plr_onError",function(a){this.log("Player error occurred: %s (%d)",a.message,a.value)});module.exports.BluetoothService=BluetoothService;var Bluetooth=function(a,b){BaseEventManager.call(this);this.name="Bluetooth API";this.scene=a;this.identity={name:"bluetooth api",marker:{left:"  { ",right:" } "}};this._options={emulation:!1};this.bluetooth_service=b;this.api_version=null};Bluetooth.prototype=Object.create(BaseEventManager.prototype);
Bluetooth.constructor=Bluetooth;Logger.call(Bluetooth.prototype);Bluetooth.prototype.init=function(a){var b=this;this.api_version=a;this._initBluetoothService(a);this.on("onEmulationModeChanged",function(a){b.bluetooth_service&&b._initBluetoothService(this.api_version)});this.log("Init completed for %s.",this.bluetooth_service.name)};
Bluetooth.prototype._initBluetoothService=function(a){var b=this,d=[];d.push("statusChanged","pairingRequest","pinRequest","requestFailed","streamingStatusChanged","connectionRequest","playbackRequest","deviceFound","deviceLost","playbackStarted","playbackPaused","playbackResumed","playbackStopped","playbackEnded","playbackNewTrack");var e={events:d};if(this.getOption("emulation")){if(this.log("Using Bluetooth emulation."),this.bluetooth_service=new BluetoothService("org.rdk.bluetoothSettings_1"),
0===Object.keys(this.bluetooth_service).length)throw"Not supported.";}else this.log("Using hardware Bluetooth."),this.bluetooth_service||(this.bluetooth_service=this.scene.getService("org.rdk.bluetoothSettings_1")),this.bluetooth_service.name="service manager";this.bluetooth_service||console.error("Unable to initialize %s.","org.rdk.bluetoothSettings_1");this.bluetooth_service.setApiVersionNumber(a);this.bluetooth_service.registerForEvents(JSON.stringify(e));this.bluetooth_service.onEvent=function(a,
d){b.onBluetoothEvent(a,d)};this.log("Registered for events: %s.",JSON.stringify(d))};Bluetooth.prototype.isInitialized=function(){return!!this.bluetooth_service};Bluetooth.prototype.setOption=function(a,b){b=BtUtils.parseBool(b);this._options.hasOwnProperty(a)&&this._options[a]===b||(this._options[a]=b,this.fireEvent("onSetOption",{option:a,value:b}),"emulation"===a&&this.fireEvent("onEmulationModeChanged",{value:b}))};
Bluetooth.prototype.getOption=function(a){if(this._options.hasOwnProperty(a))return this._options[a];this.log('getOption: unknown option "%s"',a)};
Bluetooth.prototype._callMethod=function(a,b){if(this.isInitialized()){void 0===b&&(b="");!("string"===typeof b&&0<b.length)||b.trim().startsWith('"')&&b.trim().endsWith('"')||(b='"'+b+'"');if(b.constructor===Array){for(var d="",e=0;e<b.length;++e){var c="string"===typeof b[e]?'"':"";d=d+(0<e?", ":"")+c+b[e].toString()+c}b=d}"object"===typeof b&&(b=JSON.stringify(b));b.toString().trim().startsWith("[")&&b.toString().trim().endsWith("]")||(b="["+b+"]");b='{"params":'+b+"}";"{params:[]}"===b&&(b="");
b=JSON.stringify(JSON.parse(b));this.log("Calling %s method with params: %s",a,b);b=this.bluetooth_service.callMethod(a,b);this.log("%s returned: %s",a,b);return JSON.parse(b)}this.log("Bluetooth API is not initialized")};
Bluetooth.prototype.onBluetoothEvent=function(a,b){this.log(" New bluetooth event, name: '"+a+"', payload: '"+b+"'");"string"===typeof b?b=JSON.parse(b):this.log("Warning. Service payload is not a string (object?). Forwarding as is.");b.hasOwnProperty("deviceID")&&(b.deviceID=parseInt(b.deviceID));this.fireEvent(a,b)};Bluetooth.prototype.getStatusSupport=function(){return this._callMethod("getStatusSupport")};
Bluetooth.prototype.startDeviceDiscovery=function(a){return this._callMethod("startDeviceDiscovery",a)};Bluetooth.prototype.stopDeviceDiscovery=function(a){this._callMethod("stopDeviceDiscovery")};
Bluetooth.prototype._getDevices=function(a,b){var d=this._callMethod(a),e=[],c="",f=[];switch(a){case "getDiscoveredDevices":c="discoveredDevices";break;case "getPairedDevices":c="pairedDevices";break;case "getConnectedDevices":c="connectedDevices";break;default:c="devices"}d.hasOwnProperty(c)&&(e=d[c]);e=e.filter(function(a){return null!==a});a=$jscomp.makeIterator(e);for(d=a.next();!d.done;d=a.next())(d=d.value)&&d.hasOwnProperty("deviceID")&&(d.deviceID=parseInt(d.deviceID)),d&&d.hasOwnProperty("activeState")&&
(d.active=d.activeState,delete d.activeState);if(void 0===b||!b.constructor===Array)return e;this.log('Applying "%s" filter to the %s.',b,c);e=$jscomp.makeIterator(e);for(d=e.next();!d.done;d=e.next())(c=d.value)&&-1===b.indexOf(c.deviceType)||f.push(c);return f};Bluetooth.prototype.getDiscoveredDevices=function(a){a=this._getDevices("getDiscoveredDevices",a);for(var b=$jscomp.makeIterator(a),d=b.next();!d.done;d=b.next())d.value.discovered=!0;return a};
Bluetooth.prototype.getPairedDevices=function(a){a=this._getDevices("getPairedDevices",a);for(var b=$jscomp.makeIterator(a),d=b.next();!d.done;d=b.next())d=d.value,d.discovered=!1,d.paired=!0;return a};Bluetooth.prototype.getConnectedDevices=function(a){a=this._getDevices("getConnectedDevices",a);for(var b=$jscomp.makeIterator(a),d=b.next();!d.done;d=b.next())d=d.value,d.discovered=!1,d.paired=!0,d.connected=!0;return a};
Bluetooth.prototype.setDeviceConnection=function(a,b,d){this._callMethod("setDeviceConnection",[a,b,d])};Bluetooth.prototype.setDevicePairing=function(a,b){this._callMethod("setDevicePairing",[a,b])};Bluetooth.prototype.enable=function(){return this._callMethod("setBluetoothEnabled","BLUETOOTH_ENABLED")};Bluetooth.prototype.disable=function(){return this._callMethod("setBluetoothEnabled","BLUETOOTH_DISABLED")};
Bluetooth.prototype.enableInput=function(){return this._callMethod("setBluetoothEnabled","BLUETOOTH_INPUT_ENABLED")};Bluetooth.prototype.setBluetoothDiscoverable=function(a){void 0===a&&(a="on");a=BtUtils.parseBool(a);return this._callMethod("setBluetoothDiscoverable",a)};Bluetooth.prototype.setSinkDiscovery=function(a){return this.setBluetoothDiscoverable(a)};Bluetooth.prototype.getDeviceInfo=function(a){return this._callMethod("getDeviceInfo",a)};
Bluetooth.prototype.respondToEvent=function(a){2>this.api_version||this._callMethod("respondToEvent",a)};Bluetooth.prototype.setBluetoothProperties=function(a){this._callMethod("setBluetoothProperties",a)};Bluetooth.prototype.setPlayback=function(a,b){2>this.api_version||this._callMethod("setPlayback",[a,b])};module.exports.Bluetooth=Bluetooth;
var Color={RED:4278190335,GREEN:16711935,BLUE:65535,CYAN:16777215,X1_BLUE:8768511,DARKBLUE:860905215,ALMOST_WHITE:4294967269,GREY:4294967223,DARKGREY:4294967155,STROKEGREY:4294967093,ALMOST_BLACK:4294967078,TRANSPARENT:4294967040,BLACK:0,BKG_SOLID:255,BKG_DARK10:249,BKG_VERY_DARK:249,BKG_LIGHT:214,BKG_OVERLAY_DARK:909522648};module.exports.Color=Color;
var Colors={WHITE:4294967295,HIGHLIGHT:1116140799,TRANSPARENT:0,CORNFLOWER_BLUE:1717987071,DODGE_BLUE:1015087103,BLACK:255,TALL_POPPY:3241749503,BACKGROUND:943208703,BACKGROUND1:1313754879,BTNBACKGROUND:2155905279,TEXT:1233778943,LISTPARENT:623191551,HEADER:2256963327,DEVICE_BACKGROUND:926299903,LIST_NORMAL:690563583,LIST_HIGHLIGHT:1010580735,STATUS_COLOR:2644352511,WIFI_TEXT:1296911871};module.exports.Colors=Colors;var Command=function(a){this.execute=a};module.exports.Command=Command;
var DetailsItem=function(a,b){function d(){var a=g.getChild(g.numChildren-1);a.y+a.h>=g.h&&(g.h=a.y+a.h+25)}this.model=b;var e=global.registry.all.Utils,c=0,f=0,l=0,q=.6,g=a.create({t:"rect",parent:this.model.parent,x:this.model.x,y:this.model.y,w:this.model.w,h:this.model.h,lineWidth:1,lineColor:e.blackSolidColor,fillColor:3132799743});b=a.create({t:"rect",parent:g,x:1,w:g.w-2,h:35,lineColor:e.transparentColor,fillColor:e.xfinityBlueColor});var m=(g.w-e.boldFont.measureText(18,this.model.title).w)/
2,t=(b.h-e.boldFont.measureText(18,this.model.title).h)/2;a.create({t:"text",parent:g,x:m,y:t,w:160,h:25,text:this.model.title,font:e.boldFont,pixelSize:18,alignHorizontal:a.alignHorizontal.CENTER,textColor:e.charcoalGreyColor});var u=b.y+b.h+20,n=u,h=u;this.addRow=function(b,f,l){var k=3520188927,h=3907578111;0!=c%2&&(k=3907578111,h=3520188927);1==(void 0===l?!1:l)&&(u+=20);k=a.create({t:"rect",parent:g,x:20,y:u,w:g.w-40,h:25,fillColor:k});b=a.create({t:"text",parent:k,x:5,y:5,w:160,h:25,text:b,
font:e.boldFont,pixelSize:12,alignHorizontal:a.alignHorizontal.CENTER,textColor:e.charcoalGreyColor});l=a.create({t:"rect",parent:k,x:k.w*q,w:1,h:k.h,fillColor:h});h=a.create({t:"textBox",parent:k,x:l.x+5,y:5,w:500,h:25,text:f,font:e.regularFont,pixelSize:11,alignHorizontal:a.alignHorizontal.LEFT,textColor:e.blackSolidColor,wordWrap:!0});f=h.measureText(f).bounds;if(k.h<f.y2-f.y1){var p=k.h;k.h=f.y2-f.y1+10;l.h=k.h;b.y+=(k.h-p)/2;u+=k.h}else u+=25;c++;d();return h};this.addRowLeft=function(b,c,l){var k=
3520188927,h=3907578111;0!=f%2&&(k=3907578111,h=3520188927);1==(void 0===l?!1:l)&&(n+=20);k=a.create({t:"rect",parent:g,x:20,y:n,w:(g.w-60)/2,h:25,fillColor:k});b=a.create({t:"text",parent:k,x:5,y:5,w:80,h:25,text:b,font:e.boldFont,pixelSize:12,alignHorizontal:a.alignHorizontal.CENTER,textColor:e.charcoalGreyColor});l=a.create({t:"rect",parent:k,x:k.w*q,w:1,h:k.h,fillColor:h});h=a.create({t:"textBox",parent:k,x:l.x+5,y:5,w:120,h:25,text:c,font:e.regularFont,pixelSize:11,alignHorizontal:a.alignHorizontal.LEFT,
textColor:e.blackSolidColor,wordWrap:!0});c=h.measureText(c).bounds;if(k.h<c.y2-c.y1){var p=k.h;k.h=c.y2-c.y1+10;l.h=k.h;b.y+=(k.h-p)/2;n+=k.h}else n+=25;f++;d();return h};this.addRowRight=function(b,c,f){var k=3520188927,x=3907578111;0!=l%2&&(k=3907578111,x=3520188927);1==(void 0===f?!1:f)&&(h+=20);k=a.create({t:"rect",parent:g,x:(g.w-60)/2+40,y:h,w:(g.w-60)/2,h:25,fillColor:k});b=a.create({t:"text",parent:k,x:5,y:5,w:80,h:25,text:b,font:e.boldFont,pixelSize:12,alignHorizontal:a.alignHorizontal.CENTER,
textColor:e.charcoalGreyColor});f=a.create({t:"rect",parent:k,x:k.w*q,w:1,h:k.h,fillColor:x});x=a.create({t:"textBox",parent:k,x:f.x+5,y:5,w:120,h:25,text:c,font:e.regularFont,pixelSize:11,alignHorizontal:a.alignHorizontal.LEFT,textColor:e.blackSolidColor,wordWrap:!0});c=x.measureText(c).bounds;if(k.h<c.y2-c.y1){var p=k.h;k.h=c.y2-c.y1+10;f.h=k.h;b.y+=(k.h-p)/2;h+=k.h}else h+=25;l++;d();return x};this.setSeparatorPlacement=function(a){q=a};this.setHeight=function(a){g.h=a}};
module.exports.DetailsItem=DetailsItem;
var DialogItem=function(a,b,d,e){var c=global.registry.root,f=global.registry.all.Utils,l=a.create({t:"rect",parent:c,x:(c.w-500)/2,y:(c.h-240)/2,w:500,h:240,lineWidth:2,lineColor:f.blackSolidColor,fillColor:f.charcoalGreyColor});c=a.create({t:"text",parent:l,x:40,y:40,w:160,h:25,text:b.title,font:f.boldFont,pixelSize:20,alignHorizontal:a.alignHorizontal.CENTER,textColor:f.xfinityBlueColor});b=a.create({t:"text",parent:l,x:40,y:c.y+c.h+30,w:160,h:25,text:b.mainText,font:f.regularFont,pixelSize:18,
alignHorizontal:a.alignHorizontal.CENTER,textColor:f.textColor});b=a.create({t:"rect",parent:l,x:40,y:b.y+b.h+40,w:l.w-80,lineWidth:1,h:1,lineColor:f.greyColor,fillColor:f.greyColor});c=40+(b.w/2-f.regularFont.measureText(18,"OK").w)/2;a.create({t:"text",parent:l,x:c,y:b.y+b.h+15,h:25,text:"OK",font:f.boldFont,pixelSize:18,alignHorizontal:a.alignHorizontal.CENTER,textColor:f.textColor});var q=a.create({t:"rect",parent:l,x:40,y:b.y,w:b.w/2,lineWidth:2,h:5,lineColor:f.xfinityBlueColor,fillColor:f.xfinityBlueColor});
c=40+b.w/2+(b.w/2-f.regularFont.measureText(18,"Cancel").w)/2;c=a.create({t:"text",parent:l,x:c,y:b.y+b.h+15,h:25,text:"Cancel",font:f.boldFont,pixelSize:18,alignHorizontal:a.alignHorizontal.CENTER,textColor:f.textColor});var g=a.create({t:"rect",parent:l,x:40+b.w/2,y:b.y,w:b.w/2,lineWidth:2,h:5,lineColor:f.xfinityBlueColor,fillColor:f.xfinityBlueColor});b=a.create({t:"rect",parent:l,x:40,y:c.y+c.h+15,w:l.w-80,lineWidth:1,h:1,lineColor:f.greyColor,fillColor:f.greyColor});var m=a.create({t:"rect",
parent:l,x:40,y:b.y-4,w:b.w/2,lineWidth:2,h:5,lineColor:f.xfinityBlueColor,fillColor:f.xfinityBlueColor}),t=a.create({t:"rect",parent:l,x:40+b.w/2,y:b.y-4,w:b.w/2,lineWidth:2,h:5,lineColor:f.xfinityBlueColor,fillColor:f.xfinityBlueColor});q.draw=!1;g.draw=!1;m.draw=!1;t.draw=!1;this.handleKeys=function(a){switch(a.keyCode){case Keys.ENTER:m.draw?d():t.draw&&e();break;case Keys.RIGHT:m.draw=!1;q.draw=!1;t.draw=!0;g.draw=!0;break;case Keys.LEFT:t.draw=!1,g.draw=!1,m.draw=!0,q.draw=!0}};this.show=function(){l.a=
1};this.hide=function(){l.a=0};this.isVisible=function(){return 1==l.a}};module.exports.DialogItem=DialogItem;
px.import({scene:"px:scene.1.js",keys:"px:tools.keys"}).then(function(a){var b=a.scene,d=a.keys;module.exports.EditBox=function(a){function c(a){console.log("layout( "+a+" ) >>> WxH: "+this._w+" x "+this._h+" at ("+this._x+","+this._y+")")}function e(a,b){F.w=a;F.h=b;y.w=a;Q.w=a-2}function l(a){a=y.text.slice().slice(0,a);a=N.measureText(L,a);E.x=a.w-R;0>E.x&&(E.x=1+R);a=4*E.w;var b=Q.w-E.x-a,c=P<=b,d=Q.w-a,e=Math.abs(b-P);P=b;E.x>d?(c?C<d-a-20&&(C+=e):c||C>a&&(C-=e),H.x=b-C):C=H.x=0}function q(){G=
"";B=A=0;I.x=0;I.w=0}function g(){0>=G.length||(w=w.replace(G,""),y.text="Normal"===r._echoMode?w:D.repeat(w.length),0<B&&(p-=G.length),l(p),q(),J.a=0<y.text.length?0:1)}function m(a,b){var c=a+b;I.a=0===b?0:.75;if(0!==b){0>b&&(c=a,a+=b);G=w.slice().slice(a,c);var d=N.measureText(L,G);I.x=v-R;I.w=d.w+R;0>b&&(I.x-=d.w);p=0<b?c:a;l(p)}}function t(){E.a=0}function u(){E.a=1;k()}function n(){p=0;l(p);q()}function h(){p=y.text.length;l(p);q()}function z(){0===B&&(A=p,v=E.x+R);B+=-p;m(A,B);p=0}function x(){0===
B&&(A=p,v=E.x+R);B+=y.text.length-p;m(A,B);p=y.text.length}function k(){E.animateTo({a:0},.5,b.animation.TWEEN_LINEAR,b.animation.OPTION_OSCILLATE,b.animation.COUNT_FOREVER)}this._x=0;Object.defineProperty(this,"x",{set:function(a){this._x=a;c("setX( "+a+" )")},get:function(){return this._x}});this._y=0;Object.defineProperty(this,"y",{set:function(a){this._y=a;c("setY( "+a+" )")},get:function(){return this._y}});this._w=0;Object.defineProperty(this,"w",{set:function(a){this._w=a;e(this._w,this._h)},
get:function(){return this._w}});this._h=0;Object.defineProperty(this,"h",{set:function(a){this._h=a;e(this._w,this._h)},get:function(){return this._h}});Object.defineProperty(this,"focus",{set:function(a){(y.focus=a)?u():t()},get:function(){return y.focus}});this._keepFocus=!1;Object.defineProperty(this,"keepFocus",{set:function(a){this._keepFocus=a},get:function(){return this._keepFocus}});this._showFocus=!1;Object.defineProperty(this,"showFocus",{set:function(a){this._showFocus=a},get:function(){return this._showFocus}});
Object.defineProperty(this,"interactive",{set:function(a){y.interactive=a;H.interactive=a;console.log(">>> interactive = "+a)},get:function(){return y.interactive}});Object.defineProperty(this,"text",{set:function(a){w=a;y.text="Normal"===r._echoMode?w:D.repeat(w.length);J.a=0<y.text.length?0:1},get:function(){return w.trim()}});Object.defineProperty(this,"onchar",{set:function(a){if("Back"===a){var b=w.slice();0===B?(a=b.slice(0,p-1),b=b.slice(p),w=a+b,y.text="Normal"===r._echoMode?w:D.repeat(w.length),
0<p&&p--):g();J.a=0<y.text.length?0:1}else y.textColor=K,g(),w=w.slice(0,p)+a+w.slice(p),y.text="Normal"===this._echoMode?w:D.repeat(w.length),J.a=0<y.text.length?0:1,p+=1;l(p)}});Object.defineProperty(this,"prompt",{set:function(a){J.text=a},get:function(){return J.text.trim()}});Object.defineProperty(this,"textColor",{set:function(a){y.textColor=a},get:function(){return y.textColor}});this._enableCopy=!0;Object.defineProperty(this,"enableCopy",{set:function(a){this._enableCopy=a},get:function(){return this._enableCopy}});
this._enablePaste=!0;Object.defineProperty(this,"enablePaste",{set:function(a){this._enablePaste=a},get:function(){return this._enablePaste}});this._echoMode="Password";Object.defineProperty(this,"echoMode",{set:function(a){this._echoMode=a;y.text="Normal"===this._echoMode?w:D.repeat(w.length)},get:function(){return this._echoMode}});Object.defineProperty(this,"cursorpos",{set:function(a){p=a},get:function(){return p}});this.moveToHome=n;this.moveToEnd=h;this.selectAll=function(){n();x()};this.clearSelection=
q;this.hideCursor=t;this.showCursor=u;var r=this,w="",p=0,v=0,A=0,B=0,G="",P=0,C=0,D="\u2022";this._x="x"in a?a.x:0;this._y="y"in a?a.y:0;this._w="w"in a?a.w:200;this._h="h"in a?a.h:50;var L="pts"in a?a.pts:24,U="font"in a?a.font:"FreeSans.ttf",M="prompt_text"in a?a.prompt_text:"Password",O="prompt_color"in a?a.prompt_color:1313754879,V="selection_color"in a?a.selection_color:4243760264,K="text_color"in a?a.text_color:808464639,T="show_focus"in a?a.show_focus:!1,F=b.create({t:"object",parent:"parent"in
a?a.parent:b.root,x:this._x,y:this._y,w:this._w,h:this._h}),Q=b.create({t:"object",parent:F,x:0,y:0,w:this._w,h:this._h,clip:!0}),N=b.create({t:"fontResource",url:U}),H=b.create({t:"object",parent:Q,x:0,y:0,w:this._w,h:this._h}),S=b.create({t:"rect",w:H.w,h:H.h,parent:H,fillColor:4294967280,x:0,y:0,a:T?.25:0}),J=b.create({t:"text",text:M,font:N,parent:H,pixelSize:L,textColor:O,x:2,y:0}),I=b.create({t:"rect",w:0,h:this._h,parent:H,fillColor:V,x:0,y:0,a:0}),y=b.create({t:"text",text:"",font:N,parent:H,
h:H.h,pixelSize:L,textColor:K,x:2,y:0}),E=b.create({t:"rect",w:2,h:this._h,parent:y,x:0,y:0,fillColor:4294967295,a:0}),R=E.w/2;Promise.all([N,Q,J,y,H,E,I]).catch(function(a){console.log(">>> Loading Assets ... err = "+a)}).then(function(a,b){Q.interactive=!1;J.interactive=!1;I.interactive=!1;E.interactive=!1;S.interactive=!1;e(r.w,r.h);a=N.measureText(L,"ABCdef123'");y.y=(F.h-a.h)/2;S.h=a.h;S.y=y.y;b=N.measureText(L,y.text);H.w=b.w;I.h=.85*F.h;I.y=(F.h-I.h)/2;E.h=.65*a.h;E.y=(F.h-E.h)/2-y.y;J.y=y.y;
l(0);k()});y.on("onFocus",function(a){u();y.textColor=K});y.on("onBlur",function(a){t()});y.on("onChar",function(a){y.textColor=K;a.charCode!=d.ENTER&&(0!==B&&g(),a.charCode!=d.BACKSPACE&&(g(),w=w.slice(0,p)+String.fromCharCode(a.charCode)+w.slice(p),y.text="Normal"===r._echoMode?w:D.repeat(w.length),J.a=0<y.text.length?0:1,p+=1,l(p)))});y.on("onKeyDown",function(a){var c=a.keyCode;switch(c){case d.BACKSPACE:var e=w.slice();if(0===B){var f=e.slice(0,p-1);e=e.slice(p);w=f+e;y.text="Normal"===r._echoMode?
w:D.repeat(w.length);0<p&&p--}else g();J.a=0<y.text.length?0:1;break;case d.DELETE:e=w.slice();0===B?(f=e.slice(0,p),e=e.slice(p+1),w=f+e,y.text="Normal"===r._echoMode?w:D.repeat(w.length)):g();J.a=0<y.text.length?0:1;break;case d.HOME:r._enableCopy&&d.is_SHIFT(a.flags)?z():n();break;case d.END:r._enableCopy&&d.is_SHIFT(a.flags)?x():h();break;case d.LEFT:if(0===p)break;d.is_CTRL(a.flags)||d.is_CMD(a.flags)?n():r._enableCopy&&(d.is_CTRL_SHIFT(a.flags)||d.is_CMD_SHIFT(a.flags))?z():r._enableCopy&&d.is_SHIFT(a.flags)?
(0===B&&(A=p,v=E.x+R),B--,m(A,B)):(0!==I.w&&q(),p--);break;case d.RIGHT:if(p===y.text.length){console.log("DEBUG:  EDITBOX >> Already at END ! ");break}d.is_CTRL(a.flags)||d.is_CMD(a.flags)?h():r._enableCopy&&(d.is_CTRL_SHIFT(a.flags)||d.is_CMD_SHIFT(a.flags))?x():r._enableCopy&&d.is_SHIFT(a.flags)?(0===B&&(A=p,v=E.x+R),B++,m(A,B)):(0!==I.w&&q(),p++);break;case d.A:r._enableCopy&&(d.is_CTRL(a.flags)||d.is_CMD(a.flags))&&(p=0,v=y.x,A=0,0<y.text.length&&(B=y.text.length+1),m(A,B),a.stopPropagation());
break;case d.C:r._enableCopy&&(d.is_CTRL(a.flags)||d.is_CMD(a.flags))&&b.clipboardSet("PX_CLIP_STRING",G);break;case d.V:r._enablePaste&&(d.is_CTRL(a.flags)||d.is_CMD(a.flags))&&(g(),f=b.clipboardGet("PX_CLIP_STRING"),w=w.slice(0,p)+f+w.slice(p),y.text=w,J.a=0<y.text.length?0:1,E.x=y.x+y.w,p+=f.length,q());break;case d.X:d.is_CTRL(a.flags)&&(b.clipboardSet("PX_CLIP_STRING",G),g())}l(p);c!==d.LEFT&&c!==d.RIGHT||a.stopPropagation()});this.ready=new Promise(function(a,b){Promise.all([J.ready]).then(function(){a()})})}}).catch(function(a){console.error("Import failed for editBox.js: "+
a)});
var HScrollList=function(a,b){function d(){if(0!=m.length)if(0>m[0])if(0>t.x&&0<f){--f;var a=t.x+l[f];t.animateTo({x:a},.2,e.animation.TWEEN_EXP1).then(function(){m.shift();d()},null)}else m.shift();else f<l.length?(a=t.x-l[f],t.animateTo({x:a},.2,e.animation.TWEEN_EXP1).then(function(){f++;m.shift();d()},null)):m.shift()}var e=a;a=global.registry.root;var c=global.registry.all.Utils,f=0,l=[],q=e.create({t:"rect",parent:b.parent,x:b.x,y:b.y,w:b.w,h:b.h,fillColor:c.transparentColor});q.clip=!0;var g,
m=[],t=e.create({t:"rect",parent:q,w:10*a.w,h:q.h,fillColor:c.transparentColor});this.scrollLeft=function(){m.push(-1);1==m.length&&d()};this.scrollRight=function(){m.push(1);1==m.length&&d()};this.addCol=function(a){if(g){if(g.y=0,g.w=q.w,g.h=q.h,t.numChildren){var b=t.getChild(t.numChildren-1).w;g.x+=b;l.push(b)}}else g={x:0,y:0,w:q.w,h:q.h};b=g;a(t,b)};this.clear=function(){t.removeAll();f=l.length=0;g=null;t.x=0}};module.exports.HScrollList=HScrollList;
function Keyboard(a,b){function d(a,b,c){return Math.min(Math.max(b,a),c)}var e=b.keys,c=b.Colors,f=global.registry.baseUrl,l=b.parent,q=b.eventManager,g=this;b=l.w/10;var m=b-10,t=m/2,u=0,n=0,h=null,z={uppercaseAlphabet:{row1:[{x:0,text:"Q"},{x:1*b,text:"W"},{x:2*b,text:"E"},{x:3*b,text:"R"},{x:4*b,text:"T"},{x:5*b,text:"Y"},{x:6*b,text:"U"},{x:7*b,text:"I"},{x:8*b,text:"O"},{x:9*b,text:"P"}],row2:[{x:t,text:"A"},{x:1*b+t,text:"S"},{x:2*b+t,text:"D"},{x:3*b+t,text:"F"},{x:4*b+t,text:"G"},{x:5*b+
t,text:"H"},{x:6*b+t,text:"J"},{x:7*b+t,text:"K"},{x:8*b+t,text:"L"}],row3:[{x:20,w:m+40,text:"SHIFT"},{x:1*b+60,text:"Z"},{x:2*b+60,text:"X"},{x:3*b+60,text:"C"},{x:4*b+60,text:"V"},{x:5*b+60,text:"B"},{x:6*b+60,text:"N"},{x:7*b+60,text:"M"},{x:8*b+60,w:m+30,text:"Back"}],row4:[{x:0,w:m+40,text:"?123"},{x:1*b+40,w:m+40,text:"=\\<"},{x:2*b+80,text:","},{x:3*b+80,w:8*b-30-(3*b+90),text:""},{x:8*b-30,text:"."},{x:9*b-30,w:m+30,text:"Enter"}]},lowercaseAlphabet:{row1:[{x:0,text:"q"},{x:1*b,text:"w"},
{x:2*b,text:"e"},{x:3*b,text:"r"},{x:4*b,text:"t"},{x:5*b,text:"y"},{x:6*b,text:"u"},{x:7*b,text:"i"},{x:8*b,text:"o"},{x:9*b,text:"p"}],row2:[{x:t,text:"a"},{x:1*b+t,text:"s"},{x:2*b+t,text:"d"},{x:3*b+t,text:"f"},{x:4*b+t,text:"g"},{x:5*b+t,text:"h"},{x:6*b+t,text:"j"},{x:7*b+t,text:"k"},{x:8*b+t,text:"l"}],row3:[{x:20,w:m+40,text:"shift"},{x:1*b+60,text:"z"},{x:2*b+60,text:"x"},{x:3*b+60,text:"c"},{x:4*b+60,text:"v"},{x:5*b+60,text:"b"},{x:6*b+60,text:"n"},{x:7*b+60,text:"m"},{x:8*b+60,w:m+30,
text:"Back"}],row4:[{x:0,w:m+40,text:"?123"},{x:1*b+40,w:m+40,text:"=\\<"},{x:2*b+80,text:","},{x:3*b+80,w:8*b-30-(3*b+90),text:""},{x:8*b-30,text:"."},{x:9*b-30,w:m+30,text:"Enter"}]},numeric:{row1:[{x:0,text:"1"},{x:1*b,text:"2"},{x:2*b,text:"3"},{x:3*b,text:"4"},{x:4*b,text:"5"},{x:5*b,text:"6"},{x:6*b,text:"7"},{x:7*b,text:"8"},{x:8*b,text:"9"},{x:9*b,text:"0"}],row2:[{x:0,text:"@"},{x:1*b,text:"#"},{x:2*b,text:"$"},{x:3*b,text:"_"},{x:4*b,text:"&"},{x:5*b,text:"-"},{x:6*b,text:"+"},{x:7*b,text:"("},
{x:8*b,text:")"},{x:9*b,text:"/"}],row3:[{x:100,text:"*"},{x:1*b+100,text:'"'},{x:2*b+100,text:"'"},{x:3*b+100,text:":"},{x:4*b+100,text:";"},{x:5*b+100,text:"!"},{x:6*b+100,text:"?"},{x:7*b+100,w:m+30,text:"Back"}],row4:[{x:0,w:m+40,text:"ABC"},{x:1*b+40,w:m+40,text:"=\\<"},{x:2*b+80,text:","},{x:3*b+80,w:8*b-30-(3*b+90),text:""},{x:8*b-30,text:"."},{x:9*b-30,w:m+30,text:"Enter"}]},symbols:{row1:[{x:0,text:"~"},{x:1*b,text:"`"},{x:2*b,text:"|"},{x:3*b,text:"\u2022"},{x:4*b,text:"\u221a"},{x:5*b,
text:"\u03c0"},{x:6*b,text:"\u00f7"},{x:7*b,text:"x"},{x:8*b,text:"\u00b6"},{x:9*b,text:"\u2206"}],row2:[{x:0,text:"\u20ac"},{x:1*b,text:"\u00a5"},{x:2*b,text:"$"},{x:3*b,text:"\u00a2"},{x:4*b,text:"^"},{x:5*b,text:"\u00b0"},{x:6*b,text:"="},{x:7*b,text:"{"},{x:8*b,text:"}"},{x:9*b,text:"\\"}],row3:[{x:100,text:"%"},{x:1*b+100,text:"\u00a9"},{x:2*b+100,text:"\u2117"},{x:3*b+100,text:"\u2122"},{x:4*b+100,text:"\u221a"},{x:5*b+100,text:"["},{x:6*b+100,text:"]"},{x:7*b+100,w:m+30,text:"Back"}],row4:[{x:0,
w:m+40,text:"ABC"},{x:1*b+40,w:m+40,text:"?123"},{x:2*b+80,text:","},{x:3*b+80,w:8*b-30-(3*b+90),text:""},{x:8*b-30,text:"."},{x:9*b-30,w:m+30,text:"Enter"}]}};this.sans_default=a.create({t:"fontResource",url:f+"/fonts/DejaVuSans.ttf"});this.defaultResource=a.create({t:"imageResource",w:m,h:100,url:f+"/images/buttonBckground.svg"});this.highlightResource=a.create({t:"imageResource",w:m,h:100,url:f+"/images/buttonHighlight.svg"});this.backResource=a.create({t:"imageResource",w:40,h:40,url:f+
"/images/back.svg"});this.shiftResource=a.create({t:"imageResource",w:40,h:35,url:f+"/images/shift.svg"});this.shiftFillResource=a.create({t:"imageResource",w:40,h:35,url:f+"/images/shiftFill.svg"});this.enterResource=a.create({t:"imageResource",w:60,h:40,url:f+"/images/enter.svg"});this.backImage=a.create({t:"image",w:40,h:40,resource:this.backResource});this.shiftImage=a.create({t:"image",w:40,h:35,resource:this.shiftResource});this.enterImage=a.create({t:"image",w:60,h:40,resource:this.enterResource});
this.container=a.create({t:"object",parent:l,w:l.w,h:l.h,interactive:!1});this.updateState=function(b){var d=z[b];b=Object.keys(d);g.container.painting=!1;g.shiftImage.parent=null;h=b.map(function(b,e){b=d[b];var f=65*e,l=b.map(function(b,d){var A=b.x,p=b.w?b.w:m,l=a.stretch.STRETCH,k=a.stretch.STRETCH;if(h&&h[e]&&h[e][1][d]){var v=h[e][1][d][0];d=h[e][1][d][1];v.x=A;v.y=f;v.w=p;v.stretchX=l;v.stretchY=k;d.w=p;d.text=b.text;2==e&&"shift"==b.text?(d.a=0,g.shiftImage.parent=v,g.shiftImage.x=v.w/2-20,
g.shiftImage.y=v.h/2-17.5,g.shiftImage.resource=g.shiftResource):2==e&&"SHIFT"==b.text?(d.a=0,g.shiftImage.parent=v,g.shiftImage.x=v.w/2-20,g.shiftImage.y=v.h/2-17.5,g.shiftImage.resource=g.shiftFillResource):2==e&&"Back"==b.text?(d.a=0,g.backImage.parent=v,g.backImage.x=v.w/2-20,g.backImage.y=v.h/2-20):3==e&&"Enter"==b.text?(d.a=0,g.enterImage.parent=v,g.enterImage.x=v.w/2-30,g.enterImage.y=v.h/2-15):d.a=1}else v=a.create({t:"image9",insetLeft:5,insetTop:5,insetRight:5,insetBottom:5,parent:g.container,
x:A,y:f,w:p,h:50,resource:g.defaultResource}),d=a.create({t:"textBox",parent:v,textColor:c.WHITE,w:v.w,h:v.h,pixelSize:25,text:b.text,font:g.sans_default,alignHorizontal:a.alignHorizontal.CENTER,alignVertical:a.alignVertical.CENTER}),2==e&&"SHIFT"==b.text?(d.a=0,g.shiftImage.parent=v,g.shiftImage.x=v.w/2-20,g.shiftImage.y=v.h/2-17.5,g.shiftImage.resource=g.shiftFillResource):2==e&&"shift"==b.text?(d.a=0,g.shiftImage.parent=v,g.shiftImage.x=v.w/2-20,g.shiftImage.y=v.h/2-17.5,g.shiftImage.resource=
g.shiftResource):2==e&&"Back"==b.text?(d.a=0,g.backImage.parent=v,g.backImage.x=v.w/2-20,g.backImage.y=v.h/2-20):3==e&&"Enter"==b.text&&(d.a=0,g.enterImage.parent=v,g.enterImage.x=v.w/2-30,g.enterImage.y=v.h/2-15);return[v,d]});if(h&&h[e])for(var A=l.length;A<h[e][0];A++)h[e][1][A][0].remove(),h[e][1][A][1].remove();return[b.length,l]});g.container.painting=!0};this.container.on("onKeyDown",function(a){var b=u,c=n;a.keyCode===e.DOWN?(b=d(u+1,0,3),c=d(n,0,h[b][0]-1)):a.keyCode===e.UP?(b=d(u-1,0,3),
c=d(n,0,h[b][0]-1)):a.keyCode===e.LEFT?(c=d(n-1,0,h[u][0]-1),a.stopPropagation()):a.keyCode===e.RIGHT&&(c=d(n+1,0,h[u][0]-1));if(b!=u||c!=n)h[u][1][n][0].resource=g.defaultResource,u=b,n=c,h[u][1][n][0].resource=g.highlightResource,a.stopPropagation()});this.container.on("onKeyUp",function(a){if(a.keyCode===e.ENTER){var b=h[u][1][n][1].text;"shift"===b?g.updateState("uppercaseAlphabet"):"SHIFT"===b?g.updateState("lowercaseAlphabet"):"ABC"===b?g.updateState("uppercaseAlphabet"):"?123"===b?g.updateState("numeric"):
"=\\<"===b?g.updateState("symbols"):q.fireEvent("onkeyPressed",b);a.stopPropagation()}});Object.defineProperty(this,"focus",{set:function(a){g.container.focus=a;h[u][1][n][0].resource=a?g.highlightResource:g.defaultResource},get:function(){return g.container.focus}});this.updateState("lowercaseAlphabet")}module.exports.Keyboard=Keyboard;
function NetworkDetails(a,b){var d=this,e=b.keys,c=b.Colors,f=b.baseUrl,l=b.parent,q=a.root,g=b._owner,m=a.alignHorizontal.CENTER,t=a.alignVertical.CENTER,u=a.animation.TWEEN_EXP1,n=a.animation.OPTION_FASTFORWARD,h=a.create({t:"fontResource",url:f+"/fonts/DejaVuSans.ttf"}),z=a.create({t:"fontResource",url:f+"/fonts/DejaVuSans.ttf"}),x=a.create({t:"imageResource",w:b.w,h:b.h,url:f+"/images/popBackground.svg"}),k=a.create({t:"imageResource",w:130,h:40,url:f+"/images/buttonBckground.svg"}),
r=a.create({t:"imageResource",w:130,h:40,url:f+"/images/buttonHighlight.svg"});this.device=b.device;this.ready=new Promise(function(f,p){Promise.all([x.ready,k.ready,r.ready]).then(function(){d.popupParent=a.create({t:"image",parent:q,w:b.w,h:b.h,x:b.x,y:b.y,interactive:!1,a:.95,sx:0,sy:0,cx:b.cx,cy:b.cy,resource:x,stretchX:a.stretch.STRETCH,stretchY:a.stretch.STRETCH});d.margine=a.create({t:"rect",parent:d.popupParent,fillColor:c.WHITE,w:d.popupParent.w,h:2,y:70,a:.3});d.title=a.create({t:"textBox",
parent:d.popupParent,textColor:c.WHITE,w:d.popupParent.w,font:z,h:40,y:16,pixelSize:35,text:b.title,alignHorizontal:m,alignVertical:t});d.description=a.create({t:"textBox",parent:d.popupParent,textColor:c.WHITE,wordWrap:!0,font:h,w:d.popupParent.w-100,h:150,x:50,y:80,pixelSize:27,text:b.description});d.cancelParent=a.create({t:"image9",parent:d.popupParent,w:130,h:40,x:60,y:b.h-70,cx:65,cy:20,resource:k});d.cancelText=a.create({t:"textBox",parent:d.cancelParent,textColor:c.WHITE,w:d.cancelParent.w,
font:h,h:d.cancelParent.h,pixelSize:25,text:"Cancel",alignHorizontal:m,alignVertical:t});d.modifyParent=a.create({t:"image9",parent:d.popupParent,w:130,h:40,x:240,y:b.h-70,cx:65,cy:20,resource:k});d.modifyText=a.create({t:"textBox",parent:d.modifyParent,textColor:c.WHITE,w:d.modifyParent.w,font:h,h:d.modifyParent.h,pixelSize:25,text:"Modify",alignHorizontal:m,alignVertical:t});d.forgetParent=a.create({t:"image9",parent:d.popupParent,w:130,h:40,x:d.popupParent.w-180,y:d.popupParent.h-70,cx:65,cy:20,
resource:k});d.forgetText=a.create({t:"textBox",parent:d.forgetParent,textColor:c.WHITE,text:"Forget",font:h,w:d.forgetParent.w,h:d.forgetParent.h,pixelSize:25,alignHorizontal:m,alignVertical:t});d.cancelParent.on("onKeyDown",function(a){a.keyCode==e.RIGHT&&(d.modifyParent.focus=!0,d.modifyParent.resource=r,d.cancelParent.resource=k);a.stopPropagation()});d.cancelParent.on("onKeyUp",function(a){a.keyCode==e.ENTER&&(l.onPopupClose(),d.cancelParent.animateTo({sx:1.3,sy:1.3},.1,u,n,1).then(function(){d.cancelParent.animateTo({sx:1,
sy:1},.1,u,n,1)}),d.hide());a.stopPropagation()});d.modifyParent.on("onKeyDown",function(a){var b=a.keyCode;b==e.RIGHT?(d.forgetParent.focus=!0,d.forgetParent.resource=r,d.modifyParent.resource=k):b==e.LEFT&&(d.cancelParent.focus=!0,d.cancelParent.resource=r,d.modifyParent.resource=k);a.stopPropagation()});d.modifyParent.on("onKeyUp",function(a){a.keyCode==e.ENTER&&(l.onPopupClose(),d.modifyParent.animateTo({sx:1.3,sy:1.3},.1,u,n,1).then(function(){d.modifyParent.animateTo({sx:1,sy:1},.1,u,n,1)}),
d.hide());a.stopPropagation()});d.forgetParent.on("onKeyDown",function(a){a.keyCode==e.LEFT&&(d.modifyParent.focus=!0,d.modifyParent.resource=r,d.forgetParent.resource=k);a.stopPropagation()});d.forgetParent.on("onKeyUp",function(a){a.keyCode==e.ENTER&&(l.onPopupClose(),d.forgetParent.animateTo({sx:1.3,sy:1.3},.1,u,n,1).then(function(){d.forgetParent.animateTo({sx:1,sy:1},.1,u,n,1)}),g.fireEvent("onclearSSID"),d.hide());a.stopPropagation()});d.show=function(){var b=this;this.popupParent.animateTo({x:a.w/
2-this.popupParent.w/2,y:a.h/2-this.popupParent.h/2,sx:1,sy:1,a:.95},.3,u,n,1).then(function(a){b.popupParent.cx=b.popupParent.w/2;b.popupParent.cy=b.popupParent.h/2});this.cancelParent.focus=!0;this.cancelParent.resource=r};d.hide=function(){this.popupParent.animateTo({sx:2,sy:2,a:0},.3,a.animation.TWEEN_LINEAR,n,1).then(function(a){})};d.setFocus=function(){this.forgetParent.resource=k;this.modifyParent.resource=k;this.cancelParent.focus=!0;this.cancelParent.resource=r};f("sucess")}).catch(function(a){console.log("Promise failed in popup",
a);p(Error("Promise failed"))})})}module.exports.NetworkDetails=NetworkDetails;
function Popup(a,b){var d=this,e=b.keys,c=b.Colors,f=b.isDetailsPopup?b.isDetailsPopup:0,l=b.baseUrl,q=f?130:60,g=b._owner,m=b.parent,t=a.root,u=a.alignHorizontal.CENTER,n=a.alignVertical.CENTER,h=a.animation.TWEEN_EXP1,z=a.animation.OPTION_FASTFORWARD,x=a.create({t:"fontResource",url:l+"/fonts/DejaVuSans.ttf"}),k=a.create({t:"imageResource",w:b.w,h:b.h,url:l+"/images/popBackground.svg"}),r=a.create({t:"imageResource",w:q,h:40,url:l+"/images/buttonBckground.svg"}),w=a.create({t:"imageResource",
w:q,h:40,url:l+"/images/buttonHighlight.svg"}),p=a.create({t:"imageResource",w:35,h:35,url:l+"/images/volumeIcon.svg"}),v=a.create({t:"imageResource",w:25,h:25,url:l+"/images/whiteCircleHolo.svg"}),A=a.create({t:"imageResource",w:25,h:25,url:l+"/images/highlightCircle.svg"});this.device=b.device;this.isLoudSpeaker=this.device.deviceType.match(/LOUDSPEAKER/i);this.ready=new Promise(function(l,G){Promise.all([k.ready,r.ready,w.ready]).then(function(){d.popupParent=a.create({t:"image",parent:t,w:b.w,
h:b.h,x:b.x,y:b.y,interactive:!1,a:.95,sx:0,sy:0,cx:b.cx,cy:b.cy,resource:k,stretchX:a.stretch.STRETCH,stretchY:a.stretch.STRETCH});d.margine=a.create({t:"rect",parent:d.popupParent,fillColor:c.WHITE,w:d.popupParent.w,h:2,y:70,a:.3});d.title=a.create({t:"textBox",parent:d.popupParent,textColor:c.WHITE,w:d.popupParent.w,font:x,h:40,y:16,pixelSize:35,text:b.title,alignHorizontal:u,alignVertical:n});d.description=a.create({t:"textBox",parent:d.popupParent,textColor:c.WHITE,wordWrap:!0,font:x,w:d.popupParent.w-
100,h:150,x:50,y:80,pixelSize:27,text:b.description});d.volumeObject=a.create({t:"object",parent:d.popupParent,w:200,h:70,x:50,y:120,resource:p,a:d.isLoudSpeaker?1:0});d.volumeIcon=a.create({t:"image9",parent:d.volumeObject,w:35,h:35,resource:p});d.volumeDownIcon=a.create({t:"image9",parent:d.volumeObject,w:25,h:25,cx:12.5,cy:12.5,x:50,y:5,resource:v});d.volumeDownText=a.create({t:"textBox",parent:d.volumeObject,w:25,h:25,x:50,y:-6,pixelSize:20,textColor:c.WHITE,font:x,text:"_",alignHorizontal:a.alignHorizontal.CENTER,
alignVertical:a.alignVertical.TOP});d.volumeUpIcon=a.create({t:"image9",parent:d.volumeObject,w:25,h:25,cx:12.5,cy:12.5,x:85,y:5,resource:v});d.volumeUpText=a.create({t:"textBox",parent:d.volumeObject,w:25,h:25,x:85,y:2,pixelSize:20,textColor:c.WHITE,font:x,text:"+",alignHorizontal:a.alignHorizontal.CENTER,alignVertical:a.alignVertical.CENTER});d.yesParent=a.create({t:"image9",parent:d.popupParent,w:q,h:40,x:b.isDetailsPopup?60:b.w/2-q-30,y:b.h-70,cx:q/2,cy:20,resource:r});d.yesText=a.create({t:"textBox",
parent:d.yesParent,textColor:c.WHITE,w:d.yesParent.w,font:x,h:d.yesParent.h,pixelSize:25,text:b.yes.text,alignHorizontal:u,alignVertical:n});d.noParent=a.create({t:"image9",parent:d.popupParent,w:q,h:40,x:f?240:b.w/2+30,y:b.h-70,cx:q/2,cy:20,resource:r});d.noText=a.create({t:"textBox",parent:d.noParent,textColor:c.WHITE,w:d.noParent.w,font:x,h:d.noParent.h,pixelSize:25,text:b.no.text,alignHorizontal:u,alignVertical:n});d.cancelParent=a.create({t:"image9",parent:d.popupParent,w:q,h:40,a:f,x:d.popupParent.w-
180,y:d.popupParent.h-70,cx:q/2,cy:20,resource:r});d.cancelText=a.create({t:"textBox",parent:d.cancelParent,textColor:c.WHITE,text:"Cancel",font:x,w:d.cancelParent.w,h:d.cancelParent.h,pixelSize:25,alignHorizontal:u,alignVertical:n});d.volumeDownIcon.on("onKeyDown",function(a){var b=a.keyCode;b==e.DOWN?(d.yesParent.focus=!0,d.yesParent.resource=w,d.volumeDownIcon.resource=v):b==e.RIGHT&&(d.volumeUpIcon.focus=!0,d.volumeUpIcon.resource=A,d.volumeDownIcon.resource=v);a.stopPropagation()});d.volumeDownIcon.on("onKeyUp",
function(a){a.keyCode==e.ENTER&&(d.volumeDownIcon.animateTo({sx:1.3,sy:1.3},.1,h,z,1).then(function(){d.volumeDownIcon.animateTo({sx:1,sy:1},.1,h,z,1)}),a.device=d.device,g.fireEvent("scr_onVolumeDown",a));a.stopPropagation()});d.volumeUpIcon.on("onKeyDown",function(a){var b=a.keyCode;b==e.DOWN?(d.yesParent.focus=!0,d.yesParent.resource=w,d.volumeUpIcon.resource=v):b==e.LEFT&&(d.volumeDownIcon.focus=!0,d.volumeDownIcon.resource=A,d.volumeUpIcon.resource=v);a.stopPropagation()});d.volumeUpIcon.on("onKeyUp",
function(a){a.keyCode==e.ENTER&&(d.volumeUpIcon.animateTo({sx:1.3,sy:1.3},.1,h,z,1).then(function(){d.volumeUpIcon.animateTo({sx:1,sy:1},.1,h,z,1)}),a.device=d.device,g.fireEvent("scr_onVolumeUp",a));a.stopPropagation()});d.yesParent.on("onKeyDown",function(a){var b=a.keyCode;b==e.RIGHT?(d.noParent.focus=!0,d.noParent.resource=w,d.yesParent.resource=r):b==e.UP&&d.isLoudSpeaker&&(d.volumeDownIcon.focus=!0,d.volumeDownIcon.resource=A,d.yesParent.resource=r);a.stopPropagation()});d.yesParent.on("onKeyUp",
function(a){a.keyCode==e.ENTER&&(m.onPopupClose(),d.yesParent.animateTo({sx:1.3,sy:1.3},.1,h,z,1).then(function(){d.yesParent.animateTo({sx:1,sy:1},.1,h,z,1)}),"Pairing Request"==d.title.text?(a.device=d.device,g.fireEvent("scr_onPairingAccept",a)):"Connection Request"==d.title.text?(a.device=d.device,g.fireEvent("scr_onConnectionAccept",a)):"Bluetooth Device Settings"==d.title.text&&(a.device=d.device,a.device&&a.device.connected?g.fireEvent("onDeviceDisconnect",a):g.fireEvent("scr_onDeviceSelected",
a)),d.hide());a.stopPropagation()});d.noParent.on("onKeyDown",function(a){var b=a.keyCode;b==e.RIGHT&&f?(d.cancelParent.focus=!0,d.cancelParent.resource=w,d.noParent.resource=r):b==e.LEFT?(d.yesParent.focus=!0,d.yesParent.resource=w,d.noParent.resource=r):b==e.UP&&d.isLoudSpeaker&&(d.volumeDownIcon.focus=!0,d.volumeDownIcon.resource=A,d.noParent.resource=r);a.stopPropagation()});d.noParent.on("onKeyUp",function(a){a.keyCode==e.ENTER&&(m.onPopupClose(),d.noParent.animateTo({sx:1.3,sy:1.3},.1,h,z,1).then(function(){d.noParent.animateTo({sx:1,
sy:1},.1,h,z,1)}),"Pairing Request"==d.title.text?(a.device=d.device,g.fireEvent("scr_onPairingDecline",a)):"Connection Request"==d.title.text?(a.device=d.device,g.fireEvent("scr_onConnectionDecline",a)):"Bluetooth Device Settings"==d.title.text&&(a.device=d.device,a.device&&a.device.paired?g.fireEvent("onDeviceUnpair",a):g.fireEvent("scr_onDeviceSelected",a)),d.hide());a.stopPropagation()});d.cancelParent.on("onKeyDown",function(a){var b=a.keyCode;b==e.LEFT?(d.noParent.focus=!0,d.noParent.resource=
w,d.cancelParent.resource=r):b==e.UP&&d.isLoudSpeaker&&(d.volumeDownIcon.focus=!0,d.volumeDownIcon.resource=A,d.cancelParent.resource=r);a.stopPropagation()});d.cancelParent.on("onKeyUp",function(a){a.keyCode==e.ENTER&&(m.onPopupClose(),d.cancelParent.animateTo({sx:1.3,sy:1.3},.1,h,z,1).then(function(){d.cancelParent.animateTo({sx:1,sy:1},.1,h,z,1)}),d.hide());a.stopPropagation()});d.show=function(){var b=this;this.popupParent.animateTo({x:a.w/2-this.popupParent.w/2,y:a.h/2-this.popupParent.h/2,sx:1,
sy:1,a:.95},.3,h,z,1).then(function(a){b.popupParent.cx=b.popupParent.w/2;b.popupParent.cy=b.popupParent.h/2});this.yesParent.focus=!0;this.yesParent.resource=w};d.hide=function(){this.popupParent.animateTo({sx:2,sy:2,a:0},.3,a.animation.TWEEN_LINEAR,z,1).then(function(a){})};d.setFocus=function(){this.cancelParent.resource=r;this.noParent.resource=r;this.yesParent.focus=!0;this.yesParent.resource=w};l("sucess")}).catch(function(a){console.log("Promise failed in popup",a);G(Error("Promise failed"))})})}
module.exports.Popup=Popup;
var TabContainer=function(a,b){function d(){5<=r||(r++,console.log("increment okCount to "+r))}var e=global.registry.all.TabView,c=global.registry.all.HScrollList,f=[],l=0,q=global.registry.root,g=global.registry.keyCodes,m=global.registry.all.Utils,t=b.parent,u=0;var n=new global.registry.all.DialogItem(a,{title:"Reboot Confirmation",mainText:"Do you want to continue with reboot of device?"},function(){var b=a.getService("systemService");b.setApiVersionNumber(11);b.callMethod("reboot")},function(){n.hide()});
n.hide();var h=a.create({t:"rect",parent:t,lineWidth:1,h:1,lineColor:m.greyColor,fillColor:m.greyColor});h.y=b.y+b.headerFont.measureText(b.headerPixelSize,"test text").h+30;m=a.create({t:"rect",parent:t,x:20,y:h.y+h.h+10,w:q.w-40,h:q.h-h.y-h.h-10,fillColor:m.transparentColor});var z=new c(a,{parent:m,x:0,y:0,w:m.w,h:m.h});this.addTab=function(a,c){var d={};d.title=a.title;d.parent=t;d.headerFont=b.headerFont;d.headerPixelSize=b.headerPixelSize;d.headerY=b.y;d.headerTextColor=b.headerTextColor;d.headerHighlightedColor=
b.headerHighlightedColor;d.bodyParent=z;c=new e(d,c);f.push(c);u&&(u+=b.headerGap);u+=b.headerFont.measureText(b.headerPixelSize,a.title).w;a=(t.w-u)/2;for(d=0;d<f.length;d++)f[d].setHeaderPos({x:a}),a+=b.headerFont.measureText(b.headerPixelSize,f[d].getHeaderText()).w,a+=b.headerGap;h.x=(t.w-u-b.headerGap)/2;h.w=u+b.headerGap;return c};this.selectTab=function(a){f[a].select();l=a};var x=null,k=!1,r=0;q.on("onKeyDown",function(a){if(n.isVisible())n.handleKeys(a);else switch(a.keyCode){case g.UP:f[l].scrollUp();
break;case g.DOWN:f[l].scrollDown();break;case g.LEFT:if(0<l){l--;for(var b=0;b<f.length;b++)b==l?f[b].select():f[b].unselect();z.scrollLeft()}a.stopPropagation();break;case g.RIGHT:if(l<f.length-1){l++;for(b=0;b<f.length;b++)b==l?f[b].select():f[b].unselect();z.scrollRight()}a.stopPropagation();break;case g.ENTER:console.log("called onKeyDown Keys.ENTER"),null==x&&(console.log("called onKeyDown Keys.ENTER okInterval not set"),k=!1,x=setInterval(function(){d();k=!0},1E3))}});q.on("onKeyUp",function(a){switch(a.keyCode){case g.ENTER:console.log("called onKeyUp Keys.ENTER"),
clearInterval(x),x=null,k||d(),r=0}})};module.exports.TabContainer=TabContainer;
var TabView=function(a,b){var d=global.registry.all.Utils,e=global.registry.all.VScrollList,c=a.parent,f=d.scene,l,q=f.create({t:"text",parent:c,y:a.headerY,w:160,h:25,text:a.title,font:a.headerFont,pixelSize:a.headerPixelSize,alignHorizontal:f.alignHorizontal.CENTER,textColor:a.headerTextColor}),g=f.create({t:"rect",parent:c,y:q.y+q.h+26,w:a.headerFont.measureText(a.headerPixelSize,a.title).w+40,lineWidth:2,h:5,lineColor:d.xfinityBlueColor,fillColor:d.xfinityBlueColor}),m=g.draw=!1,t;q.on("onMouseEnter",
function(b){q.textColor=a.headerHighlightedColor;g.draw=!0});q.on("onMouseLeave",function(b){m||(q.textColor=a.headerTextColor,g.draw=!1)});a.bodyParent.addCol(function(a,c){l=new e(d.scene,{parent:a,x:c.x,y:c.y,w:c.w,h:c.h});b.show(l)});this.select=function(){m=!0;q.textColor=a.headerHighlightedColor;g.draw=!0;b.refresh();b.isBluetoothScreen||(t=setInterval(b.refresh,3E4))};this.unselect=function(){m=!1;q.textColor=a.headerTextColor;g.draw=!1;void 0!==t&&clearInterval(t)};this.scrollUp=function(){l.scrollUp()};
this.scrollDown=function(){l.scrollDown()};this.setHeaderPos=function(a){q.x=a.x;g.x=q.x-20};this.getHeaderText=function(){return a.title}};module.exports.TabView=TabView;var packagePath=px.getPackageBaseFilePath();packagePath+="/modules/";px.configImport({"module:":packagePath});
px.import({http:"http"}).then(function(a){var b=a.http;a=function(){};a.regularFont=null;a.boldFont=null;a.textColor=4294967295;a.greyColor=3132799743;a.charcoalGreyColor=808464639;a.xfinityBlueColor=731699455;a.almostBlackColor=4294967078;a.transparentColor=4294967040;a.coolGreyColor=2981740543;a.blackSolidColor=255;a.coolGrey1Color=4227661055;a.coolGrey5Color=3874156031;a.coolGrey9Color=2611260159;a.coolGrey11Color=1684697343;a.placeHolderWrapText="PlaceHolder Text For Wrap";a.scene=null;a.modelName=
"PX051ANI";a.isClientDevice=!0;a.doHttpPost=function(a,e){console.log("Inside Utils.doHttpPost");return new Promise(function(c,d){var f=b.request(a,function(a){a.setEncoding("utf8");var b="";a.on("data",function(a){b+=a});a.on("end",function(a){c(JSON.parse(b))})});f.on("error",function(b){console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]. "+b.message);d("HTTP ERROR "+b.message)});f.write(e);f.end();console.log("After post inside Utils.doHttpPost")})};module.exports.Utils=a}).catch(function(a){console.error("Import failed for Utils.js: "+
a)});
var VScrollList=function(a,b){function d(){var a=t.getChild(t.numChildren-1);return l[f]*q.h/(a.y+a.h)}function e(){if(0!=m.length)if(0>m[0])if(0>t.y&&0<f){--f;var a=t.y+l[f];t.animateTo({y:a},.2,c.animation.TWEEN_EXP1).then(function(){m.shift();e()},null);u.y-=d()}else m.shift();else f<l.length?(a=t.y-l[f],t.animateTo({y:a},.2,c.animation.TWEEN_EXP1).then(function(){f++;m.shift();e()},null),u.y+=d()):m.shift()}var c=a;a=global.registry.all.Utils;var f=0,l=[],q=c.create({t:"rect",parent:b.parent,x:b.x,
y:b.y,w:b.w,h:b.h,fillColor:a.transparentColor});q.clip=!0;var g,m=[],t=c.create({t:"rect",parent:q,w:q.w,h:5E3,fillColor:a.transparentColor}),u=c.create({t:"rect",parent:q,x:t.w-12,y:0,w:7,h:150,a:0,fillColor:a.coolGrey11Color});this.scrollUp=function(){m.push(-1);1==m.length&&e()};this.scrollDown=function(){m.push(1);1==m.length&&e()};this.addRow=function(a){if(g){g.x=0;g.w=q.w;if(t.numChildren){var b=t.getChild(t.numChildren-1).h;g.y+=b;l.push(b)}g.h=100}else g={x:0,y:0,w:q.w,h:100};b=g;a(t,b);
g.y+g.h>q.h&&(u.a=1);a=t.getChild(t.numChildren-1);a.x&&(b=t.getChild(t.numChildren-2),a.h>b.h?b.h=a.h:a.h=b.h)};this.clear=function(){t.removeAll();f=l.length=0;g=null;u.y=0;t.y=0}};module.exports.VScrollList=VScrollList;
var WiFiController=function(){BaseEventManager.call(this);this.name="wifictl (emulation)";this.identity={name:"wifictl",marker:{left:"      # ",right:" # "}};this._options={auto_pairable:!1,auto_trust:!1};for(var a=this,b={},d=$jscomp.makeIterator(wifi_event_listeners.entries()),e=d.next();!e.done;b={$jscomp$loop$prop$value$61:b.$jscomp$loop$prop$value$61},e=d.next()){e=$jscomp.makeIterator(e.value);var c=e.next().value;b.$jscomp$loop$prop$value$61=e.next().value;this.on(c,function(b){return function(c){b.$jscomp$loop$prop$value$61.apply(a,
arguments)}}(b))}this._devices=new Map;this._pairing_requests=new Map;this._connection_requests=new Map;this._power=!1;this._power_state=1;this._defalut_timeout=5;this._scan=this._discoverable=this._pairable=!1};WiFiController.prototype=Object.create(BaseEventManager.prototype);WiFiController.constructor=WiFiController;void 0!==Logger&&Logger.call(WiFiController.prototype);WiFiController.prototype.fireEvent=function(a,b){1>this._power_state||BaseEventManager.prototype.fireEvent.apply(this,arguments)};
WiFiController.prototype.power=function(a){this._power=a=BtUtils.parseBool(a);this.fireEvent("ctl_onPowerChanged",{value:a});!this._power&&0<this._power_state&&this.reset()};WiFiController.prototype.init=function(){this.queueEvent("ctl_onInit",{value:"started"});this.reset()};
WiFiController.prototype.reset=function(){this.log("Resetting the controller.");this._setPowerState(0);this.power("on");this._pairable=this._options.auto_pairable;this._scan=this._discoverable=!1;this._devices.clear();this._pairing_requests.clear();this._connection_requests.clear();this.log("Restoring devices.");for(var a=$jscomp.makeIterator(Wifi_Devices.in_range),b=a.next();!b.done;b=a.next())b=b.value,this._devices.set(b.ssid,b),b.discovered=!0,b.paired=!1,b.trusted=!1,b.connected=!1,-1!==Wifi_Devices.paired.indexOf(b.ssid)&&
this.pair(b.ssid),-1!==Wifi_Devices.trusted.indexOf(b.ssid)&&this.trust(b.ssid),-1!==Wifi_Devices.connected.indexOf(b.ssid)&&this.connect(b.ssid);this.power("off");this._setPowerState(1);this.log("Controller was reset.")};WiFiController.prototype._setPowerState=function(a){if("undefined"===a||0>a||1<a)a=1;a!==this._power_state&&(this._power_state=a)};WiFiController.prototype.pairable=function(a){this.isPowered(1)&&(this._pairable=a=BtUtils.parseBool(a),this.fireEvent("ctl_onPairableChanged",{value:a}))};
WiFiController.prototype.discoverable=function(a){this.isPowered(1)&&(this._discoverable=a=BtUtils.parseBool(a),this.fireEvent("ctl_onDiscoverableChanged",{value:a}))};WiFiController.prototype.isPowered=function(a){a=BtUtils.parseBool(a);!this._power&&a&&this.fireEvent("ctl_onError",{value:"ERROR_NOT_POWERED",message:"Power is off. Use power('on') to enable"});return this._power};WiFiController.prototype.isPairable=function(){return this.isPowered(1)&&this._pairable};
WiFiController.prototype.isDiscoverable=function(){return this.isPowered(1)&&this._discoverable};WiFiController.prototype.isScanning=function(){return this.isPowered(1)&&this._scan};
WiFiController.prototype.scan=function(a){a=BtUtils.parseBool(a);var b=this;this.isPowered(1)&&((this._scan=a)?(this.fireEvent("ctl_onDiscoveryStarted",{value:a}),setTimeout(function(){b.isScanning()&&b.fireEvent("ctl_onDeviceListChanged",{value:b._devices})},1E3*this._defalut_timeout)):this.fireEvent("ctl_onDiscoveryStopped",{value:a}))};
WiFiController.prototype.saveSSID=function(a,b,d){b=!1;if(this.isPowered(1))return d=this._devices.get(a),void 0===d||!d.discovered&&0!==this._power_state?this.fireEvent("ctl_onPair","UNPAIRED"):(d.paired||(d.paired=!0,this.dropPairingRequest(a),this.hasOption("auto_trust","on")&&this.trust(a)),this.fireEvent("ctl_onPair","PAIRED"),b=!0),b};
WiFiController.prototype.unpair=function(a){if(this.isPowered(1)){var b=this._devices.get(a);void 0!==b&&b.paired?(b.connected&&this.disconnect(a),b.trusted&&this.untrust(a),b.paired=!1,this.fireEvent("ctl_onUnpair",{device:b,result:!0})):this.log("Device %s wasn't paired, but requested to unpair. Ignored.",a);return!0}};
WiFiController.prototype.trust=function(a){var b=!1;if(this.isPowered(1)){var d=this._devices.get(a);void 0!==d&&d.paired?(d.trusted||(d.trusted=!0),b=!0,this.fireEvent("ctl_onTrust",{device:d,result:b})):this.fireEvent("ctl_onWarning",{value:"WARNING_WRONG_DEVICE",message:"device "+a+" can't be trusted"});return b}};
WiFiController.prototype.untrust=function(a){if(this.isPowered(1)){var b=this._devices.get(a);void 0!==b&&b.trusted?(b.connected&&this.disconnect(a),b.trusted=!1,this.fireEvent("ctl_onUntrust",{device:b,result:!0})):this.log("Device %s wasn't trusted, but requested to untrust. Ignored.",a);return!0}};
WiFiController.prototype.connect=function(a,b,d){var e=this;d=!1;if(this.isPowered(1)){b=this._devices.get(a);if(b.connected)this.fireEvent("ctl_onConnect",{state:6,isLNF:-1});else{d=this.getMacsByCriteria("connected",!0);d=$jscomp.makeIterator(d);for(var c=d.next();!c.done;c=d.next())this.disconnect(c.value);b.connected=!0;b.active=2;d=!0;this.dropConnectionRequest(a);setTimeout(function(){e.fireEvent("ctl_onConnect",{state:5,isLNF:1})},5E3)}return d}};
WiFiController.prototype.disconnect=function(a){if(this.isPowered(1)){var b=this._devices.get(a);void 0!==b&&b.connected?(b.connected=!1,this.log("Disconnected %s(%s)",b.ssid,b.ssid),this.fireEvent("ctl_onDisconnect",{device:b,result:!0})):this.log("Device %s wasn't connected, but requested to disconnect. Ignored.",a);return!0}};WiFiController.prototype.info=function(a){if(this.isPowered(1))return this._devices.get(a)};
WiFiController.prototype.remove=function(a){var b=!1;if(this.isPowered(1)){var d=this._devices.get(a);void 0!==d?(this.fireEvent("ctl_onRemove",{device:d}),b=this._devices.delete(a)):this.fireEvent("ctl_onWarning",{value:"WARNING_WRONG_DEVICE",message:"Device "+a+" is unknown"});return b}};WiFiController.prototype.list=function(){var a=[];if(this.isPowered(1)){for(var b=$jscomp.makeIterator(this._devices.values()),d=b.next();!d.done;d=b.next())a.push(d.value);return a}};
WiFiController.prototype.getMacsByCriteria=function(a,b){if(!this.isPowered(1))return[];for(var d=[],e=$jscomp.makeIterator(this._devices.keys()),c=e.next();!c.done;c=e.next()){c=c.value;var f=this._devices.get(c);f.hasOwnProperty(a)&&f[a]===b&&d.push(c)}return d};WiFiController.prototype.getDevicesByCriteria=function(a,b){if(!this.isPowered(1))return[];for(var d=[],e=$jscomp.makeIterator(this._devices.values()),c=e.next();!c.done;c=e.next())c=c.value,c.hasOwnProperty(a)&&c[a]===b&&d.push(c);return d};
WiFiController.prototype.getDevice=function(a){return this.isPowered(1)?this._devices.get(a):{}};WiFiController.prototype.getDeviceByName=function(a){if(this.isPowered(1))return this.getDevicesByCriteria("name",a)[0]};WiFiController.prototype.setOption=function(a,b){b=BtUtils.parseBool(b);this._options.hasOwnProperty(a)&&this._options[a]===b||(this._options[a]=b,this.fireEvent("ctl_onSetOption",{option:a,value:b}))};
WiFiController.prototype.hasOption=function(a,b){b=BtUtils.parseBool(b);return this._options.hasOwnProperty(a)&&this._options[a]===b};WiFiController.prototype.dropPairingRequest=function(a){this._pairing_requests.has(a)?(this.log("Dropping pairing request for %s",a),this._pairing_requests.delete(a)):(this.log("Ignoring drop pairing request for %s: no such request present.",a),this.log("Pending pairing requests: ",this._pairing_requests))};
WiFiController.prototype.dropConnectionRequest=function(a){this._connection_requests.has(a)?(this.log("Dropping connection request for %s",a),this._connection_requests.delete(a)):(this.log("Ignoring drop connection request for %s: no such request present.",a),this.log("Pending connection requests: ",this._connection_requests))};var wifi_event_listeners=new Map;
wifi_event_listeners.set("usr_pairingRequest",function(a){this.isPowered()&&this.isPairable()&&(a=JSON.parse(JSON.stringify(a.device)),this._pairing_requests.set(a.ssid,a.pin),this.fireEvent("ctl_onPairingRequest",{device:a}))});wifi_event_listeners.set("usr_ConnectionRequest",function(a){this.isPowered()&&(a=JSON.parse(JSON.stringify(a.device)),this._connection_requests.set(a.ssid,""),this.fireEvent("ctl_onConnectionRequest",{device:a}))});module.exports.WiFiController=WiFiController;
var Wifi_Devices={in_range:[{ssid:"CCemployee",security:1,signalStrength:-30,frequency:500.5,bssid:"90:72:40:69:BB:93",rate:50.5,noise:0},{ssid:"Xfinity Guest",security:0,signalStrength:-100,frequency:500.5,bssid:"90:72:40:69:BB:93",rate:50.5,noise:0},{ssid:"Redmi",security:1,signalStrength:-55,frequency:500.5,bssid:"90:72:40:69:BB:93",rate:50.5,noise:0},{ssid:"Xfinity wifi",security:1,signalStrength:-65,frequency:500.5,bssid:"90:72:40:69:BB:93",rate:50.5,noise:0}],paired:[],trusted:[],connected:[]};
module.exports.Wifi_Devices=Wifi_Devices;
var WiFiService=function(a){BaseEventManager.call(this);this.name="Wifi Service Manager service (emulation)";this.identity={name:"service manager",marker:{left:"    { ",right:" } "}};var b=this;this.name=this.service_name=a;this.api_version=1;this.onEvent={};this._wifi_event_subscriptions=[];this.wifictrl=new WiFiController;a={};for(var d=$jscomp.makeIterator(wifi_controller_listeners.entries()),e=d.next();!e.done;a={$jscomp$loop$prop$value$63:a.$jscomp$loop$prop$value$63},e=d.next()){e=$jscomp.makeIterator(e.value);
var c=e.next().value;a.$jscomp$loop$prop$value$63=e.next().value;this.wifictrl.on(c,function(a){return function(c){a.$jscomp$loop$prop$value$63.apply(b,arguments)}}(a))}this.wifictrl.setOption("auto_pairable","on");this.wifictrl.setOption("auto_trust","on");this.wifictrl.init();this.deviceIdFromMac=function(a){a=String(a).split(":").join("");return parseInt(a,16)};this.macFromDeviceId=function(a){a=Number(a).toString(16).toUpperCase();for(var b=a.length,c="",d=0;d<b;d+=2)c+=a.substr(d,2),d+2<b&&(c+=
":");return c};this.devicePayloadFromRawData=function(a){var b=this.deviceIdFromMac(a.bssid);var c=a.hasOwnProperty("uuid_audio_source")?a.uuid_audio_source:"null";var d=a.hasOwnProperty("uuid_vendor_specific")?a.uuid_vendor_specific:"0";return{deviceID:b,name:a.ssid,supportedProfile:c,manufacturer:d,MAC:a.bssid}};this.genRSSI=function(){return Math.floor(74*Math.random())+-100};this.genRX=function(a){return(a-2*a)/25+Math.random()}};WiFiService.prototype=Object.create(BaseEventManager.prototype);
WiFiService.constructor=WiFiService;Logger.call(WiFiService.prototype);WiFiService.prototype.setApiVersionNumber=function(a){"number"===typeof a&&(this.api_version=a)};WiFiService.prototype.registerForEvents=function(a){a=JSON.parse(a);a.events.constructor===Array&&(this._wifi_event_subscriptions=a.events)};
WiFiService.prototype.callMethod=function(a,b){this.log("Calling: %s with params: %s",a,b);b=JSON.stringify(JSON.parse(b));return this.__proto__.hasOwnProperty(a)?this[a](b):'{"success":false, "message": "unknown method '+a+'"}'};
WiFiService.prototype.fireBluetoothEvent=function(a,b){var d=-1!==this._wifi_event_subscriptions.indexOf(a);"object"===typeof b&&(b=JSON.stringify(b));if("function"===typeof this.onEvent&&d)this.onEvent(a,b);else this.log('"onEvent" function is not yet defined for %s',this.identity.ssid),this.log("Firing to void: %s, payload: %s",a,b)};
WiFiService.prototype.getStatusSupport=function(a){a={success:!1};this.wifictrl.isPowered()?(a.success=!0,a.status="AVAILABLE"):(a.success=!1,a.status="SOFTWARE_DISABLED");return JSON.stringify(a)};
WiFiService.prototype.setEnabled=function(a){var b={success:!1},d={newStatus:""},e=this;a=JSON.parse(a).params[0]?"on":"off";this.wifictrl.on("ctl_onPowerChanged",function(a){b.success=!0;d.newStatus=a.value?"SOFTWARE_ENABLED":"SOFTWARE_DISABLED";e.fireBluetoothEvent("statusChanged",d)});this.wifictrl.power(a);return JSON.stringify(b)};WiFiService.prototype.setSinkDiscovery=function(a){return this.setBluetoothDiscoverable(a)};WiFiService.prototype.getAvailableSSIDs=function(){return this.getDiscoveredDevices(0)};
WiFiService.prototype.getAvailableSSIDsAsync=function(){var a={success:!1},b=this;this.wifictrl.on("ctl_onDiscoveryStarted",function(b){a.success=!0;a.status="AVAILABLE"});this.wifictrl.on("ctl_onError",function(b){a.success=!1;"ERROR_NOT_POWERED"===b.value&&(a.status="SOFTWARE_DISABLED")});this.wifictrl.scan("on");setTimeout(function(){b.wifictrl.isScanning()&&b.wifictrl.scan("off")},2E4);return JSON.stringify(a)};
WiFiService.prototype.stopDeviceDiscovery=function(a){var b={success:!1};this.wifictrl.on("ctl_onDiscoveryStopped",function(a){b.success=!0});this.wifictrl.scan("off");return JSON.stringify(b)};
WiFiService.prototype.getDiscoveredDevices=function(a){var b={success:!1};a=[];this.wifictrl.on("ctl_onError",function(a){b.success=!1});var d=this.wifictrl.getDevicesByCriteria("discovered",!0);d=$jscomp.makeIterator(d);for(var e=d.next();!e.done;e=d.next()){e=e.value;var c={};c.deviceID=this.deviceIdFromMac(e.bssid);c.ssid=e.ssid;c.paired=e.paired;c.connected=e.connected;c.security=e.security;c.signalStrength=e.signalStrength;a.push(c)}a=a.filter(function(a){return null!==a});b.success=0<a.length;
b.SSIDs=a;return JSON.stringify(b)};
WiFiService.prototype.getPairedSSID=function(a){var b={success:!1};a=[];this.wifictrl.on("ctl_onError",function(a){b.success=!1});this.wifictrl.isPairable()||(this.log("Setting pairable on automatically"),this.wifictrl.pairable("on"));var d=this.wifictrl.getDevicesByCriteria("paired",!0);d=$jscomp.makeIterator(d);for(var e=d.next();!e.done;e=d.next()){e=e.value;var c={};c.deviceID=this.deviceIdFromMac(e.bssid);c.ssid=e.ssid;c.connected=e.connected;c.security=e.security;c.signalStrength=e.signalStrength;
a.push(c)}b.success=0<a.length;b.PairedSSID=a;return JSON.stringify(b)};
WiFiService.prototype.getConnectedSSID=function(a){var b={success:!1};a={};this.wifictrl.on("ctl_onError",function(a){b.success=!1});var d=this.wifictrl.getDevicesByCriteria("connected",!0);d=$jscomp.makeIterator(d);for(var e=d.next();!e.done;e=d.next())e=e.value,a.deviceID=this.deviceIdFromMac(e.bssid),a.ssid=e.ssid,a.active=e.active,a.security=e.security,a.signalStrength=e.signalStrength,a.connected=e.connected;b.success=0<Object.keys(a).length;b.SSID=a;return JSON.stringify(b)};
WiFiService.prototype.saveSSID=function(a){var b=JSON.parse(a).params,d={success:!1};this.log("Got a device pairing command: ",a);d.success=this.wifictrl.saveSSID(b[0],b[1],b[2]);return JSON.stringify(d)};WiFiService.prototype.connect=function(a){var b=JSON.parse(a).params;this.log("Got a device connection command: ",a);a={success:!1};a.success=this.wifictrl.connect(b[0],b[1],b[2]);return JSON.stringify(a)};
WiFiService.prototype.getDeviceInfo=function(a){a=JSON.parse(a).params;a=this.macFromDeviceId(a[0]);a=this.wifictrl.getDevice(a);a=this.devicePayloadFromRawData(a);a.rssi=this.genRSSI();a.signalStrength=this.genRX(a.rssi);return JSON.stringify(a)};var wifi_controller_listeners=new Map;wifi_controller_listeners.set("ctl_onInit",function(a){this.log("Device init: %s.",a.value);this.fireBluetoothEvent("statusChanged",JSON.stringify({newStatus:"HARDWARE_AVAILABLE"}))});
wifi_controller_listeners.set("ctl_onError",function(a){this.log("%s: %s",a.value,a.message)});wifi_controller_listeners.set("ctl_onWarning",function(a){this.log("%s: %s",a.value,a.message)});wifi_controller_listeners.set("ctl_onPowerChanged",function(a){this.log("Power is %s.",a.value?"ON":"OFF")});wifi_controller_listeners.set("ctl_onDiscoveryStarted",function(a){this.log("Discovery started.",JSON.stringify(a))});
wifi_controller_listeners.set("ctl_onDiscoveryStopped",function(a){this.log("Discovery stopped.",JSON.stringify(a))});wifi_controller_listeners.set("ctl_onDeviceListChanged",function(a){this.log("New devices found");a=this.getDiscoveredDevices(0);this.fireBluetoothEvent("onAvailableSSIDs",a)});
wifi_controller_listeners.set("ctl_onDeviceFound",function(a){a=JSON.parse(JSON.stringify(a.device));this.log("A known device found: %s (%s)",a.ssid,a.bssid);var b=this.devicePayloadFromRawData(a);delete b.supportedProfile;delete b.manufacturer;delete b.bssid;b.lastConnected=a.last_connected;this.fireBluetoothEvent("deviceFound",JSON.stringify(b))});wifi_controller_listeners.set("ctl_onPairableChanged",function(a){this.log("Pairable is %s.",a.value?"ON":"OFF")});
wifi_controller_listeners.set("ctl_onDiscoverableChanged",function(a){this.log("Discoverable is %s.",a.value?"ON":"OFF")});wifi_controller_listeners.set("ctl_onPair",function(a){this.log("Device paired:",a);this.fireBluetoothEvent("onPairingStateChanged",JSON.stringify(a))});wifi_controller_listeners.set("ctl_onPairFailed",function(a){this.log("Device pairing failed:",a.device.bssid);this.fireBluetoothEvent("requestFailed",JSON.stringify({errorID:"PAIRING_FAILED",MAC:a.device.bssid}))});
wifi_controller_listeners.set("ctl_onUnpair",function(a){this.log("Device unpaired:",a.device.bssid);this.fireBluetoothEvent("statusChanged",JSON.stringify({newStatus:"PAIRING_CHANGE"}))});wifi_controller_listeners.set("ctl_onTrust",function(a){this.log("Device trusted:",a.device.bssid);this.fireBluetoothEvent("statusChanged",JSON.stringify({newStatus:"TRUST_CHANGE"}))});
wifi_controller_listeners.set("ctl_onUntrust",function(a){this.log("Device is not trusted now:",a.device.bssid);this.fireBluetoothEvent("statusChanged",JSON.stringify({newStatus:"TRUST_CHANGE"}))});wifi_controller_listeners.set("ctl_onConnect",function(a){this.log("Device connected:",a);this.fireBluetoothEvent("onWIFIStateChanged",JSON.stringify(a))});
wifi_controller_listeners.set("ctl_onDisconnect",function(a){this.log("Device disconnected:",a.device.bssid);this.fireBluetoothEvent("statusChanged",JSON.stringify({newStatus:"CONNECTION_CHANGE"}))});wifi_controller_listeners.set("ctl_onConnectFailed",function(a){this.log("Device connecting failed:",a.device.bssid);this.fireBluetoothEvent("requestFailed",JSON.stringify({newStatus:"CONNECTION_FAILED",MAC:a.device.bssid}))});
wifi_controller_listeners.set("ctl_onPairingRequest",function(a){this.log("Pairing request from %s (%s)",a.device.ssid,a.device.bssid);a=JSON.parse(JSON.stringify(a.device));var b=this.devicePayloadFromRawData(a),d=this.wifictrl.isPinRequired();b.pinRequired=d;b.pinValue=a.pin;this.fireBluetoothEvent("pairingRequest",JSON.stringify(b));d&&(b={pinValue:a.pin},this.fireBluetoothEvent("pinRequest",JSON.stringify(b)))});
wifi_controller_listeners.set("ctl_onConnectionRequest",function(a){this.log("Connection request from %s (%s)",a.device.ssid,a.device.bssid);a=JSON.parse(JSON.stringify(a.device));a=this.devicePayloadFromRawData(a);this.fireBluetoothEvent("connectionRequest",JSON.stringify(a))});module.exports.WiFiService=WiFiService;
var Wifi=function(a,b){BaseEventManager.call(this);this.name="WiFi API";this.scene=a;this.identity={name:"wifi api",marker:{left:"  { ",right:" } "}};this._options={emulation:!1};this.wifi_service=b;this.api_version=null};Wifi.prototype=Object.create(BaseEventManager.prototype);Wifi.constructor=Wifi;Logger.call(Wifi.prototype);
Wifi.prototype.init=function(a){var b=this;this.api_version=a;this._initWiFiService(a);this.on("onEmulationModeChanged",function(a){b.wifi_service&&b._initWiFiService(this.api_version)});this.log("Init completed for %s.",this.wifi_service.name)};
Wifi.prototype._initWiFiService=function(a){var b=this,d=[];d.push("onWIFIStateChanged","onError","onSSIDsChanged","onPairingStateChanged","onWPSPairingButtonPressed","onWifiSignalThresholdChanged","onAvailableSSIDs","onWIFIStateChanged");var e={events:d};this.getOption("emulation")?this.log("Using Wifi emulation."):(this.log("Using hardware Wifi."),this.wifi_service||(this.wifi_service=this.scene.getService("org.rdk.wifiManager")),this.wifi_service.name="service manager");this.wifi_service||console.error("Unable to initialize %s.",
"org.rdk.wifiManager");this.wifi_service.setApiVersionNumber(a);this.wifi_service.registerForEvents(JSON.stringify(e));this.wifi_service.onEvent=function(a,d){b.onWifiEvent(a,d)};this.log("Registered for events: %s.",JSON.stringify(d))};Wifi.prototype.isInitialized=function(){return!!this.wifi_service};
Wifi.prototype.setOption=function(a,b){b=BtUtils.parseBool(b);this._options.hasOwnProperty(a)&&this._options[a]===b||(this._options[a]=b,this.fireEvent("onSetOption",{option:a,value:b}),"emulation"===a&&this.fireEvent("onEmulationModeChanged",{value:b}))};Wifi.prototype.getOption=function(a){if(this._options.hasOwnProperty(a))return this._options[a];this.log('getOption: unknown option "%s"',a)};
Wifi.prototype._callMethod=function(a,b){if(this.isInitialized()){void 0===b&&(b="");!("string"===typeof b&&0<b.length)||b.trim().startsWith('"')&&b.trim().endsWith('"')||(b='"'+b+'"');if(b.constructor===Array){for(var d="",e=0;e<b.length;++e){var c="string"===typeof b[e]?'"':"";d=d+(0<e?", ":"")+c+b[e].toString()+c}b=d}"object"===typeof b&&(b=JSON.stringify(b));b.toString().trim().startsWith("[")&&b.toString().trim().endsWith("]")||(b="["+b+"]");b='{"params":'+b+"}";"{params:[]}"===b&&(b="");b=JSON.stringify(JSON.parse(b));
this.log("Calling %s method with params: %s",a,b);b=this.wifi_service.callMethod(a,b);this.log("%s returned: %s",a,b);return JSON.parse(b)}this.log("Wifi API is not initialized")};Wifi.prototype.onWifiEvent=function(a,b){this.log(" New wifi event, name: '"+a+"', payload: '"+b+"'");"string"===typeof b?b=JSON.parse(b):this.log("Warning. Service payload is not a string (object?). Forwarding as is.");this.fireEvent(a,b)};Wifi.prototype.getCurrentState=function(){return this._callMethod("getCurrentState")};
Wifi.prototype._getDevices=function(a){return this._callMethod(a)};Wifi.prototype.getAvailableSSIDs=function(){return this._getDevices("getAvailableSSIDs")};Wifi.prototype.getAvailableSSIDsAsync=function(){return this._callMethod("getAvailableSSIDsAsync")};Wifi.prototype.getConnectedSSID=function(){return this._getDevices("getConnectedSSID")};Wifi.prototype.getPairedSSID=function(){return this._getDevices("getPairedSSID")};
Wifi.prototype.connect=function(a,b,d){return this._callMethod("connect",[a,b,d])};Wifi.prototype.saveSSID=function(a,b,d){return this._callMethod("saveSSID",[a,b,d])};Wifi.prototype.setEnabled=function(a){return this._callMethod("setEnabled",a)};Wifi.prototype.clearSSID=function(){return this._callMethod("clearSSID")};module.exports.Wifi=Wifi;
var WifiEventManager={_listeners:{},FOCUS_EVENT:"onSetFocus",on:function(a,b){this._listeners[a]||(this._listeners[a]=[]);-1===this._listeners[a].indexOf(b)&&this._listeners[a].push(b)},delListener:function(a,b){this._listeners[a]&&(b=this._listeners[a].indexOf(b),0<=b&&delete this._listeners[a][b])},clearListeners:function(){this._listeners={}},fireEvent:function(a,b){var d=[];d.push({event_name:a,original_event:b});this._processEvents(d)},_processEvents:function(a){if(this._listeners){a=$jscomp.makeIterator(a);
for(var b=a.next();!b.done;b=a.next())if(b=b.value,this._listeners[b.event_name])for(var d in this._listeners[b.event_name])this._listeners[b.event_name][d](b.original_event)}}};module.exports.WifiEventManager=WifiEventManager;
var AvStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.3);0==d.isClientDevice&&c.addRow("Component Audio","TODO");e["Device.Services.STBService.1.Components.HDMI.1.ResolutionValue"]=c.addRow("#Horizontal Lines","TODO");e["Device.Services.STBService.1.Components.VideoOutput.1.DisplayFormat"]=c.addRow("#Vertical Lines","TODO");e["Device.Services.STBService.1.Components.HDMI.1.DisplayDevice.SupportedResolutions"]=
c.addRow("Frame Rate","TODO");e["Device.Services.STBService.1.Components.VideoDecoder.1.ContentAspectRatio"]=c.addRow("Aspect Ratio","TODO");e["Device.Services.STBService.1.Components.VideoOutput.1.HDCP"]=c.addRow("Scanning Format","TODO");e["Device.Services.STBService.1.Components.AudioOutput.1.X_COMCAST-COM_AudioStereoMode"]=c.addRow("Audio Setting","TODO");e["Device.Services.STBService.1.Components.HDMI.1.DisplayDevice.PreferredResolution"]=c.addRow("Resolution","TODO");-1!==d.modelName.indexOf("PX051")&&
(e["Device.DeviceInfo.X_RDKCENTRAL-COM_xBlueTooth.Enabled"]=c.addRow("Bluetooth Status","TODO"),e["Device.DeviceInfo.X_RDKCENTRAL-COM_xBlueTooth.DeviceInfo.Profile"]=c.addRow("Bluetooth Active Profile","TODO"),e["Device.DeviceInfo.X_RDKCENTRAL-COM_xBlueTooth.DeviceInfo.Manufacturer"]=c.addRow("Bluetooth Active Make/Model","TODO"));0==d.isClientDevice&&(c.addRow("State Code","TODO"),c.addRow("County Code","TODO"),c.addRow("County Sub-Division Code","TODO"))};this.updateData=function(){d.doHttpPost({hostname:"127.0.0.1",
port:10999,method:"POST",headers:{"Content-Type":"application/json"}},'{"paramList" : [             {"name" : "Device.Services.STBService.1.Components.HDMI.1.ResolutionValue"},             {"name" : "Device.Services.STBService.1.Components.VideoOutput.1.DisplayFormat"},             {"name" : "Device.Services.STBService.1.Components.HDMI.1.DisplayDevice.SupportedResolutions"},             {"name" : "Device.Services.STBService.1.Components.VideoDecoder.1.ContentAspectRatio"},             {"name" : "Device.Services.STBService.1.Components.AudioOutput.1.X_COMCAST-COM_AudioStereoMode"},             {"name" : "Device.Services.STBService.1.Components.HDMI.1.DisplayDevice.PreferredResolution"},             {"name" : "Device.Services.STBService.1.Components.VideoOutput.1.HDCP"},             {"name" : "Device.DeviceInfo.X_RDKCENTRAL-COM_xBlueTooth.Enabled"},             {"name" : "Device.DeviceInfo.X_RDKCENTRAL-COM_xBlueTooth.DeviceInfo.Profile"},             {"name" : "Device.DeviceInfo.X_RDKCENTRAL-COM_xBlueTooth.DeviceInfo.Manufacturer"}             ]}').then(function(a){for(var b=
0;b<a.paramList.length;b++)void 0!==e[a.paramList[b].name]&&(e[a.paramList[b].name].text=a.paramList[b].value)},function(a){})}};module.exports.AvStatus=AvStatus;
var AvView=function(){var a=global.registry.all.HdmiStatus,b=global.registry.all.VodStatus,d=[];this.show=function(e){e.clear();e.addRow(function(b,e){b=new a({title:"HDMI",parent:b,x:e.x,y:e.y,w:e.w,h:e.h});d.push(b.updateData);b.show()});e.addRow(function(a,b){a=new global.registry.all.AvStatus({title:"A/V",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});d.push(a.updateData);a.show()});e.addRow(function(a,e){a=new b({title:"VOD",parent:a,x:e.x,y:e.y,w:e.w,h:e.h});d.push(a.updateData);a.show()})};this.refresh=
function(){for(var a=0;a<d.length;a++)d[a]()}};module.exports.AvView=AvView;
function BtConnectivityScreen(a,b){function d(){this.createUI=function(a){this.device=a.device;this.animate=400>a.y;this.getDeviceIcon=function(){if(this.device.deviceType.match(/LOUDSPEAKER/i))return y;if(a.name.match(/keyboard/i))return J;a.name.match(/mouse/i);return I};this.itemRoot=f.create({t:"rect",parent:a.parent,x:0,y:a.y,w:a.w,h:a.h,fillColor:a.fillColor,a:this.animate?0:1,sx:this.animate?.5:1,sy:this.animate?.5:1,cx:a.w/2,cy:a.h/2});this.deviceTypeImageBG=f.create({t:"image",parent:this.itemRoot,
w:40,h:40,x:20,y:10,resource:E});this.deviceTypeImage=f.create({t:"image",parent:this.deviceTypeImageBG,w:30,h:30,x:5,y:5,resource:this.getDeviceIcon(),stretchX:f.stretch.STRETCH,stretchY:f.stretch.STRETCH});this.deviceName=f.create({t:"textBox",parent:this.itemRoot,textColor:g.TEXT,font:C,w:this.itemRoot.w,h:this.itemRoot.h,x:80,pixelSize:25,text:a.name,alignHorizontal:r,alignVertical:p});this.deviceNameMargineLine=f.create({t:"rect",parent:this.itemRoot,w:this.itemRoot.w,h:2,y:this.itemRoot.h-2,
fillColor:g.BLACK,a:.3});this.moreOptions=f.create({t:"object",parent:this.itemRoot,w:40,h:40,x:this.itemRoot.w-50,y:this.itemRoot.h/2-20,cx:20,cy:20});this.rightImage=f.create({t:"image",parent:this.moreOptions,w:this.moreOptions.w,h:this.moreOptions.h,resource:H});this.status=f.create({t:"textBox",parent:this.itemRoot,textColor:g.STATUS_COLOR,font:C,w:300,h:this.itemRoot.h,x:this.itemRoot.w-370,pixelSize:25,text:this.device.connected?"CONNECTED":this.device.paired?"PAIRED":"",alignHorizontal:w,
alignVertical:p});return this.animate?this.itemRoot.animateTo({sx:1,sy:1,a:1},.3,B,A,1):new Promise(function(a,b){a("sucess")})};this.y=function(){return this.itemRoot.y};this.selectItem=function(a){a?(this.itemRoot.fillColor=g.LIST_HIGHLIGHT,this.deviceName.textColor=g.WHITE):(this.itemRoot.fillColor=g.LIST_NORMAL,this.deviceName.textColor=g.TEXT);this.rightImage.resource=H};this.updateStatus=function(a){var b=this;this.status.text=a;setTimeout(function(){b.status.text=b.device.connected?"CONNECTED":
b.device.paired?"PAIRED":""},3E4)};this.selectMoreOptions=function(a){a?(this.itemRoot.fillColor=g.LIST_NORMAL,this.deviceName.textColor=g.TEXT,this.rightImage.resource=S):this.rightImage.resource=H};this.isMoreOptionsSelected=function(){return this.rightImage.resource==S?!0:!1};this.click=function(a){var b=this;if(this.rightImage.resource==S){this.moreOptions.animateTo({sx:1.3,sy:1.3},.1,v,A,1).then(function(){b.moreOptions.animateTo({sx:1,sy:1},.1,v,A,1)});var c=new q(f,{parent:P,_owner:x,keys:l,
baseUrl:m,Colors:g,device:this.device,title:"Bluetooth Device Settings",description:this.deviceName.text,w:600,h:250,isDetailsPopup:1,x:this.itemRoot.x+10+20,y:this.itemRoot.y+F.y+290,cx:0,cy:0,yes:{text:this.device.connected?"Disconnect":"Connect"},no:{text:this.device.paired?"Unpair":"Pair"}});c.ready.then(function(){h.push(c);c.show()}).catch(function(a){console.log(a)})}else this.device.connected||(a.device=this.device,this.updateStatus(this.device.paired?"CONNECTING...":"PAIRING..."),setTimeout(function(){x.fireEvent("scr_onDeviceSelected",
a)},100))}}function e(){if(n.length!=z.length){var a=n.length,b=z[a],c=b.name,f=new d;n.push(f);f.createUI({parent:F,y:60*a,w:K.w,h:60,fillColor:g.LIST_NORMAL,name:c,device:b}).then(function(){e()}).catch(function(a){console.log("promise failed in populateItem")})}}function c(a){var b=n[a],c=-F.y;u=a;0<=t&&n[t].selectItem(!1);n[u].selectItem(!0);t=u;b.y()<c?(c=-b.y(),F.animateTo({y:c},.1,B,G,1)):b.y()+60-K.h>c&&(c=-(b.y()+60-K.h),F.animateTo({y:c},.1,B,G,1))}var f=a,l=b.keys,q=b.Popup,g=b.Colors,
m=px.getPackageBaseFilePath(),t=-1,u=-1,n=[],h=[],z=[],x=b.context,k=b.parent;b=f.alignHorizontal.CENTER;var r=f.alignHorizontal.LEFT,w=f.alignHorizontal.RIGHT,p=f.alignVertical.CENTER,v=f.animation.TWEEN_EXP1,A=f.animation.OPTION_FASTFORWARD,B=f.animation.TWEEN_LINEAR,G=f.animation.OPTION_LOOP,P=this,C=f.create({t:"fontResource",url:m+"/fonts/DejaVuSans.ttf"});this.onPopulateDevices=function(a){z=a;n.length=0;F.y=0;t=u=-1;N.hide();0==z.length?(F.removeAll(),Q.a=0,0===h.length&&(O.focus=!0,M.resource=
U),T&&T.animateTo({sx:1,sy:1,a:1},.3,v,A,1)):(0===h.length&&(O.focus=!1,M.resource=L,F.focus=!0),T&&T.animateTo({sx:0,sy:0,a:0},.3,v,A,1),Q.a=.3,F.removeAll(),e(),c(0))};this.onPairingRequest=function(a){var b=new q(f,{parent:P,_owner:x,keys:l,baseUrl:m,Colors:g,title:"Pairing Request",device:a.device,description:'Do you want to pair and connect "'+a.device.name+'"\n\nPIN: '+a.device.pinValue,w:600,h:300,x:k.w/2-300,y:k.h/2-150,cx:300,cy:150,yes:{text:"Yes"},no:{text:"No"}});b.ready.then(function(){h.push(b);
b.show()}).catch(function(a){console.log(a)})};this.onConnectionRequest=function(a){var b=new q(f,{parent:P,_owner:x,keys:l,baseUrl:m,Colors:g,title:"Connection Request",device:a.device,description:'Do you want connect "'+a.device.name+'"',w:600,h:250,x:k.w/2-300,y:k.h/2-125,cx:300,cy:125,yes:{text:"Yes"},no:{text:"No"}});b.ready.then(function(){h.push(b);b.show()}).catch(function(a){console.log(a)})};this.onStartDiscovery=function(){N.show()};this.onError=function(){N.hide()};this.onPopupClose=function(){h.pop();
var a=h.length;0<a?h[a-1].setFocus():F.focus=!0};var D=f.create({t:"object",parent:k,w:k.w,h:k.h,interactive:!1});f.create({t:"textBox",parent:D,textColor:g.TEXT,x:15,y:20,w:650,h:40,pixelSize:28,text:"Xfinity Bluetooth Settings",cx:325,cy:20,font:C,alignHorizontal:r,alignVertical:p});a=f.create({t:"object",parent:D,w:350,h:f.h-250,x:800,y:80});var L=f.create({t:"imageResource",url:m+"/images/refreshNetwork.svg",w:350,h:50}),U=f.create({t:"imageResource",url:m+"/images/refreshNetworkHL.svg",w:350,
h:50}),M=f.create({t:"image",parent:a,w:350,h:50,x:0,y:a.h-100,resource:L}),O=f.create({t:"textBox",parent:M,textColor:g.WHITE,w:M.w,h:M.h,pixelSize:28,text:"Discover new devices",alignHorizontal:b,alignVertical:p,font:C,cx:M.w/2,cy:M.h/2}),V=f.create({t:"imageResource",url:m+"/images/bluetoothSignal.svg",w:120,h:120});f.create({t:"image",parent:a,w:120,h:120,x:a.w/2-60,y:80,resource:V});f.create({t:"textBox",parent:a,textColor:g.WHITE,x:a.w/2-150,y:200,w:300,h:40,pixelSize:24,text:"Now discoverable as",
font:C,alignHorizontal:b});f.create({t:"textBox",parent:a,textColor:g.WHITE,x:a.w/2-150,y:230,w:300,h:40,pixelSize:24,text:'"Xfinity Bluetooth"',font:C,alignHorizontal:b});D=f.create({t:"rect",parent:D,w:650,h:f.h-250,x:15,y:80,fillColor:g.LISTPARENT,interactive:!1});f.create({t:"textBox",parent:D,textColor:g.HEADER,x:20,y:20,w:630,h:40,pixelSize:28,text:"Manage Bluetooth devices",font:C,alignHorizontal:r,alignVertical:p});var K=f.create({t:"object",parent:D,x:0,y:80,w:D.w,h:D.h-80,clip:!0}),T=f.create({t:"textBox",
parent:K,textColor:g.TEXT,x:0,y:-80,w:K.w,h:K.h,pixelSize:25,text:"No Bluetooth devices found.",alignHorizontal:b,alignVertical:p,cx:K.w/2,cy:K.h/2,font:C}),F=f.create({t:"object",parent:K}),Q=f.create({t:"rect",parent:D,w:K.w,h:2,y:78,fillColor:g.BLACK,a:0});b=f.create({t:"imageResource",url:m+"/images/loadingIndicator.svg",w:50,h:50});var N={image:f.create({t:"image",parent:a,w:50,h:50,x:a.w/2-25,y:a.h-180,cx:25,cy:25,resource:b,a:0,stretchX:f.stretch.STRETCH,stretchY:f.stretch.STRETCH}),animate:null,
show:function(){this.animate&&(this.animate.cancel(),this.animate=null);this.image.a=1;this.animate=this.image.animate({r:360},1.5,f.animation.TWEEN_LINEAR,f.animation.OPTION_REWIND,f.animation.COUNT_FOREVER)},hide:function(){this.animate&&(this.animate.cancel(),this.animate=null);this.image.a=0}},H=f.create({t:"imageResource",w:40,h:40,url:m+"/images/moreOptions.svg"}),S=f.create({t:"imageResource",w:40,h:40,url:m+"/images/moreOptionsHL.svg"});f.create({t:"imageResource",w:40,h:40,url:m+"/images/smokecircle.svg"});
f.create({t:"imageResource",w:30,h:30,url:m+"/images/phone.png"});var J=f.create({t:"imageResource",w:30,h:30,url:m+"/images/keyboard.svg"}),I=f.create({t:"imageResource",w:30,h:30,url:m+"/images/mouse.svg"});f.create({t:"imageResource",w:30,h:30,url:m+"/images/paired.png"});f.create({t:"imageResource",w:30,h:30,url:m+"/images/connected.png"});var y=f.create({t:"imageResource",w:30,h:30,url:m+"/images/headset.svg"}),E=f.create({t:"imageResource",w:40,h:40,url:m+"/images/imageBG.svg"});F.on("onKeyDown",
function(a){var b=a.keyCode,d=n.length;b==l.UP?(c(Math.min(Math.max(0,u-1),d-1)),a.stopPropagation()):b==l.DOWN?(u===d-1?(n[u].selectItem(!1),M.resource=U,O.focus=!0):c(Math.min(Math.max(0,u+1),d-1)),a.stopPropagation()):b==l.LEFT?0<=u&&u<d&&n[u].isMoreOptionsSelected()&&(n[u].selectItem(!0),a.stopPropagation()):b==l.RIGHT?0<=u&&u<d&&(n[u].isMoreOptionsSelected()?(n[u].selectItem(!1),M.resource=U,O.focus=!0):n[u].selectMoreOptions(!0),a.stopPropagation()):b==l.ENTER&&a.stopPropagation()});F.on("onKeyUp",
function(a){var b=n.length;a.keyCode==l.ENTER&&(0<=u&&u<b&&n[u].click(a),a.stopPropagation(),console.log("on item click"+u))});O.on("onKeyDown",function(a){var b=a.keyCode;b==l.UP||b==l.LEFT?(n[u].selectItem(!0),M.resource=L,F.focus=!0,a.stopPropagation()):b==l.ENTER&&(O.animateTo({sx:1.1,sy:1.1},.1,v,A,1).then(function(){O.animateTo({sx:1,sy:1},.1,v,A,1)}),a.stopPropagation(),console.log("discoverNewDevices event"))});O.on("onKeyUp",function(a){a.keyCode==l.ENTER&&(x.fireEvent("scr_onStartDiscovery",
a),a.stopPropagation(),console.log("discoverNewDevices event"))});O.focus=!0}module.exports.BtConnectivityScreen=BtConnectivityScreen;
var BtConnectivityView=function(){function a(){this.show=function(a){var c=this;this.toastRoot=b.create({t:"rect",parent:n,x:n.w/2-a.w/2,y:n.h-100,w:a.w,h:a.h,fillColor:f.TALL_POPPY,a:0,sx:0,sy:0,cx:a.w/2,cy:a.h/2,lineColor:f.WHITE,lineWidth:2});this.deviceName=b.create({t:"textBox",parent:this.toastRoot,textColor:f.WHITE,font:x,w:this.toastRoot.w,h:this.toastRoot.h,pixelSize:25,text:a.message,alignHorizontal:b.alignHorizontal.CENTER,alignVertical:b.alignVertical.CENTER});this.toastRoot.animateTo({sx:1,
sy:1,a:1},.3,b.animation.TWEEN_EXP1,b.animation.OPTION_FASTFORWARD,1).then(setTimeout(function(){c.toastRoot.animateTo({y:n.h,a:0},.3,b.animation.TWEEN_EXP1,b.animation.OPTION_FASTFORWARD,1).then(setTimeout(function(){c.toastRoot.remove();c.toastRoot=null},1E3))},2E3))}}var b=global.registry.scene,d=global.registry.all.BaseEventManager,e=global.registry.all.Options,c=global.registry.all.BtUtils,f=global.registry.all.Colors,l=global.registry.all.Logger,q=global.registry.all.EmulatorWindow,g=global.registry.all.Bluetooth,
m=global.registry.all.BtConnectivityScreen,t=global.registry.all.Popup,u=global.registry.keyCodes,n=null,h=null,z=px.getPackageBaseFilePath(),x=b.create({t:"fontResource",url:z+"/fonts/DejaVuSans.ttf"});console.time("App start");console.time("Startup action");var k={user_accepted_pairing:!1,known_devices:null,discovered_devices:null,paired_devices:null,connected_devices:null,_owner:null,_actions:new Map,_aip:!1,_aip_handler:null,_aip_timeout:30,_aip_timer_id:null,populateDevices:function(){var a=
this;this.known_devices=new Map;this._owner.log("Populating devices.");if(this.paired_devices&&0<this.paired_devices.length){for(var b=$jscomp.makeIterator(this.paired_devices),c=b.next();!c.done;c=b.next())c=c.value,c.connected=!1,this.known_devices.set(c.deviceID,c);this._owner.log("Populating devices.",this.paired_devices.length)}if(this.connected_devices&&0<this.connected_devices.length){b=$jscomp.makeIterator(this.connected_devices);for(c=b.next();!c.done;c=b.next())c=c.value,this.known_devices.set(c.deviceID,
c);this._owner.log("Populating devices.",this.connected_devices.length)}if(this.discovered_devices){var d=this.discovered_devices;this.discovered_devices.forEach(function(b,c,e){a.known_devices.has(b.deviceID)?d.delete(c):a.known_devices.set(b.deviceID,b)});this.discovered_devices=d;this._owner.log("Populating devices.",this.discovered_devices.length)}this._owner.log("Populated devices: %s",JSON.stringify(Array.from(this.known_devices.values())))},isPaired:function(a){return this.known_devices?(a=
this.known_devices.get(a))&&void 0!==a?a.paired:!1:!1},startAction:function(a,b){this._actions.has(a)&&this._owner.log("Action %s is already started. Overwriting.",a);b||(b={});this._actions.set(a,b);this.action_in_progress=!0;this._owner.log("Action %s has started.",a)},stopAction:function(a){this._actions.has(a)?(this._actions.delete(a),0===this._actions.size?(this.action_in_progress=!1,this._owner.log("Action %s has stopped.",a)):this._owner.log("Pending actions: %s",Array.from(this._actions.keys()))):
this._owner.log("Action %s cannot be stopped because it is not present (was stopped already?). Ignoring.",a)},hasAction:function(a){return this._actions.has(a)},getActionContext:function(a){var b;this._actions.has(a)?b=this._actions.get(a):this._owner.log("Action %s is not present (was stopped already?). Ignoring.",a);return b},clearActions:function(){this._owner.log("Clearing actions");this.action_in_progress?(this._owner.log("Removing: %s",Array.from(this._actions.keys())),this._actions.clear()):
this._owner.log("Nothing to clear.")},setOwner:function(a){if("null"===a||"object"!==typeof a)return!1;this._owner=a;return!0},setTimeOutHandler:function(a,b){if("null"===this._owner||"object"!==typeof this._owner||"null"===a||"function"!==typeof a||1>b)return!1;this._aip_handler=a;this._aip_timeout=b;return!0}};Object.defineProperties(k,{action_in_progress:{get:function(){return 0<this._actions.size},set:function(a){var b=this;a=!!a;this._owner.log("%s action.",a?"Starting":"Stopping");this._aip_timer_id&&
clearTimeout(this._aip_timer_id);a&&0<this._aip_timeout&&null!==this._aip_handler&&null!==this._owner&&"function"===typeof this._aip_handler&&"object"===typeof this._owner&&(this._aip_timer_id=setTimeout(function(){b._aip_handler.apply(b._owner,arguments)},1E3*this._aip_timeout))}}});var r={__proto__:Object.create(d.prototype),name:"Bluetooth Settings",screen:null,identity:{name:"app",version:"1.0.8.12",marker:{left:"{ ",right:" } "}},_options:{emulation:!1,debug:!1},api:null,_payload:{},availableDevicesTimer:null,
api_event_listeners:new Map,event_listeners:new Map,screen_event_sets:new Map,init:function(a){this.log("Init started.");var d=a.api_version;this.api=new g(b,a.service);this._options.emulation=c.parseBool(a.emulation);this._options.debug=c.parseBool(a.debug);this.api.setOption("emulation",this.isEmulation());this.updateEventListeners();this.api.init(d);this.isEmulation()||this.api.setBluetoothProperties({name:"Xfinity Bluetooth"});this.isEmulation()&&this.api.bluetooth_service.bluetoothctl.requirePin("on");
k.setOwner(this);k.setTimeOutHandler(this._handleTimeOut,30)||this.log("Timeout handler wasn't set");this.log("Init completed. Api version: %s, emulation is %s",a.api_version,a.emulation)},updateEventListeners:function(){this.log("Updating event listeners");for(var a=this,b={},c=$jscomp.makeIterator(this.api_event_listeners.entries()),d=c.next();!d.done;b={$jscomp$loop$prop$value$65:b.$jscomp$loop$prop$value$65},d=c.next()){d=$jscomp.makeIterator(d.value);var e=d.next().value;b.$jscomp$loop$prop$value$65=
d.next().value;this.api.on(e,function(b){return function(c){b.$jscomp$loop$prop$value$65.apply(a,arguments)}}(b))}b={};c=$jscomp.makeIterator(this.event_listeners.entries());for(d=c.next();!d.done;b={$jscomp$loop$prop$value$50$67:b.$jscomp$loop$prop$value$50$67},d=c.next())d=$jscomp.makeIterator(d.value),e=d.next().value,b.$jscomp$loop$prop$value$50$67=d.next().value,this.on(e,function(b){return function(c){b.$jscomp$loop$prop$value$50$67.apply(a,arguments)}}(b));this.log("Event listeners are set")},
run:function(){this.log("Getting support status.");var a=this.api.getStatusSupport();this.log("Status: %s",JSON.stringify(a));this.log("Enabling bluetooth.");a=this.api.enable();this.log("Result: %s",JSON.stringify(a));this.log("Making STB discoverable.");a=this.api.setBluetoothDiscoverable("on");this.log("Status: %s",JSON.stringify(a));this.fireEvent("onStartingUp",{});this.log("%s is ready.",this.isEmulation()?"Emulation":"Hardware")},showEmulator:function(){q.init({owner:this,parent:n});q.setupUI(b)},
isEmulation:function(){return c.parseBool(this._options.emulation)},isDebug:function(){return c.parseBool(this._options.debug)},resetAvailableDevicesTimer:function(){var a=this;this.availableDevicesTimer&&clearTimeout(this.availableDevicesTimer);this.availableDevicesTimer=setTimeout(function(){var b=k.discovered_devices&&0<k.discovered_devices.size;k.discovered_devices=null;b&&(k.populateDevices(),a.updateSceneDetails("populateDevices"))},18E4)},updateSceneDetails:function(a,b){switch(a){case "populateDevices":if(k.known_devices)h.onPopulateDevices(Array.from(k.known_devices.values()));
break;case "pairingRequest":h.onPairingRequest(b);break;case "connectionRequest":h.onConnectionRequest(b)}},_handleTimeOut:function(){this.log("Operation is timed out.");k.clearActions();c.sprintf("Device did not respond in %s seconds",k._aip_timeout);h.onError();(new a).show({message:"Device did not respond in "+k._aip_timeout+" seconds",w:600,h:50})},getData:function(){return this._payload}};d.call(r);l.call(Object.getPrototypeOf(r));r.api_event_listeners.set("statusChanged",function(a){this.log("API event: statusChanged.");
this.log(JSON.stringify(a));switch(a.newStatus){case "DISCOVERY_COMPLETED":this.fireEvent("onDiscoveryCompleted",a);break;case "PAIRING_CHANGE":this.fireEvent("onPairingChange",a);break;case "CONNECTION_CHANGE":this.fireEvent("onConnectionChange",a);break;case "SOFTWARE_ENABLED":this.fireEvent("onSoftwareEnabled",a);break;case "SOFTWARE_DISABLED":this.fireEvent("onSoftwareDisabled",a)}});r.api_event_listeners.set("requestFailed",function(a){this.log("API event: requestFailed.");this.log(JSON.stringify(a));
switch(a.newStatus){case "PAIRING_FAILED":this.fireEvent("onPairingFailed",a);break;case "CONNECTION_FAILED":this.fireEvent("onConnectionFailed",a)}});r.api_event_listeners.set("pairingRequest",function(a){this.log("API event: pairingRequest.");this.log(JSON.stringify(a));this.fireEvent("onPairingRequest",a)});r.api_event_listeners.set("connectionRequest",function(a){this.log("API event: connectionRequest.");this.log(JSON.stringify(a));this.fireEvent("onConnectionRequest",a)});r.api_event_listeners.set("deviceFound",
function(a){this.log("API event: deviceFound.");this.log(JSON.stringify(a));this.fireEvent("onDeviceFound",a)});r.api_event_listeners.set("deviceLost",function(a){this.log("API event: deviceLost.");this.log(JSON.stringify(a));this.fireEvent("onDeviceLost",a)});r.event_listeners.set("onStartingUp",function(a){this.log("Handling onStartingUp event.");k.paired_devices=k._owner.api.getPairedDevices(["HUMAN INTERFACE DEVICE","LOUDSPEAKER"]);k.connected_devices=k._owner.api.getConnectedDevices(["HUMAN INTERFACE DEVICE",
"LOUDSPEAKER"]);k.populateDevices();console.timeEnd("Startup action");this.log("Handling onStartingUp event: done.")});r.event_listeners.set("onDiscoveryCompleted",function(a){this.log("Handling onDiscoveryCompleted event.");k.stopAction("discovery");this.log("Getting discovered HUMAN INTERFACE DEVICES.");a=this.api.getDiscoveredDevices(["HUMAN INTERFACE DEVICE","LOUDSPEAKER"]);this.log("Status: %s",JSON.stringify(a));k.discovered_devices=new Map;a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=
a.next())b=b.value,k.discovered_devices.has(b.deviceID)||(k.discovered_devices.set(b.deviceID,b),this.log("Device %s added to known devices",b.name));k.populateDevices();this.updateSceneDetails("populateDevices");this.log("Handling onDiscoveryCompleted event: done.");this.resetAvailableDevicesTimer()});r.event_listeners.set("onPairingRequest",function(a){this.log("Handling onPairingRequest event.");this.log("Got a pairing request from %s",JSON.stringify(a));this.updateSceneDetails("pairingRequest",
{device:a});this.log("Handling onPairingRequest event: done.")});r.event_listeners.set("onPairingChange",function(a){this.log("Handling onPairingChange event.");k.hasAction("pairing")&&k.stopAction("pairing");k.paired_devices=k._owner.api.getPairedDevices(["HUMAN INTERFACE DEVICE","LOUDSPEAKER"]);k.populateDevices();this.updateSceneDetails("populateDevices");this.log("Handling onPairingChange event: done.")});r.event_listeners.set("onConnectionRequest",function(a){this.log("Handling onConnectionRequest event.");
this.log("Got a connection request from %s",JSON.stringify(a));this.api.respondToEvent({eventType:"connectionRequest",responseValue:"ACCEPTED",deviceID:a.deviceID});this.log("Handling onConnectionRequest event: done.")});r.event_listeners.set("onConnectionChange",function(a){k.connected_devices=k._owner.api.getConnectedDevices(["HUMAN INTERFACE DEVICE","LOUDSPEAKER"]);k.populateDevices();this.updateSceneDetails("populateDevices")});r.event_listeners.set("onConnectionFailed",function(b){this.log("Handling onConnectionFailed event.");
this.log("Connection failed: %s",JSON.stringify(b));(new a).show({message:"Connection request was refused by STB",w:600,h:50});this.log("Handling onConnectionFailed event: done.")});r.event_listeners.set("onPairingFailed",function(b){this.log("Handling onPairingFailed event.");this.log("Pairing failed: %s",JSON.stringify(b));k.hasAction("pairing")&&k.stopAction("pairing");(new a).show({message:"Pairing request was refused by STB",w:600,h:50});this.log("Handling onPairingFailed event: done.")});r.event_listeners.set("onDeviceFound",
function(b){this.log("Handling onDeviceFound event.");this.log("Doing nothing.");this.log("Handling onDeviceFound event: done.");(new a).show({message:"onDeviceFound",w:600,h:50})});r.event_listeners.set("onDeviceLost",function(b){this.log("Handling onDeviceLost event.");this.log("Doing nothing.");this.log("Handling onDeviceLost event: done.");(new a).show({message:"onDeviceLost",w:600,h:50})});var w=function(a){this.log("Handling onDisconnect event.");this.log("Handling onDisconnect event: done.")};
r.event_listeners.set("scr_onDeviceSelected",function(a){this.log("scr_onDeviceSelected ",k.action_in_progress);if(!k.action_in_progress){this.log("Looking whether %s is already connected.",a.device.name);for(var b=$jscomp.makeIterator(k.paired_devices),c=b.next();!c.done;c=b.next())if(c.value.deviceID===a.device.deviceID){this.log("%s is paired. Proceeding to the connection request screen.",a.device.name);this.api.setDeviceConnection(a.device.deviceID,"CONNECT",a.device.deviceType);return}this.log("%s is not paired. Proceeding to the pairing request screen.",
a.device.name);k.startAction("pairing",{device:a.device});this.api.setDevicePairing(a.device.deviceID,!0)}});r.event_listeners.set("onDeviceUnpair",function(a){this.log("onDeviceUnpair ",k.action_in_progress);!k.action_in_progress&&a.device&&(k.startAction("pairing",{device:a.device}),a.device.connected&&this.api.setDeviceConnection(a.device.deviceID,"DISCONNECT",a.device.deviceType),this.api.setDevicePairing(a.device.deviceID,!1))});r.event_listeners.set("onDeviceDisconnect",function(a){this.log("onDeviceDisconnect");
a.device&&this.api.setDeviceConnection(a.device.deviceID,"DISCONNECT",a.device.deviceType)});r.event_listeners.set("scr_onStartDiscovery",function(a){this.log("scr_onStartDiscovery call ",k.action_in_progress);k.action_in_progress||(k.startAction("discovery"),this.log("Discovery requested."),this.log("Starting device discovery."),h.onStartDiscovery(),a=this.api.startDeviceDiscovery(20),this.log("Status: %s",JSON.stringify(a)))});r.event_listeners.set("scr_onPairingAccept",function(a){this.log("scr_onPairingAccept ",
k.action_in_progress);k.action_in_progress||(this.log("Device accepted %s",JSON.stringify(a.device)),k.user_accepted_pairing=!0,k.startAction("pairing",{device:a.device}),this.api.respondToEvent({eventType:"pairingRequest",responseValue:"ACCEPTED",name:a.device.name,mac:a.device.MAC,deviceID:a.device.deviceID}))});r.event_listeners.set("scr_onPairingDecline",function(b){this.log("scr_onPairingDecline ",k.action_in_progress);k.action_in_progress||(this.log("Device declined"),this.api.respondToEvent({eventType:"pairingRequest",
responseValue:"REJECTED",name:b.device.name,mac:b.device.MAC,deviceID:b.device.deviceID}),(new a).show({message:"User did not accept the pairing request",w:600,h:50}))});r.event_listeners.set("scr_onConnectionAccept",function(a){this.log("scr_onConnectionAccept ",k.action_in_progress);k.action_in_progress?this.log("Connection request can't be accepted: There is one or more actions in progress: %s",k._actions):(this.log("Device accepted %s",JSON.stringify(a.device)),this.log("Accepting connection from %s",
a.device.name),this.api.respondToEvent({eventType:"connectionRequest",responseValue:"ACCEPTED",name:a.device.name,mac:a.device.MAC,deviceID:a.device.deviceID}))});r.event_listeners.set("scr_onConnectionDecline",function(b){this.log("scr_onConnectionDecline ",k.action_in_progress);k.action_in_progress||(this.log("Device declined"),this.api.respondToEvent({eventType:"connectionRequest",responseValue:"REJECTED",name:b.device.name,mac:b.device.MAC,deviceID:b.device.deviceID}),(new a).show({message:"User did not accept the connection request",
w:600,h:50}))});r.event_listeners.set("scr_onDisconnect",function(a){w.apply(this,arguments)});r.event_listeners.set("scr_onClose",function(a){this.log("scr_onClose ")});r.event_listeners.set("scr_onVolumeDown",function(a){this.api.setPlayback(a.device.deviceID,"VOULUME_DOWN")});r.event_listeners.set("scr_onVolumeUp",function(a){this.api.setPlayback(a.device.deviceID,"VOLUME_UP")});this.isBluetoothScreen=!0;this.setService=function(a){r.init({service:a,api_version:4,emulation:e.emulation?e.emulation:
"on",debug:e.debug?e.debug:"on"});r.run()};this.show=function(a){a.clear();a.addRow(function(a,c){c.h=580;n=b.create({t:"object",parent:a,w:c.w,h:c.h,x:c.x,y:c.y,fillColor:f.WHITE});h=new m(b,{BaseEventManager:d,keys:u,Popup:t,Colors:f,context:r,parent:n});r.isEmulation()&&r.showEmulator()})};this.refresh=function(){r.updateSceneDetails("populateDevices")};console.timeEnd("App start")};module.exports.BtConnectivityView=BtConnectivityView;
var CableCardStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.3);e["Device.DeviceInfo.UpTime"]=c.addRow("Uptime","TODO");e["Device.DeviceInfo.Manufacturer"]=c.addRow("Manufacturer","TODO");e["Device.Time.LocalTimeZone"]=c.addRow("Time Zone","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.DeviceInfo.UpTime"},               {"name" : "Device.DeviceInfo.Manufacturer"},               {"name" : "Device.Time.LocalTimeZone"},               {"name" : "Device.DeviceInfo.ModelName"}               ]}').then(function(a){console.log("got successful response from tr69 service");
console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.CableCardStatus=CableCardStatus;
var CableCardView=function(){var a=global.registry.all.Utils,b=global.registry.all.HdmiStatus,d=global.registry.all.VodStatus,e=[];this.show=function(c){c.clear();c.addRow(function(a,c){c.h=240;a=new b({title:"HDMI",parent:a,x:c.x,y:c.y,w:c.w,h:c.h});e.push(a.updateData);a.show()});c.addRow(function(b,c){c.h=!1===a.isClientDevice?560:460;-1!==a.modelName.indexOf("PX051")&&(c.h=540);var d=new d({title:"A/V",parent:b,x:c.x,y:c.y,w:c.w,h:c.h});e.push(d.updateData);d.show()});c.addRow(function(a,b){b.h=
300;a=new d({title:"VOD",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});e.push(a.updateData);a.show()})};this.refresh=function(){for(var a=0;a<e.length;a++)e[a]()}};module.exports.CableCardView=CableCardView;
var CanhStatus2=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.4);c.addRow("CANH API","TODO");c.addRow("Rev","TODO");c.addRow("CANH State","TODO");c.addRow("UnitAddress","TODO");c.addRow("Host_ID","TODO");c.addRow("Validation State","TODO");c.addRow("Connected","TODO");c.addRow("OOB_ID","TODO");c.addRow("VCT_ID","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",
headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"}               ]}').then(function(a){console.log("got successful response from tr69 service");console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+
"]")})}};module.exports.CanhStatus2=CanhStatus2;
var CanhStatus3=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.addRowLeft("Listeners","TODO");c.addRowLeft("SUB","TODO");c.addRowLeft("Pending Purchases","TODO");c.addRowLeft("Pass-Thru Msgs","TODO");c.addRowLeft("Rcvd","TODO");c.addRowRight("Pass-Thru Filters","TODO");c.addRowRight("Destination IP","TODO");c.addRowRight("OOB_ID Rcvd","TODO");c.addRowRight("STB IP Addr Rcvd","TODO");c.addRowRight("UnitAddress Rcvd",
"TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"}               ]}').then(function(a){console.log("got successful response from tr69 service");console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},function(b){console.log("inside errorCallback");
console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.CanhStatus3=CanhStatus3;
var CanhStatus4=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.4);c.addRowLeft("Prgind","TODO");c.addRowLeft("Prgind","TODO");c.addRowLeft("Auth","TODO");c.addRowRight("EID","TODO");c.addRowRight("Prgind","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"}               ]}').then(function(a){console.log("got successful response from tr69 service");
console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.CanhStatus4=CanhStatus4;
var CanhStatus5=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.4);c.addRow("Prgind","TODO");c.addRow("Prgind","TODO");c.addRow("Prgind","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"}               ]}').then(function(a){console.log("got successful response from tr69 service");
console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.CanhStatus5=CanhStatus5;
var CanhStatus6=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.4);c.addRow("Status","TODO");c.addRow("No errors","TODO");c.addRow("Pending Purchase List in Hex","TODO");c.addRow("None","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"}               ]}').then(function(a){console.log("got successful response from tr69 service");
console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.CanhStatus6=CanhStatus6;
var DeviceLocalStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.3);1==d.isClientDevice?(-1!==d.modelName.indexOf("PX051")?(e["Device.WiFi.SSID.1.Status"]=c.addRow("WiFi Status","TODO"),e["Device.WiFi.SSID.1.MACAddress"]=c.addRow("WiFi MAC","TODO"),e["Device.WiFi.SSID.1.Name"]=c.addRow("SSID","TODO"),e["Device.WiFi.Radio.1.OperatingFrequencyBand"]=c.addRow("Frequency","TODO"),e["Device.WiFi.Radio.1.Channel"]=
c.addRow("Channel","TODO"),e["Device.DeviceInfo.X_RDKCENTRAL-COM_xBlueTooth.DeviceInfo.RSSI"]=c.addRow("RSSI","TODO"),e["Device.WiFi.AccessPoint.1.Security.ModeEnabled"]=c.addRow("Security","TODO"),c.addRow("Device","MAC",!0)):c.addRow("Device","MAC"),e["Device.DeviceInfo.X_COMCAST-COM_STB_MAC"]=c.addRow("eSTB","TODO"),e["Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"]=c.addRow("Video Gateway MAC","TODO",!0),e["Device.Time.LocalTimeZone"]=c.addRow("Time Zone","TODO"),e["Device.Time.CurrentLocalTime"]=
c.addRow("Local Time","TODO")):(c.addRowLeft("Device","MAC"),e["Device.DeviceInfo.X_COMCAST-COM_STB_MAC"]=c.addRowLeft("eSTB","TODO"),e["Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"]=c.addRowLeft("eCM","TODO"),e["Device.Time.LocalTimeZone"]=c.addRowRight("Time Zone","TODO"),e["Device.Time.CurrentLocalTime"]=c.addRowRight("Local Time","TODO"))};this.updateData=function(){d.doHttpPost({hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}},'{"paramList" : [               {"name" : "Device.DeviceInfo.X_COMCAST-COM_STB_MAC"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"},               {"name" : "Device.Time.LocalTimeZone"},               {"name" : "Device.Time.CurrentLocalTime"},               {"name" : "Device.WiFi.SSID.1.Name"},               {"name" : "Device.WiFi.SSID.1.Status"},               {"name" : "Device.WiFi.SSID.1.MACAddress"},               {"name" : "Device.WiFi.Radio.1.Channel"},               {"name" : "Device.DeviceInfo.X_RDKCENTRAL-COM_xBlueTooth.DeviceInfo.RSSI"},               {"name" : "Device.WiFi.AccessPoint.1.Security.ModeEnabled"},               {"name" : "Device.WiFi.Radio.1.OperatingFrequencyBand"}               ]}').then(function(a){for(var b=
0;b<a.paramList.length;b++)void 0!==e[a.paramList[b].name]&&(e[a.paramList[b].name].text=a.paramList[b].value)},function(a){})}};module.exports.DeviceLocalStatus=DeviceLocalStatus;
var DeviceStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e=new Map([["PX013AN","Pace XG1v3"],["PX022AN","Pace XG2v2"],["PX001AN","Pace XG1v1"],["PXD01ANI","Pace XiD"],["PX032ANI","Pace Xi3v2"],["PX051AEI","Pace Xi5"],["AX061AEI","Arris Xi6"],["AX014AN","Arris XG1v4"],["AX013AN","Arris XG1v3"],["MX011AN","Arris XG1v1"],["SX022AN","Samsung XG2v2"],["CXD01ANI","Cisco XiD"],["CS011AN","Cisco G8"],["PR150BN","Pace RNG150"],["SR150BN","Samsung RNG150"]]),c={};this.show=
function(){var f=new b(d.scene,a);f.addRowLeft("Make",e.get(d.modelName));c["Device.DeviceInfo.ModelName"]=f.addRowLeft("Model","TODO");c["Device.DeviceInfo.SerialNumber"]=f.addRowLeft("Serial Number","TODO");c["Device.DeviceInfo.X_COMCAST-COM_STB_MAC"]=f.addRowLeft("eSTB Mac (Device/Mgmt)","TODO");1==d.isClientDevice&&(-1!==d.modelName.indexOf("PX051")?(c["Device.WiFi.SSID.1.MACAddress"]=f.addRowLeft("WiFi Mac","TODO"),c["Device.Ethernet.Interface.1.MACAddress"]=f.addRowLeft("Ethernet Mac","TODO")):
c["Device.MoCA.Interface.1.MACAddress"]=f.addRowLeft("MoCA Mac","TODO"));c["Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreReceiverId"]=f.addRowRight("Receiver ID",d.placeHolderWrapText);c["Device.DeviceInfo.HardwareVersion"]=f.addRowRight("HW Rev","TODO");c["Device.DeviceInfo.UpTime"]=f.addRowRight("Uptime","TODO");c["Device.DeviceInfo.X_COMCAST-COM_PowerStatus"]=f.addRowRight("Power Status","TODO");c["Device.DeviceInfo.X_RDKCENTRAL-COM.BootStatus"]=f.addRowRight("Boot Status","XRE connection established - successful")};
this.updateData=function(){console.log("devicestatus updateData");d.doHttpPost({hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}},'{"paramList" : [               {"name" : "Device.DeviceInfo.ModelName"},               {"name" : "Device.DeviceInfo.SerialNumber"},               {"name" : "Device.DeviceInfo.X_COMCAST-COM_STB_MAC"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"},               {"name" : "Device.MoCA.Interface.1.MACAddress"},               {"name" : "Device.DeviceInfo.HardwareVersion"},               {"name" : "Device.DeviceInfo.UpTime"},               {"name" : "Device.WiFi.SSID.1.MACAddress"},               {"name" : "Device.Ethernet.Interface.1.MACAddress"},               {"name" : "Device.DeviceInfo.X_COMCAST-COM_PowerStatus"},               {"name" : "Device.DeviceInfo.X_RDKCENTRAL-COM.BootStatus"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreReceiverId"}               ]}').then(function(a){for(var b=
0;b<a.paramList.length;b++)console.log("device status key name "+a.paramList[b].name),console.log("device status key name "+a.paramList[b].value),void 0!==c[a.paramList[b].name]&&(c[a.paramList[b].name].text=a.paramList[b].value)},function(a){})}};module.exports.DeviceStatus=DeviceStatus;
var DocsisLevelsStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.4);c.addRow("Downstream Center Frequency","TODO");c.addRow("Downstream Rcvd Power","TODO");c.addRow("Downstream Carrier Lock","TODO");c.addRow("Downstream SNR","TODO");e["Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"]=c.addRow("Upstream Center Frequency","TODO");c.addRow("Upstream Power","TODO");c.addRow("DSG Status","TODO");
c.addRow("CM Status","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"}               ]}').then(function(a){console.log("got successful response from tr69 service");console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},function(b){console.log("inside errorCallback");
console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.DocsisLevelsStatus=DocsisLevelsStatus;
var DocsisStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.4);c.addRow("Downstream Center Frequency","TODO");c.addRow("Downstream Received Power","TODO");c.addRow("Downstream Carrier Lock","TODO");c.addRow("Downstream SNR","TODO");e["Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"]=c.addRow("Upstream Center Frequency","TODO");c.addRow("Upstream Power","TODO");c.addRow("eCM Serial Number",
"TODO");c.addRow("eCM Version","TODO");c.addRow("eCM Boot Status","TODO");c.addRow("eCM Boot File","TODO");c.addRow("CM Status","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"}               ]}').then(function(a){for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},function(b){console.log("inside errorCallback");
console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.DocsisStatus=DocsisStatus;
var DsgStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.45);c.addRowLeft("ADV DSG","TODO");c.addRowLeft("Host EDC Ver","TODO");c.addRowLeft("DSG Flow Status","TODO");c.addRowLeft("DSG Mode","TODO");c.addRowLeft("CA Tunnel","TODO");c.addRowLeft("Br. Tunnel","TODO");c.addRowLeft("Device","TODO");c.addRowRight("Filters","TODO");c.addRowRight("Rate Current","TODO");c.addRowRight("Rate Top","TODO");
c.addRowRight("Reportback Status","TODO");c.addRowRight("CC MAC Addr","TODO");c.addRowRight("IP_U Address","TODO");c.addRowRight("RB Flow Status","TODO");c.addRowRight("RADD Addr Status","TODO");c.addRowRight("Auto Reg. Status","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.DeviceInfo.X_COMCAST-COM_STB_MAC"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"},               {"name" : "Device.Time.LocalTimeZone"}               ]}').then(function(a){console.log("got successful response from tr69 service");
console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.DsgStatus=DsgStatus;
var EmulatorWindow={__proto__:Object.create(BaseEventManager.prototype),init:function(a){this._owner=a.owner;this.parent=a.parent},setupUI:function(a){var b=this,d=a.create({t:"rect",parent:this.parent,w:this.parent.w,h:30,y:this.parent.h-30,a:.5,fillColor:1684697330});a.create({t:"textBox",parent:d,w:70,h:d.h,fillColor:"#3ff",pixelSize:25,alignVertical:a.alignVertical.CENTER,text:"Pair",x:10}).on("onMouseDown",function(a){b._owner.fireEvent("dbg_onUserPairingRequest",a)});a.create({t:"textBox",parent:d,
w:100,h:d.h,fillColor:"#3ff",pixelSize:25,alignVertical:a.alignVertical.CENTER,text:"Unpair",x:80}).on("onMouseDown",function(a){b._owner.fireEvent("dbg_onUserUnpair",a)});a.create({t:"textBox",parent:d,w:100,h:d.h,fillColor:"#3ff",pixelSize:25,alignVertical:a.alignVertical.CENTER,text:"Connect",x:180}).on("onMouseDown",function(a){b._owner.fireEvent("dbg_onUserConnectionRequest",a)});a.create({t:"textBox",parent:d,w:100,h:d.h,fillColor:"#3ff",pixelSize:25,alignVertical:a.alignVertical.CENTER,text:"Disconnect",
x:300}).on("onMouseDown",function(a){b._owner.fireEvent("dbg_onUserDisconnect",a)});a.create({t:"textBox",parent:d,w:100,h:d.h,fillColor:"#3ff",pixelSize:25,alignVertical:a.alignVertical.CENTER,text:"Playback Req",x:450}).on("onMouseDown",function(a){b._owner.fireEvent("dbg_onPlaybackRequest",a)});a.create({t:"textBox",parent:d,w:100,h:d.h,fillColor:"#3ff",pixelSize:25,alignVertical:a.alignVertical.CENTER,text:"Play",x:640}).on("onMouseDown",function(a){b._owner.fireEvent("dbg_onUserPlaybackStarted",
a)});a.create({t:"textBox",parent:d,w:100,h:d.h,fillColor:"#3ff",pixelSize:25,alignVertical:a.alignVertical.CENTER,text:"Pause",x:720}).on("onMouseDown",function(a){b._owner.fireEvent("dbg_onUserPlaybackPaused",a)});a.create({t:"textBox",parent:d,w:100,h:d.h,fillColor:"#3ff",pixelSize:25,alignVertical:a.alignVertical.CENTER,text:"Stop",x:830}).on("onMouseDown",function(a){b._owner.fireEvent("dbg_onUserPlaybackStopped",a)});a.create({t:"textBox",parent:d,w:100,h:d.h,fillColor:"#3ff",pixelSize:25,alignVertical:a.alignVertical.CENTER,
text:"Previous",x:920}).on("onMouseDown",function(a){b._owner.fireEvent("dbg_onUserPlaybackPrevious",a)});a.create({t:"textBox",parent:d,w:100,h:d.h,fillColor:"#3ff",pixelSize:25,alignVertical:a.alignVertical.CENTER,text:"Next",x:1040}).on("onMouseDown",function(a){b._owner.fireEvent("dbg_onUserPlaybackNext",a)})}},this_screen=EmulatorWindow;BaseEventManager.call(this_screen);module.exports.EmulatorWindow=this_screen;
var ErrorsNetworkStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.3);c.addRow("Application Signaling","unknown");c.addRow("Timeouts","TODO");c.addRow("PAT","0");c.addRow("PMT","0");c.addRow("IB OC","0");c.addRow("OOB OC","0");c.addRow("Tuner","Failed Tune Count",!0);c.addRow("Tuner-1","0");c.addRow("Tuner-2","0");c.addRow("Tuner-3","0");c.addRow("Tuner-4","0");c.addRow("Tuner-5","0");c.addRow("Tuner-6",
"0")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"}               ]}').then(function(a){console.log("got successful response from tr69 service");console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},function(b){console.log("inside errorCallback");
console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.ErrorsNetworkStatus=ErrorsNetworkStatus;
var FirmwareStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.3);e["Device.DeviceInfo.X_COMCAST-COM_FirmwareFilename"]=c.addRow("Running","TODO");e["Device.DeviceInfo.X_RDKCENTRAL-COM_FirmwareFilename"]=c.addRow("Last Download Version","TODO");e["Device.DeviceInfo.X_COMCAST-COM_FirmwareDownloadStatus"]=c.addRow("Download Status","TODO");e["FW Image Name"]=c.addRow("FW Image Name","TODO");e["Device.DeviceInfo.X_RDKCENTRAL-COM.BootStatus"]=
c.addRow("Boot Status","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.DeviceInfo.X_COMCAST-COM_FirmwareFilename"},               {"name" : "Device.DeviceInfo.X_RDKCENTRAL-COM_FirmwareFilename"},               {"name" : "Device.DeviceInfo.X_RDKCENTRAL-COM.BootStatus"},               {"name" : "Device.DeviceInfo.X_COMCAST-COM_FirmwareDownloadStatus"}               ]}').then(function(a){for(var b=
0;b<a.paramList.length;b++)void 0!==e[a.paramList[b].name]&&(e[a.paramList[b].name].text=a.paramList[b].value,"Device.DeviceInfo.X_COMCAST-COM_FirmwareFilename"==a.paramList[b].name&&(e["FW Image Name"].text=a.paramList[b].value))},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.FirmwareStatus=FirmwareStatus;
var FlowsInUseStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.3);c.addRow("MPEG","21333");c.addRow("IPU","0");c.addRow("IPM","0");c.addRow("DSG","0");c.addRow("Socket","0")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"}               ]}').then(function(a){console.log("got successful response from tr69 service");
console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.FlowsInUseStatus=FlowsInUseStatus;
var HdmiStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.3);e["Device.Services.STBService.1.Components.HDMI.1.Status"]=c.addRow("Connection Status","TODO");e["Device.Services.STBService.1.Components.VideoOutput.1.HDCP"]=c.addRow("HDCP Status","TODO");e["Device.Services.STBService.1.Components.AudioOutput.1.X_COMCAST-COM_AudioDB"]=c.addRow("HDMI Audio","TODO")};this.updateData=function(){d.doHttpPost({hostname:"127.0.0.1",
port:10999,method:"POST",headers:{"Content-Type":"application/json"}},'{"paramList" : [               {"name" : "Device.Services.STBService.1.Components.VideoOutput.1.HDCP"},               {"name" : "Device.Services.STBService.1.Components.AudioOutput.1.X_COMCAST-COM_AudioDB"},               {"name" : "Device.Services.STBService.1.Components.HDMI.1.Status"}               ]}').then(function(a){for(var b=0;b<a.paramList.length;b++)void 0!==e[a.paramList[b].name]&&(e[a.paramList[b].name].text=a.paramList[b].value)},
function(a){})}};module.exports.HdmiStatus=HdmiStatus;
var HostPropertiesStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.3);e["Device.DeviceInfo.SerialNumber"]=c.addRow("Serial Number","TODO");e["Device.DeviceInfo.ModelName"]=c.addRow("Model Name","TODO");e["Device.DeviceInfo.Manufacturer"]=c.addRow("Vendor Name","TODO");e["Device.DeviceInfo.MemoryStatus.Total"]=c.addRow("Total Memory","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",
port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.DeviceInfo.SerialNumber"},               {"name" : "Device.DeviceInfo.Manufacturer"},               {"name" : "Device.DeviceInfo.MemoryStatus.Total"},               {"name" : "Device.DeviceInfo.ModelName"}               ]}').then(function(a){console.log("got successful response from tr69 service");console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=
a.paramList[b].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.HostPropertiesStatus=HostPropertiesStatus;
var HostTru2WayStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.3);e["Device.DeviceInfo.HardwareVersion"]=c.addRow("Hardware Revision","TODO");e["Device.DeviceInfo.Manufacturer"]=c.addRow("Vendor","TODO");e["Device.DeviceInfo.SoftwareVersion"]=c.addRow("Software Revision","TODO");e["Device.DeviceInfo.ModelName"]=c.addRow("Model","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",
port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.DeviceInfo.HardwareVersion"},               {"name" : "Device.DeviceInfo.Manufacturer"},               {"name" : "Device.DeviceInfo.SoftwareVersion"},               {"name" : "Device.DeviceInfo.ModelName"}               ]}').then(function(a){console.log("got successful response from tr69 service");console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=
a.paramList[b].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.HostTru2WayStatus=HostTru2WayStatus;
var InBandNetworkStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.3);c.addRow("Tuner","Frequency(hertz)");c.addRow("Tuner-1","TODO");c.addRow("Tuner-2","TODO");c.addRow("Tuner-3","TODO");c.addRow("Tuner-4","TODO");c.addRow("Tuner-5","TODO");c.addRow("Tuner-6","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};
d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"}               ]}').then(function(a){console.log("got successful response from tr69 service");console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};
module.exports.InBandNetworkStatus=InBandNetworkStatus;
var InitHistoryStatus=function(a){var b={};this.show=function(){new DetailsItem(Utils.scene,a)};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};Utils.doHttpPost(a,'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.Client.XRE.InitHistoryStatus"}               ]}').then(function(a){console.log("got successful response from tr69 service");console.log("parse value is "+a.paramList[0].value);for(var c=0;c<
a.paramList.length;c++)b[a.paramList[c].name].text=a.paramList[c].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.InitHistoryStatus=InitHistoryStatus;
var InstallSummaryView=function(){var a=global.registry.all.Utils,b=global.registry.all.DeviceStatus,d=global.registry.all.NetworkConnection,e=global.registry.all.FirmwareStatus,c=global.registry.all.XreStatus,f=global.registry.all.TunerStatus,l=global.registry.all.MemoryStatus,q=global.registry.all.InitHistoryStatus,g=global.registry.all.HostTru2WayStatus,m=global.registry.all.HostPropertiesStatus,t=global.registry.all.MCardCertificateStatus,u=global.registry.all.WifiStatus,n=[];this.show=function(h){h.addRow(function(a,
c){c.w/=2;var e=new b({title:"Device Status",parent:a,x:c.x,y:c.y,w:c.w,h:c.h});n.push(e.updateData);e.show();c.x=c.w;a=new d({title:"Network Connection",parent:a,x:c.x,y:c.y,w:c.w,h:c.h});n.push(a.updateData);a.show()});h.addRow(function(a,b){b.w/=2;var d=new e({title:"Firmware",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});n.push(d.updateData);d.show();b.x=b.w;a=new c({title:"XRE",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});n.push(a.updateData);a.show()});h.addRow(function(a,b){b.w/=2;var c=new f({title:"Tuner Status",
parent:a,x:b.x,y:b.y,w:b.w,h:b.h});n.push(c.updateData);c.show();b.x=b.w;a=new l({title:"Memory",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});n.push(a.updateData);a.show()});-1!==a.modelName.indexOf("PX051")&&h.addRow(function(a,b){a=new u({title:"WIFI Stats",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});n.push(a.updateData);a.show()});0==a.isClientDevice&&(h.addRow(function(a,b){b.w/=2;var c=new q({title:"Init History",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});n.push(c.updateData);c.show();b.x=b.w;a=new g({title:"Host: Tru2Way",
parent:a,x:b.x,y:b.y,w:b.w,h:b.h});n.push(a.updateData);a.show()}),h.addRow(function(a,b){b.w/=2;var c=new m({title:"Host: Properties",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});n.push(c.updateData);c.show();b.x=b.w;var d=new d({title:"Cable Card",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});n.push(d.updateData);d.show()}),h.addRow(function(a,b){a=new t({title:"M-Card Certificate",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});n.push(a.updateData);a.show()}))};this.refresh=function(){for(var a=0;a<n.length;a++)n[a]()}};
module.exports.InstallSummaryView=InstallSummaryView;
var MCardCertificateStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.2);c.addRow("Host ID","TODO");c.addRow("Certificate Available","TODO");c.addRow("Certificate Valid","TODO");c.addRow("Verified with Chain","TODO");c.addRow("Production Key","TODO");e["Device.DeviceInfo.UpTime"]=c.addRow("DeviceCertSubjectName","TODO");e["Device.DeviceInfo.Manufacturer"]=c.addRow("DeviceCertIssuerName","TODO");
c.addRow("ManufacturerCertSubjectName","TODO");c.addRow("ManufacturerCertIssuerName","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.DeviceInfo.ModelName"}               ]}').then(function(a){console.log("got successful response from tr69 service");console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=
a.paramList[b].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.MCardCertificateStatus=MCardCertificateStatus;
var McardCahnStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.addRowLeft("CANH Status","TODO");c.addRowLeft("CANH Protocol Version","TODO");c.addRowLeft("MCARD","TODO");c.addRowRight("IPPV Protocol Version","TODO");c.addRowRight("MCARD","TODO");c.addRowRight("OOB ID","TODO");c.addRowRight("CANH SAS Msgs Rcvd","TODO");c.addRowRight("IPPV SAS Msgs Rcvd","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",
port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.DeviceInfo.X_COMCAST-COM_STB_MAC"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"},               {"name" : "Device.Time.LocalTimeZone"}               ]}').then(function(a){console.log("got successful response from tr69 service");console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=
a.paramList[b].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.McardCahnStatus=McardCahnStatus;
var MemoryStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.5);0!=d.isClientDevice&&(e["Device.Services.STBService.1.Components.X_RDKCENTRAL-COM_SDCard.Status"]=c.addRowLeft("SD Card Health","TODO"),e["Device.Services.STBService.1.Components.X_RDKCENTRAL-COM_SDCard.TSBQualified"]=c.addRowLeft("TSB Enable Status","TODO"),e["Device.Services.STBService.1.Components.X_RDKCENTRAL-COM_SDCard.ReadOnly"]=
c.addRowLeft("SD Write Enable","TODO"),e["Device.Services.STBService.1.Components.X_RDKCENTRAL-COM_SDCard.LifeElapsed"]=c.addRowLeft("Life Elapsed","TODO"),e["Device.Services.STBService.1.Components.X_RDKCENTRAL-COM_SDCard.Capacity"]=c.addRowRight("Capacity","TODO"),e["Device.Services.STBService.1.Components.X_RDKCENTRAL-COM_SDCard.CardFailed"]=c.addRowRight("Card Failed","TODO"))};this.updateData=function(){d.doHttpPost({hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}},
'{"paramList" : [               {"name" : "Device.Services.STBService.1.Components.X_RDKCENTRAL-COM_SDCard.Status"},               {"name" : "Device.Services.STBService.1.Components.X_RDKCENTRAL-COM_SDCard.CardFailed"},               {"name" : "Device.Services.STBService.1.Components.X_RDKCENTRAL-COM_SDCard.LifeElapsed"},               {"name" : "Device.Services.STBService.1.Components.X_RDKCENTRAL-COM_SDCard.Capacity"},               {"name" : "Device.Services.STBService.1.Components.X_RDKCENTRAL-COM_SDCard.TSBQualified"},               {"name" : "Device.Services.STBService.1.Components.X_RDKCENTRAL-COM_SDCard.ReadOnly"}               ]}').then(function(a){for(var b=
0;b<a.paramList.length;b++)void 0!==e[a.paramList[b].name]&&(e[a.paramList[b].name].text="Device.Services.STBService.1.Components.X_RDKCENTRAL-COM_SDCard.ReadOnly"===a.paramList[b].name?!a.paramList[b].value:a.paramList[b].value)},function(a){})}};module.exports.MemoryStatus=MemoryStatus;
var NetworkConnection=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.4);e["Device.DeviceInfo.X_COMCAST-COM_STB_IP"]=c.addRow("eSTB IP","TODO");-1===d.modelName.indexOf("PX051")&&(e["Device.MoCA.Interface.1.Status"]=c.addRow("MoCA Status","TODO"),e["Device.MoCA.Interface.1.AssociatedDeviceNumberOfEntries"]=c.addRow("# of Connected Devices","TODO"),e["Device.MoCA.Interface.1.NodeID"]=c.addRow("Node ID",
"TODO"),e["Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewayDeviceFriendlyName"]=c.addRow("NC Name","TODO"),e["Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"]=c.addRow("NC MoCA MAC","TODO"),e["Device.MoCA.Interface.1.AssociatedDevice.1.PHYTxRate"]=c.addRow("NC Tx/Rx Rates","TODO"));1==d.isClientDevice&&(-1!==d.modelName.indexOf("PX051")&&(c.addRow("Ethernet Status","TODO"),c.addRow("Ethernet LinkLocal IPv4","TODO"),c.addRow("Ethernet DHCP IPv4","TODO"),c.addRow("Ethernet LinkLocal IPv6","TODO"),c.addRow("Ethernet GloballyUnique IPv6",
"TODO"),e["Device.WiFi.SSID.1.Status"]=c.addRow("WiFi Status","TODO"),c.addRow("WiFi LinkLocal IPv4","TODO"),c.addRow("WiFi DHCP IPv4","TODO"),c.addRow("WiFi LinkLocal IPv6","TODO"),c.addRow("WiFi GloballyUnique IPv6","TODO")),e.HubConnectionStatus=c.addRow("Hub Connection Status","Disconnected",!0),e["Device.X_COMCAST-COM_Xcalibur.TRM.trmTunerNumber"]=c.addRow("Allocated Tuner Number","TODO"))};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};
d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.DeviceInfo.X_COMCAST-COM_STB_IP"},               {"name" : "Device.MoCA.Interface.1.Status"},               {"name" : "Device.MoCA.Interface.1.AssociatedDeviceNumberOfEntries"},               {"name" : "Device.MoCA.Interface.1.NodeID"},               {"name" : "Device.MoCA.Interface.1.AssociatedDevice.1.PHYTxRate"},               {"name" : "Device.MoCA.Interface.1.AssociatedDevice.1.PHYRxRate"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewayDeviceFriendlyName"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmTunerNumber"}               ]}').then(function(a){for(var b,
c=0;c<a.paramList.length;c++)"Device.MoCA.Interface.1.AssociatedDevice.1.PHYRxRate"===a.paramList[c].name?b=a.paramList[c].value:"Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"===a.paramList[c].name&&a.paramList[c].value&&(e.HubConnectionStatus.text="Hub "+a.paramList[c].value+" Connected"),void 0!==e[a.paramList[c].name]&&(e[a.paramList[c].name].text=a.paramList[c].value);e["Device.MoCA.Interface.1.AssociatedDevice.1.PHYTxRate"]+="/"+b},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+
a.hostname+":"+a.port+"]")})}};module.exports.NetworkConnection=NetworkConnection;
var NetworkConnection_1=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.4);-1!==d.modelName.indexOf("PX051")?(e["Device.WiFi.SSID.1.Status"]=c.addRow("WiFi Status","TODO"),c.addRow("Ethernet Status","TODO"),c.addRow("Ethernet LinkLocal IP","TODO"),c.addRow("Ethernet DHCP IP","TODO"),c.addRow("WiFi LinkLocal IP","TODO"),c.addRow("WiFi DHCP IP","TODO")):(e["Device.MoCA.Interface.1.Status"]=c.addRow("MoCA Status",
"TODO"),e["Device.MoCA.Interface.1.AssociatedDeviceNumberOfEntries"]=c.addRow("# of Connected Devices","TODO"),e["Device.MoCA.Interface.1.NodeID"]=c.addRow("Node ID","TODO"),e["Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"]=c.addRow("NC MoCA MAC","TODO"),e["Device.MoCA.Interface.1.AssociatedDevice.1.PHYTxRate"]=c.addRow("NC Tx/Rx Rates","TODO"));1==d.isClientDevice?(d.modelName.indexOf("PX032"),e.HubConnectionStatus=c.addRow("Hub Connection Status","Disconnected"),e["Device.X_COMCAST-COM_Xcalibur.TRM.trmTunerNumber"]=
c.addRow("Allocated Tuner Number","TODO")):e["Device.DeviceInfo.X_COMCAST-COM_STB_IP"]=c.addRow("eSTB IP","TODO")};this.updateData=function(){d.doHttpPost({hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}},'{"paramList" : [               {"name" : "Device.DeviceInfo.X_COMCAST-COM_STB_IP"},               {"name" : "Device.MoCA.Interface.1.Status"},               {"name" : "Device.MoCA.Interface.1.AssociatedDeviceNumberOfEntries"},               {"name" : "Device.MoCA.Interface.1.NodeID"},               {"name" : "Device.WiFi.SSID.1.Status"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmTunerNumber"},               {"name" : "Device.MoCA.Interface.1.AssociatedDevice.1.PHYTxRate"},               {"name" : "Device.MoCA.Interface.1.AssociatedDevice.1.PHYRxRate"}               ]}').then(function(a){for(var b,
c=0;c<a.paramList.length;c++)void 0!==e[a.paramList[c].name]&&("Device.MoCA.Interface.1.AssociatedDevice.1.PHYRxRate"===a.paramList[c].name?b=a.paramList[c].value:"Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"===a.paramList[c].name&&a.paramList[c].value&&(e.HubConnectionStatus.text="Hub "+a.paramList[c].value+" Connected"),e[a.paramList[c].name].text=a.paramList[c].value);e["Device.MoCA.Interface.1.AssociatedDevice.1.PHYTxRate"]+="/"+b},function(a){})}};module.exports.NetworkConnection_1=NetworkConnection_1;
var NetworkConnectionsView=function(){var a=global.registry.all.Utils,b=global.registry.all.DeviceLocalStatus,d=global.registry.all.NetworkConnection,e=global.registry.all.DocsisStatus,c=global.registry.all.DocsisLevelsStatus,f=global.registry.all.InBandNetworkStatus,l=global.registry.all.ErrorsNetworkStatus,q=global.registry.all.FlowsInUseStatus,g=global.registry.all.DsgStatus,m=global.registry.all.TunnelInfoScreenStatus,t=global.registry.all.MCardCahnStatus,u=global.registry.all.CanhStatus2,n=global.registry.all.CanhStatus3,
h=global.registry.all.CanhStatus4,z=global.registry.all.CanhStatus5,x=global.registry.all.CanhStatus6,k=global.registry.all.OperationalStatus,r=global.registry.all.WifiStatus,w=[];this.show=function(p){p.clear();p.addRow(function(a,c){c.w/=2;var e=new b({title:"Device Local",parent:a,x:c.x,y:c.y,w:c.w,h:c.h});w.push(e.updateData);e.show();c.x=c.w;a=new d({title:"Network Connection",parent:a,x:c.x,y:c.y,w:c.w,h:c.h});w.push(a.updateData);a.show()});-1!==a.modelName.indexOf("PX051")&&p.addRow(function(a,
b){a=new r({title:"WIFI Stats",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(a.updateData);a.show()});0==a.isClientDevice&&(p.addRow(function(a,b){b.w/=2;var d=new e({title:"DOCSIS",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(d.updateData);d.show();b.x=b.w;a=new c({title:"DOCSIS Levels",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(a.updateData);a.show()}),p.addRow(function(a,b){b.w/=2;var c=new f({title:"In-Band Network",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(c.updateData);c.show();b.x=b.w;a=new l({title:"Errors",
parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(a.updateData);a.show()}),p.addRow(function(a,b){b.w/=2;var c=new q({title:"Flows in Use",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(c.updateData);c.show();b.x=b.w;a=new g({title:"DSG",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(a.updateData);a.show()}),p.addRow(function(a,b){b.w/=2;var c=new m({title:"Tunnel Info Screen 1",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(c.updateData);c.show();b.x=b.w;a=new t({title:"MCARD CAHN Status 1",parent:a,x:b.x,y:b.y,w:b.w,
h:b.h});w.push(a.updateData);a.show()}),p.addRow(function(a,b){b.w/=2;var c=new u({title:"CANH Status 2",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(c.updateData);c.show();b.x=b.w;a=new n({title:"CANH Status 3",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(a.updateData);a.show()}),p.addRow(function(a,b){b.w/=2;var c=new h({title:"CANH Status 4",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(c.updateData);c.show();b.x=b.w;a=new z({title:"CANH Status 5",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(a.updateData);
a.show()}),p.addRow(function(a,b){b.w/=2;var c=new x({title:"CANH Status 6",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(c.updateData);c.show();b.x=b.w;a=new k({title:"Operational Status",parent:a,x:b.x,y:b.y,w:b.w,h:b.h});w.push(a.updateData);a.show()}))};this.refresh=function(){for(var a=0;a<w.length;a++)w[a]()}};module.exports.NetworkConnectionsView=NetworkConnectionsView;
var OperationalStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.4);c.addRow("Param","Status");c.addRow("eSTB IP","OK");c.addRow("eCM IP","OK");c.addRow("Card Return Path","OK");c.addRow("Time Zone","OK");c.addRow("Local Time","OK");c.addRow("CA System","OK");c.addRow("CP System","OK");c.addRow("DSG/Card VCT-Id","OK");c.addRow("DSG UCID","OK");c.addRow("DSG Status","OK");c.addRow("CM Status",
"OK");c.addRow("Channel Map","OK")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"}               ]}').then(function(a){console.log("got successful response from tr69 service");console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},
function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.OperationalStatus=OperationalStatus;
var TunerStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.5);e["Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"]=c.addRowLeft("TRM eSTB MAC","TODO");e["Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewayMoCAMAC"]=c.addRowLeft("TRM MoCA MAC","TODO")};this.updateData=function(){d.doHttpPost({hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}},'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewayMoCAMAC"}               ]}').then(function(a){for(var b=
0;b<a.paramList.length;b++)void 0!==e[a.paramList[b].name]&&(e[a.paramList[b].name].text=a.paramList[b].value)},function(a){})}};module.exports.TunerStatus=TunerStatus;
var TunnelInfoScreenStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.5);c.addRowLeft("Tunnel ID 1","TODO");c.addRowLeft("MAC Addr 1","TODO");c.addRowLeft("Src IP/Mask 1","TODO");c.addRowLeft("Dest. IP 1","TODO");c.addRowLeft("UDP Port Range 1","TODO");c.addRowLeft("UCIDs","TODO");c.addRowRight("Tunnel ID 2","TODO");c.addRowRight("MAC Addr 2","TODO");c.addRowRight("Src IP/Mask 2","TODO");c.addRowRight("Dest. IP 2",
"TODO");c.addRowRight("UDP Port Range 2","TODO");c.addRowRight("UCIDs","TODO")};this.updateData=function(){var a={hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}};d.doHttpPost(a,'{"paramList" : [               {"name" : "Device.DeviceInfo.X_COMCAST-COM_STB_MAC"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.TRM.trmGatewaySTBMAC"},               {"name" : "Device.Time.LocalTimeZone"}               ]}').then(function(a){console.log("got successful response from tr69 service");
console.log("parse value is "+a.paramList[0].value);for(var b=0;b<a.paramList.length;b++)e[a.paramList[b].name].text=a.paramList[b].value},function(b){console.log("inside errorCallback");console.log("Error: FAILED from web service ["+a.hostname+":"+a.port+"]")})}};module.exports.TunnelInfoScreenStatus=TunnelInfoScreenStatus;
var VodStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.3);e["Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreVodId"]=c.addRow("VOD ID","TODO")};this.updateData=function(){d.doHttpPost({hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}},'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreVodId"}               ]}').then(function(a){for(var b=
0;b<a.paramList.length;b++)void 0!==e[a.paramList[b].name]&&(e[a.paramList[b].name].text=a.paramList[b].value)},function(a){})}};module.exports.VodStatus=VodStatus;
function WifiPassword(a,b){var d=b.keys,e=b.Colors,c=b.device,f=b.EditBox,l=b.Keyboard,q=b.eventManager;b=b.parent;var g=this,m=null,t=a.alignHorizontal.CENTER,u=a.alignVertical.CENTER,n=global.registry.baseUrl;this.sans_default=a.create({t:"fontResource",url:n+"/fonts/DejaVuSans.ttf"});this.container=a.create({t:"rect",parent:b,w:b.w,h:b.h,fillColor:808464639,interactive:!1});this.title=a.create({t:"textBox",parent:this.container,textColor:e.WHITE,x:a.w/2-150,y:0,w:300,h:40,pixelSize:28,
text:"Wi-Fi password",font:this.sans_default,alignHorizontal:t,alignVertical:u});this.subTitle=a.create({t:"textBox",parent:this.container,textColor:e.WHITE,x:a.w/2-200,y:this.title.y+50,w:400,h:30,pixelSize:20,text:"Enter the password for "+c.ssid,font:this.sans_default,alignHorizontal:t,alignVertical:u,a:.8});this.subTitle1=a.create({t:"rect",parent:this.container,x:a.w/2-200,y:this.subTitle.y+35,w:400,h:50,lineWidth:4,lineColor:e.BACKGROUND1,fillColor:e.TRANSPARENT});this.inputBox=
new f({parent:this.subTitle1,x:5,w:this.subTitle1.w-10,h:this.subTitle1.h,pts:30,text_color:4294967295,font:n+"/fonts/DejaVuSans.ttf"});this.checkbox=a.create({t:"rect",parent:this.container,x:this.subTitle1.x,y:this.subTitle1.y+60,w:30,h:30,lineWidth:4,lineColor:e.BACKGROUND1,fillColor:e.TRANSPARENT});this.checkResource=a.create({t:"imageResource",w:16,h:16,url:n+"/images/check.svg"});this.checkImage=a.create({t:"image",parent:this.checkbox,w:this.checkbox.w,h:this.checkbox.h,x:7,y:7,resource:this.checkResource,
a:0});this.showPasswordText=a.create({t:"textBox",parent:this.container,textColor:e.WHITE,x:this.checkbox.x+40,y:this.subTitle1.y+60,w:400,h:30,pixelSize:20,text:"Show password",font:this.sans_default,alignVertical:u});this.cancelRect=a.create({t:"rect",parent:this.container,x:this.subTitle1.x+this.subTitle1.w-220,y:this.subTitle1.y+110,w:100,h:40,fillColor:e.BTNBACKGROUND});this.cancelText=a.create({t:"textBox",parent:this.cancelRect,textColor:e.WHITE,w:this.cancelRect.w,h:this.cancelRect.h,
pixelSize:20,text:"Cancel",font:this.sans_default,alignHorizontal:t,alignVertical:u});this.connectRect=a.create({t:"rect",parent:this.container,x:this.cancelRect.x+this.cancelRect.w+20,y:this.subTitle1.y+110,w:100,h:40,fillColor:e.BTNBACKGROUND});this.connectText=a.create({t:"textBox",parent:this.connectRect,textColor:e.WHITE,w:this.connectRect.w,h:this.connectRect.h,pixelSize:20,text:"Connect",font:this.sans_default,alignHorizontal:t,alignVertical:u});this.loadingContainer=a.create({t:"object",
parent:this.container,w:60,h:14,x:this.container.w/2-40,y:this.container.h-300,a:0,interactive:!1});this.whiteCircleResource=a.create({t:"imageResource",w:16,h:16,url:n+"/images/whiteCircle.svg"});this.grayCircleResource=a.create({t:"imageResource",w:14,h:14,url:n+"/images/grayCircle.svg"});this.circle1=a.create({t:"image",parent:this.loadingContainer,w:14,h:14,x:0,resource:this.grayCircleResource});this.circle2=a.create({t:"image",parent:this.loadingContainer,w:14,h:14,x:23,resource:this.grayCircleResource});
this.circle3=a.create({t:"image",parent:this.loadingContainer,w:14,h:14,x:46,resource:this.grayCircleResource});this.circle4=a.create({t:"image",parent:this.loadingContainer,w:16,h:16,x:-1,y:-1,resource:this.whiteCircleResource});var h=[-1,22,45,45];this.keyboardContainer=a.create({t:"object",parent:this.container,w:b.w,h:250,y:this.container.h-250,interactive:!1});m=new l(a,{eventManager:q,keys:d,Colors:e,parent:this.keyboardContainer});var z=null,x=0;this.showLoadingIndicator=function(a){a?(g.loadingContainer.a=
1,z=setInterval(function(){x++;3<x&&(x=0);g.circle4.x=h[x]},300)):(z&&clearInterval(z),g.loadingContainer.a=0)};this.setFocus=function(a){g.inputBox.focus=a};this.show=function(){g.inputBox.focus=!0};this.onKeyDown=function(a){var b=a.keyCode;b===d.DOWN?g.inputBox.focus&&(g.checkbox.lineColor=e.HIGHLIGHT,g.checkbox.focus=!0):b===d.UP&&m.focus&&(m.focus=!1,g.connectRect.focus=!0,g.connectRect.fillColor=e.HIGHLIGHT);a.stopPropagation()};a.root.on("onKeyDown",this.onKeyDown);this.checkbox.on("onKeyDown",
function(a){var b=a.keyCode;b===d.DOWN?(g.checkbox.lineColor=e.BACKGROUND1,g.connectRect.focus=!0,g.connectRect.fillColor=e.HIGHLIGHT,a.stopPropagation()):b===d.UP&&(g.checkbox.lineColor=e.BACKGROUND1,g.inputBox.focus=!0,a.stopPropagation())});this.checkbox.on("onKeyUp",function(a){a.keyCode===d.ENTER&&(0===g.checkImage.a?(g.checkImage.a=1,g.inputBox.echoMode="Normal"):(g.checkImage.a=0,g.inputBox.echoMode="Password"))});this.connectRect.on("onKeyDown",function(a){var b=a.keyCode;b===d.DOWN?(m.focus=
!0,g.connectRect.fillColor=e.BTNBACKGROUND,a.stopPropagation()):b===d.UP?(g.connectRect.fillColor=e.BTNBACKGROUND,g.checkbox.lineColor=e.HIGHLIGHT,g.checkbox.focus=!0,a.stopPropagation()):b===d.LEFT&&(g.cancelRect.focus=!0,g.cancelRect.fillColor=e.HIGHLIGHT,g.connectRect.fillColor=e.BTNBACKGROUND,a.stopPropagation())});this.connectRect.on("onKeyUp",function(a){a.keyCode===d.ENTER&&(g.showLoadingIndicator(!0),q.fireEvent("connectRequest",{ssid:c.ssid,password:g.inputBox.text,security:c.security}))});
this.cancelRect.on("onKeyDown",function(a){var b=a.keyCode;b===d.DOWN?(m.focus=!0,g.cancelRect.fillColor=e.BTNBACKGROUND,a.stopPropagation()):b===d.UP?(g.cancelRect.fillColor=e.BTNBACKGROUND,g.checkbox.lineColor=e.HIGHLIGHT,g.checkbox.focus=!0,a.stopPropagation()):b===d.RIGHT&&(g.connectRect.focus=!0,g.connectRect.fillColor=e.HIGHLIGHT,g.cancelRect.fillColor=e.BTNBACKGROUND,a.stopPropagation())});this.cancelRect.on("onKeyUp",function(a){a.keyCode===d.ENTER&&(g.unRegisterCallbacks(),g.showLoadingIndicator(!1),
g.container.removeAll(),g.container.remove(),q.fireEvent("wifiPasswordClose"),delete g)});this.keyPressed=function(a){"Enter"==a?(g.showLoadingIndicator(!0),q.fireEvent("connectRequest",{ssid:c.ssid,password:g.inputBox.text,security:c.security})):g.inputBox.onchar=a};this.onWIFIStateChanged=function(a){5==a.state?(console.log("success",a),g.unRegisterCallbacks(),g.showLoadingIndicator(!1),g.container.removeAll(),g.container.remove(),q.fireEvent("wifiPasswordClose"),delete g):console.log("onWIFIStateChanged failed")};
this.onError=function(a){g.showLoadingIndicator(!1)};this.onPairingStateChanged=function(a){"PAIRED"==a?(console.log("success",a),g.unRegisterCallbacks(),g.showLoadingIndicator(!1),g.container.removeAll(),g.container.remove(),q.fireEvent("wifiPasswordClose"),delete g):console.log("onPairingStateChanged failed")};this.unRegisterCallbacks=function(){q.delListener("onkeyPressed",g.keyPressed);q.delListener("onWIFIStateChanged",g.onWIFIStateChanged);q.delListener("onPairingStateChanged",g.onPairingStateChanged);
q.delListener("onError",this.onError);a.root.delListener("onKeyDown",g.onKeyDown)};q.on("onkeyPressed",this.keyPressed);q.on("onWIFIStateChanged",this.onWIFIStateChanged);q.on("onPairingStateChanged",this.onPairingStateChanged);q.on("onError",this.onError)}module.exports.WifiPassword=WifiPassword;
function WifiScreen(a,b){function d(){this.createUI=function(a){this.device=a.device;this.animate=400>a.y;this.signalImage=function(a){return-50<=a?h.signalEResource:-60<=a&&-50>a?h.signalGResource:-70<=a&&-60>a?h.signalFResource:h.signalWResource};this.itemRoot=e.create({t:"rect",parent:a.parent,x:0,y:a.y,w:a.w,h:a.h,fillColor:a.fillColor,a:this.animate?0:1,sx:this.animate?.5:1,sy:this.animate?.5:1,cx:a.w/2,cy:a.h/2});this.signalImageBG=e.create({t:"image",parent:this.itemRoot,w:40,h:40,x:20,y:10,
resource:h.imageBGResource});this.signalImage=e.create({t:"image",parent:this.signalImageBG,w:30,h:30,x:5,y:5,resource:this.signalImage(this.device.signalStrength)});this.securityImage=e.create({t:"image",parent:this.itemRoot,w:22,h:30,x:75,y:this.itemRoot.h/2-10,a:0<this.device.security?1:0,resource:h.securityResource});this.deviceName=e.create({t:"textBox",parent:this.itemRoot,textColor:f.TEXT,font:h.sans_default,w:this.itemRoot.w,h:this.itemRoot.h,x:110,pixelSize:25,text:a.name,alignHorizontal:v,
alignVertical:A});this.deviceNameMargineLine=e.create({t:"rect",parent:this.itemRoot,w:this.itemRoot.w,h:2,y:this.itemRoot.h-2,fillColor:f.BLACK,a:.3});this.connectBG=e.create({t:"image",parent:this.itemRoot,w:120,h:30,x:this.itemRoot.w-180,y:this.itemRoot.h/2-15,resource:h.connectBGResource});this.status=e.create({t:"textBox",parent:this.connectBG,textColor:f.LIST_HIGHLIGHT,font:h.sans_default,w:this.connectBG.w,h:this.connectBG.h,pixelSize:15,text:this.device.connected?"CONNECTED":"CONNECT",
alignHorizontal:p,alignVertical:A});this.moreOptions=e.create({t:"object",parent:this.itemRoot,w:30,h:30,x:this.itemRoot.w-50,y:this.itemRoot.h/2-15,cx:15,cy:15});this.rightImage=e.create({t:"image",parent:this.moreOptions,w:this.moreOptions.w,h:this.moreOptions.h,resource:h.moreOptionsResource});return this.animate?this.itemRoot.animateTo({sx:1,sy:1,a:1},.3,G,C,1):new Promise(function(a,b){a("sucess")})};this.y=function(){return this.itemRoot.y};this.selectItem=function(a){a?(this.itemRoot.fillColor=
f.LIST_HIGHLIGHT,this.deviceName.textColor=f.WHITE,this.connectBG.resource=h.connectBGHLResource):(this.itemRoot.fillColor=f.LIST_NORMAL,this.deviceName.textColor=f.TEXT,this.connectBG.resource=h.connectBGResource);this.rightImage.resource=h.moreOptionsResource};this.updateStatus=function(a){var b=this;this.status.text=a;setTimeout(function(){b.status.text=b.device.connected?"CONNECTED":"CONNECT"},3E4)};this.selectMoreOptions=function(a){a?(this.itemRoot.fillColor=f.LIST_NORMAL,this.deviceName.textColor=
f.TEXT,this.rightImage.resource=h.moreOptionsHLResource,this.connectBG.resource=h.connectBGHLResource):(this.rightImage.resource=h.moreOptionsResource,this.connectBG.resource=h.connectBGResource)};this.isMoreOptionsSelected=function(){return this.rightImage.resource==h.moreOptionsHLResource?!0:!1};this.click=function(a){var b=this;this.rightImage.resource==h.moreOptionsHLResource?(this.moreOptions.animateTo({sx:1.3,sy:1.3},.1,B,C,1).then(function(){b.moreOptions.animateTo({sx:1,sy:1},.1,B,C,1)}),
w=new u(e,{parent:h,eventManager:m,keys:c,baseUrl:n,Colors:f,device:this.device,_owner:g,title:"Network Details",description:this.deviceName.text,w:600,h:250,x:this.itemRoot.x+25,y:this.itemRoot.y+h.scrolledView.y+290,cx:0,cy:0,yes:{text:"Modify"},no:{text:"Forget"}}),w.ready.then(function(){w.show()}).catch(function(a){console.log(a)})):0<this.device.security?(r=new t(e,{eventManager:m,Keyboard:q,EditBox:l,keys:c,Colors:f,parent:h.container,device:this.device}),r.show()):(a.ssid=this.device.ssid,
a.password="",a.security=this.device.security,this.updateStatus("CONNECTING..."),g.fireEvent("connect",a))}}var e=a,c=b.keys;a=b.parent;var f=b.Colors,l=b.EditBox,q=b.Keyboard,g=b.context,m=b.eventManager,t=b.Wifipassword,u=b.NetworkDetails,n=global.registry.baseUrl,h=this,z=-1,x=-1,k=[],r=null,w=null,p=e.alignHorizontal.CENTER,v=e.alignHorizontal.LEFT,A=e.alignVertical.CENTER,B=e.animation.TWEEN_EXP1,G=e.animation.TWEEN_LINEAR,P=e.animation.OPTION_LOOP,C=e.animation.OPTION_FASTFORWARD,D=[],L=[];
this.onPopulateDevices=function(a){D=a;k.length=0;h.scrolledView.y=0;z=x=-1;h.wifiImage.resource=h.wifiWResource;h.deviceName.text="";h.deviceIP.text="";h.loadingIndicator.hide();0==D.length?(h.scrolledView.removeAll(),h.topMargineLine.a=0,0===L.length&&(h.refreshNetworkList.focus=!0,h.refreshNetworkImage.resource=h.refreshNetworkHLResource),h.emptyListText&&h.emptyListText.animateTo({sx:1,sy:1,a:1},.3,B,C,1)):(0===L.length&&(h.refreshNetworkImage.resource=h.refreshNetworkResource,h.refreshNetworkList.focus=
!1,h.scrolledView.focus=!0),h.emptyListText&&h.emptyListText.animateTo({sx:0,sy:0,a:0},.3,B,C,1),h.scrolledView.removeAll(),h.topMargineLine.a=.3,h.populateItem(),h.selectItem(0))};this.onStartDiscovery=function(){h.loadingIndicator.show()};this.onError=function(){h.loadingIndicator.hide()};this.onPopupClose=function(){h.scrolledView.focus=!0};this.onWifiPasswordClose=function(){delete r;r=null;h.scrolledView.focus=!0};this.onConnectRequest=function(a){g.fireEvent("connect",a)};this.onWIFIStateChanged=
function(a){m.fireEvent("onWIFIStateChanged",a)};this.onError=function(a){m.fireEvent("onError",a)};this.onPairingStateChanged=function(a){m.fireEvent("onPairingStateChanged",a)};this.setIPAddress=function(a){h.deviceIP.text=a};m.on("wifiPasswordClose",this.onWifiPasswordClose);m.on("connectRequest",this.onConnectRequest);Object.defineProperty(this,"focus",{set:function(a){this.refreshNetworkImage.resource=a?h.refreshNetworkHLResource:h.refreshNetworkResource;this.refreshNetworkList.focus=a},get:function(){return this.refreshNetworkList.focus}});
this.sans_default=e.create({t:"fontResource",url:n+"/fonts/DejaVuSans.ttf"});this.xfinity_sans_medium=e.create({t:"fontResource",url:n+"/fonts/DejaVuSans.ttf"});this.container=e.create({t:"object",parent:a,w:a.w,h:a.h,interactive:!1});this.title=e.create({t:"textBox",parent:this.container,textColor:f.TEXT,x:15,y:20,w:650,h:40,pixelSize:28,text:"Xfinity WiFi Settings",cx:325,cy:20,font:this.sans_default,alignHorizontal:v,alignVertical:A});this.rightLayout=e.create({t:"object",
parent:this.container,w:350,h:e.h-250,x:800,y:80});this.refreshNetworkResource=e.create({t:"imageResource",url:n+"/images/refreshNetwork.svg",w:350,h:50});this.refreshNetworkHLResource=e.create({t:"imageResource",url:n+"/images/refreshNetworkHL.svg",w:350,h:50});this.refreshNetworkImage=e.create({t:"image",parent:this.rightLayout,w:350,h:50,x:0,y:this.rightLayout.h-100,resource:this.refreshNetworkResource});this.refreshNetworkList=e.create({t:"textBox",parent:this.refreshNetworkImage,textColor:f.WHITE,
w:this.refreshNetworkImage.w,h:this.refreshNetworkImage.h,pixelSize:28,text:"Refresh Network List",alignHorizontal:p,alignVertical:A,font:this.sans_default,cx:this.refreshNetworkImage.w/2,cy:this.refreshNetworkImage.h/2});this.rightSidecontainer=e.create({t:"object",parent:this.container,w:300,h:a.h,x:a.w-450,interactive:!1});this.wifiWResource=e.create({t:"imageResource",url:n+"/images/wifiW.svg",w:120,h:120});this.wifiFResource=e.create({t:"imageResource",url:n+"/images/wifiF.svg",w:120,
h:120});this.wifiGResource=e.create({t:"imageResource",url:n+"/images/wifiG.svg",w:120,h:120});this.wifiEResource=e.create({t:"imageResource",url:n+"/images/wifiE.svg",w:120,h:120});this.wifiImage=e.create({t:"image",parent:this.rightLayout,w:120,h:120,x:this.rightLayout.w/2-60,y:80,resource:this.wifiWResource});this.deviceName=e.create({t:"textBox",parent:this.rightLayout,textColor:f.WHITE,x:this.rightLayout.w/2-150,y:200,w:300,h:100,pixelSize:24,text:"",font:this.sans_default,alignHorizontal:p});
this.deviceIP=e.create({t:"textBox",parent:this.rightLayout,textColor:f.WHITE,x:this.rightLayout.w/2-150,y:230,w:300,h:100,pixelSize:24,text:"",font:this.sans_default,alignHorizontal:p});this.listviewParent=e.create({t:"rect",parent:this.container,w:650,h:e.h-250,x:15,y:80,fillColor:f.LISTPARENT,interactive:!1});this.header=e.create({t:"textBox",parent:this.listviewParent,textColor:f.HEADER,x:20,y:20,w:630,h:40,pixelSize:28,text:"Wireless Network Connections",font:this.sans_default,
alignHorizontal:v,alignVertical:A});this.listview=e.create({t:"object",parent:this.listviewParent,x:0,y:80,w:this.listviewParent.w,h:this.listviewParent.h-80,clip:!0});this.emptyListText=e.create({t:"textBox",parent:this.listview,textColor:f.TEXT,x:0,y:-80,w:this.listview.w,h:this.listview.h,pixelSize:25,text:"No Wi-Fi network found.",alignHorizontal:p,alignVertical:A,cx:this.listview.w/2,cy:this.listview.h/2,font:this.sans_default});this.scrolledView=e.create({t:"object",parent:this.listview});
this.topMargineLine=e.create({t:"rect",parent:this.listviewParent,w:this.listview.w,h:2,y:78,fillColor:f.BLACK,a:0});this.loadingIndicatorResource=e.create({t:"imageResource",url:n+"/images/loadingIndicator.svg",w:50,h:50});this.loadingIndicator={image:e.create({t:"image",parent:this.listview,w:50,h:50,x:this.listview.w/2-25,y:this.listview.h/2-25,cx:25,cy:25,resource:h.loadingIndicatorResource,a:0,stretchX:e.stretch.STRETCH,stretchY:e.stretch.STRETCH}),animate:null,show:function(){this.animate&&
(this.animate.cancel(),this.animate=null);this.image.a=1;this.animate=this.image.animate({r:360},1.5,e.animation.TWEEN_LINEAR,e.animation.OPTION_REWIND,e.animation.COUNT_FOREVER)},hide:function(){this.animate&&(this.animate.cancel(),this.animate=null);this.image.a=0}};this.moreOptionsResource=e.create({t:"imageResource",w:30,h:30,url:n+"/images/moreOptionsW.svg"});this.moreOptionsHLResource=e.create({t:"imageResource",w:30,h:30,url:n+"/images/moreOptionsHLW.svg"});this.smokecircleResource=e.create({t:"imageResource",
w:34,h:34,url:n+"/images/smokecircle.svg"});this.tickResource=e.create({t:"imageResource",w:25,h:25,url:n+"/images/check.svg"});this.signalWResource=e.create({t:"imageResource",w:28,h:30,url:n+"/images/wifiW.svg"});this.signalFResource=e.create({t:"imageResource",w:28,h:30,url:n+"/images/wifiF.svg"});this.signalGResource=e.create({t:"imageResource",w:28,h:30,url:n+"/images/wifiG.svg"});this.signalEResource=e.create({t:"imageResource",w:28,h:30,url:n+"/images/wifiE.svg"});this.securityResource=e.create({t:"imageResource",
w:22,h:30,url:n+"/images/lock.svg"});this.imageBGResource=e.create({t:"imageResource",w:40,h:40,url:n+"/images/imageBG.svg"});this.connectBGResource=e.create({t:"imageResource",w:120,h:30,url:n+"/images/connectBG.svg"});this.connectBGHLResource=e.create({t:"imageResource",w:120,h:30,url:n+"/images/connectBGHL.svg"});this.populateItem=function(){if(k.length!=D.length){var a=k.length,b=D[a],c=b.ssid;b.connected&&(h.wifiImage.resource=function(a){return-50<=a?h.wifiEResource:-60<=a&&-50>a?h.wifiGResource:
-70<=a&&-60>a?h.wifiFResource:-70>a?h.wifiWResource:h.wifiEResource}(b.signalStrength),h.deviceName.text=c,h.deviceIP.text="",g.fireEvent("getIPAddress",0));var e=new d;k.push(e);e.createUI({parent:this.scrolledView,y:60*a,w:this.listview.w,h:60,fillColor:f.LIST_NORMAL,name:c,device:b}).then(function(){h.populateItem()}).catch(function(a){console.log("promise failed in populateItem")})}};this.selectItem=function(a){var b=k[a],c=-h.scrolledView.y;x=a;0<=z&&k[z].selectItem(!1);k[x].selectItem(!0);z=
x;b.y()<c?(c=-b.y(),h.scrolledView.animateTo({y:c},.1,G,P,1)):b.y()+60-h.listview.h>c&&(c=-(b.y()+60-h.listview.h),h.scrolledView.animateTo({y:c},.1,G,P,1))};this.scrolledView.on("onKeyDown",function(a){var b=a.keyCode,d=k.length;b==c.UP?(h.selectItem(Math.min(Math.max(0,x-1),d-1)),a.stopPropagation()):b==c.DOWN?(x===d-1?(k[x].selectItem(!1),h.refreshNetworkImage.resource=h.refreshNetworkHLResource,h.refreshNetworkList.focus=!0):h.selectItem(Math.min(Math.max(0,x+1),d-1)),a.stopPropagation()):b==
c.LEFT?0<=x&&x<d&&(k[x].isMoreOptionsSelected()?(k[x].selectItem(!0),a.stopPropagation()):(k[x].selectItem(!1),h.scrolledView.focus=!1)):b==c.RIGHT?0<=x&&x<d&&(k[x].isMoreOptionsSelected()?(k[x].selectItem(!1),h.refreshNetworkImage.resource=h.refreshNetworkHLResource,h.refreshNetworkList.focus=!0):k[x].selectMoreOptions(!0),a.stopPropagation()):b==c.ENTER&&a.stopPropagation()});this.scrolledView.on("onKeyUp",function(a){var b=k.length;a.keyCode==c.ENTER&&(0<=x&&x<b&&k[x].click(a),a.stopPropagation(),
console.log("on item click"+x))});this.refreshNetworkList.on("onKeyDown",function(a){var b=a.keyCode;b==c.UP?(k[x].selectItem(!0),h.refreshNetworkImage.resource=h.refreshNetworkResource,h.scrolledView.focus=!0,a.stopPropagation()):b==c.ENTER?(h.refreshNetworkList.animateTo({sx:1.1,sy:1.1},.1,B,C,1).then(function(){h.refreshNetworkList.animateTo({sx:1,sy:1},.1,B,C,1)}),a.stopPropagation(),console.log("this.refreshNetworkList event")):b==c.RIGHT?a.stopPropagation():b==c.LEFT&&(k[x].selectItem(!0),h.refreshNetworkImage.resource=
h.refreshNetworkResource,h.scrolledView.focus=!0,a.stopPropagation(),a.stopPropagation())});this.refreshNetworkList.on("onKeyUp",function(a){a.keyCode==c.ENTER&&g.fireEvent("getAvailableSSIDsAsync",a)})}module.exports.WifiScreen=WifiScreen;
var WifiSettings=function(){function a(){d.doHttpPost({hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}},'{"paramList" : [             {"name" : "Device.DeviceInfo.X_COMCAST-COM_STB_IP"}             ]}').then(function(a){for(var b=0;b<a.paramList.length;b++)if("Device.DeviceInfo.X_COMCAST-COM_STB_IP"===a.paramList[b].name){r.setIPAddress(a.paramList[b].value);break}},function(a){r.setIPAddress("0.0.0.0")})}function b(){this.show=function(a){var b=this;this.toastRoot=
c.create({t:"rect",parent:k,x:k.w/2-a.w/2,y:k.h-100,w:a.w,h:a.h,fillColor:h.TALL_POPPY,a:0,sx:0,sy:0,cx:a.w/2,cy:a.h/2,lineColor:h.WHITE,lineWidth:2});this.deviceName=c.create({t:"textBox",parent:this.toastRoot,textColor:h.WHITE,font:w,w:this.toastRoot.w,h:this.toastRoot.h,pixelSize:25,text:a.message,alignHorizontal:c.alignHorizontal.CENTER,alignVertical:c.alignVertical.CENTER});this.toastRoot.animateTo({sx:1,sy:1,a:1},.3,c.animation.TWEEN_EXP1,c.animation.OPTION_FASTFORWARD,1).then(setTimeout(function(){b.toastRoot.animateTo({y:k.h,
a:0},.3,c.animation.TWEEN_EXP1,c.animation.OPTION_FASTFORWARD,1).then(setTimeout(function(){b.toastRoot.remove();b.toastRoot=null},1E3))},2E3))}}var d=global.registry.all.Utils,e=global.registry.keyCodes,c=global.registry.scene,f=global.registry.all.EditBox,l=global.registry.all.Keyboard,q=global.registry.all.WifiScreen,g=global.registry.all.WifiPassword,m=global.registry.all.WifiEventManager,t=global.registry.all.NetworkDetails,u=global.registry.all.Wifi,n=global.registry.all.BaseEventManager,h=
global.registry.all.Colors,z=global.registry.all.Logger,x=px.getPackageBaseFilePath(),k=null,r=null,w=c.create({t:"fontResource",url:x+"/fonts/DejaVuSans.ttf"}),p={user_accepted_pairing:!1,known_devices:null,discovered_devices:null,paired_devices:null,connected_devices:null,_owner:null,_actions:new Map,_aip:!1,_aip_handler:null,_aip_timeout:30,_aip_timer_id:null,populateDevices:function(){var a=this;this.known_devices=new Map;this._owner.log("Populating devices.");if(this.paired_devices&&0<this.paired_devices.length){for(var b=
$jscomp.makeIterator(this.paired_devices),c=b.next();!c.done;c=b.next())c=c.value,c.connected=!1,this.known_devices.set(c.ssid,c);this._owner.log("Populating devices.",this.paired_devices.length)}if(this.connected_devices&&0<this.connected_devices.length){b=$jscomp.makeIterator(this.connected_devices);for(c=b.next();!c.done;c=b.next())c=c.value,this.known_devices.set(c.ssid,c);this._owner.log("Populating devices.",this.connected_devices.length)}this.discovered_devices&&(this.discovered_devices.forEach(function(b,
c,d){a.known_devices.has(b.ssid)||a.known_devices.set(b.ssid,b)}),this._owner.log("Populating devices.",this.discovered_devices.length));this._owner.log("Populated devices: %s",JSON.stringify(Array.from(this.known_devices.values())))},isPaired:function(a){return this.known_devices?(a=this.known_devices.get(a))&&void 0!==a?a.paired:!1:!1},startAction:function(a,b){this._actions.has(a)&&this._owner.log("Action %s is already started. Overwriting.",a);b||(b={});this._actions.set(a,b);this.action_in_progress=
!0;this._owner.log("Action %s has started.",a)},stopAction:function(a){this._actions.has(a)?(this._actions.delete(a),0===this._actions.size?(this.action_in_progress=!1,this._owner.log("Action %s has stopped.",a)):this._owner.log("Pending actions: %s",Array.from(this._actions.keys()))):this._owner.log("Action %s cannot be stopped because it is not present (was stopped already?). Ignoring.",a)},hasAction:function(a){return this._actions.has(a)},getActionContext:function(a){var b;this._actions.has(a)?
b=this._actions.get(a):this._owner.log("Action %s is not present (was stopped already?). Ignoring.",a);return b},clearActions:function(){this._owner.log("Clearing actions");this.action_in_progress?(this._owner.log("Removing: %s",Array.from(this._actions.keys())),this._actions.clear()):this._owner.log("Nothing to clear.")},setOwner:function(a){if("null"===a||"object"!==typeof a)return!1;this._owner=a;return!0},setTimeOutHandler:function(a,b){if("null"===this._owner||"object"!==typeof this._owner||
"null"===a||"function"!==typeof a||1>b)return!1;this._aip_handler=a;this._aip_timeout=b;return!0}};Object.defineProperties(p,{action_in_progress:{get:function(){return 0<this._actions.size},set:function(a){var b=this;a=!!a;this._owner.log("%s action.",a?"Starting":"Stopping");this._aip_timer_id&&clearTimeout(this._aip_timer_id);a&&0<this._aip_timeout&&null!==this._aip_handler&&null!==this._owner&&"function"===typeof this._aip_handler&&"object"===typeof this._owner&&(this._aip_timer_id=setTimeout(function(){b._aip_handler.apply(b._owner,
arguments)},1E3*this._aip_timeout))}}});var v={__proto__:Object.create(n.prototype),name:"Wifi Settings",screen:null,identity:{name:"app",version:"1.0.8.12",marker:{left:"{ ",right:" } "}},_options:{emulation:!1,debug:!1},api:null,_payload:{},availableDevicesTimer:null,api_event_listeners:new Map,event_listeners:new Map,screen_event_sets:new Map,init:function(a){this.log("Init started.");var b=a.api_version;this.api=new u(c,a.service);this.updateEventListeners();this.api.init(b);p.setOwner(this);
p.setTimeOutHandler(this._handleTimeOut,30)||this.log("Timeout handler wasn't set");this.log("Init completed. Api version: %s",a.api_version)},updateEventListeners:function(){this.log("Updating event listeners");for(var a=this,b={},c=$jscomp.makeIterator(this.api_event_listeners.entries()),d=c.next();!d.done;b={$jscomp$loop$prop$value$69:b.$jscomp$loop$prop$value$69},d=c.next()){d=$jscomp.makeIterator(d.value);var e=d.next().value;b.$jscomp$loop$prop$value$69=d.next().value;this.api.on(e,function(b){return function(c){b.$jscomp$loop$prop$value$69.apply(a,
arguments)}}(b))}b={};c=$jscomp.makeIterator(this.event_listeners.entries());for(d=c.next();!d.done;b={$jscomp$loop$prop$value$53$71:b.$jscomp$loop$prop$value$53$71},d=c.next())d=$jscomp.makeIterator(d.value),e=d.next().value,b.$jscomp$loop$prop$value$53$71=d.next().value,this.on(e,function(b){return function(c){b.$jscomp$loop$prop$value$53$71.apply(a,arguments)}}(b));this.log("Event listeners are set")},run:function(){this.log("Enabling bluetooth.");this.fireEvent("onStartingUp",{})},getData:function(){return this._payload},
updateSceneDetails:function(a,b){switch(a){case "populateDevices":if(p.known_devices)r.onPopulateDevices(Array.from(p.known_devices.values()));break;case "pairingRequest":r.onPairingRequest(b);break;case "connectionRequest":r.onConnectionRequest(b)}}};n.call(v);z.call(Object.getPrototypeOf(v));v.api_event_listeners.set("onError",function(a){this.log("API event: onError.",JSON.stringify(a));r.onError(a);(new b).show({message:"A connection error has occurred ",w:600,h:50})});v.api_event_listeners.set("onSSIDsChanged",
function(a){this.log("API event: onSSIDsChanged.");this.log(JSON.stringify(a))});v.api_event_listeners.set("onPairingStateChanged",function(a){this.log("API event: onPairingStateChanged.");this.log(JSON.stringify(a));r.onPairingStateChanged(a)});v.api_event_listeners.set("onWPSPairingButtonPressed",function(a){this.log("API event: onWPSPairingButtonPressed.");this.log(JSON.stringify(a))});v.api_event_listeners.set("onWifiSignalThresholdChanged",function(a){this.log("API event: onWifiSignalThresholdChanged.");
this.log(JSON.stringify(a))});v.api_event_listeners.set("onWIFIStateChanged",function(a){this.log("API event: onWIFIStateChanged.",JSON.stringify(a));if(5==a.state){var b=this.api.getConnectedSSID();this.log("API event: onWIFIStateChanged. connected devices",b);var c=null;if(b.hasOwnProperty("SSID")){var d=b.SSID;d.hasOwnProperty("ssid")&&0<d.ssid.length&&(c=b.SSID)}p.connected_devices=[];c&&(c.connected=!0,c.hasOwnProperty("security")||(c.security=2),p.connected_devices.push(c),this.log("Device %s added to connected devices",
c.ssid));p.populateDevices();this.updateSceneDetails("populateDevices")}r.onWIFIStateChanged(a)});v.api_event_listeners.set("onAvailableSSIDs",function(a){this.log("API event: onAvailableSSIDs.");this.log(JSON.stringify(a));var b;a.hasOwnProperty("SSIDs")&&(b=a.SSIDs);p.discovered_devices=new Map;a=$jscomp.makeIterator(b);for(b=a.next();!b.done;b=a.next())b=b.value,p.discovered_devices.has(b.ssid)||(b.connected=!1,p.discovered_devices.set(b.ssid,b),this.log("Device %s added to known devices",b.ssid));
p.populateDevices();this.updateSceneDetails("populateDevices")});v.event_listeners.set("onStartingUp",function(a){this.log("Handling onStartingUp event.");a=this.api.getConnectedSSID();this.log("API event: onStartingUp.",a);var b=null;if(a.hasOwnProperty("SSID")){var c=a.SSID;c.hasOwnProperty("ssid")&&0<c.ssid.length&&(b=a.SSID)}p.connected_devices=[];b&&0<Object.keys(b).length&&(b.connected=!0,b.hasOwnProperty("security")||(b.security=2),p.connected_devices.push(b),this.log("Device %s added to connected devices",
b.ssid));p.populateDevices();this.log("Handling onStartingUp event: done.")});v.event_listeners.set("setEnabled",function(a){this.api.setEnabled(a.enable)});v.event_listeners.set("getAvailableSSIDsAsync",function(){r.onStartDiscovery();var a=this.api.getAvailableSSIDs();this.log(JSON.stringify(a));var b;a.hasOwnProperty("SSIDs")&&(b=a.SSIDs);p.discovered_devices=new Map;b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next())c=c.value,p.discovered_devices.has(c.ssid)||(c.connected=!1,p.discovered_devices.set(c.ssid,
c),this.log("Device %s added to known devices",c.ssid));p.populateDevices();this.updateSceneDetails("populateDevices");this.log("getAvailableSSIDsAsync Status: ",a.success)});v.event_listeners.set("getIPAddress",function(b){a()});v.event_listeners.set("connect",function(a){a=this.api.connect(a.ssid,a.password,a.security);this.log("connect Status: %s",JSON.stringify(a))});v.event_listeners.set("onclearSSID",function(a){console.log("#####################onclearSSID");a=this.api.clearSSID();if(1==a.success){this.log("ssids cleared");
var b=this.api.getConnectedSSID(),c=null;if(b.hasOwnProperty("SSID")){var d=b.SSID;d.hasOwnProperty("ssid")&&0<d.ssid.length&&(c=b.SSID)}p.connected_devices=[];c&&(c.connected=!0,c.hasOwnProperty("security")||(c.security=2),p.connected_devices.push(c),this.log("Device %s added to connected devices",c.ssid));p.populateDevices();this.updateSceneDetails("populateDevices")}this.log("onclearSSID Status: %s",JSON.stringify(a))});this.isBluetoothScreen=!0;this.setService=function(a){v.init({service:a,api_version:4});
v.run()};this.show=function(a){a.clear();a.addRow(function(a,b){b.h=580;k=c.create({t:"object",parent:a,w:b.w,h:b.h,x:b.x,y:b.y});r=new q(c,{parent:k,Keyboard:l,eventManager:m,Wifipassword:g,EditBox:f,NetworkDetails:t,keys:e,Popup:null,Colors:h,context:v})})};this.refresh=function(){r.focus=!0;v.updateSceneDetails("populateDevices")}};module.exports.WifiSettings=WifiSettings;
var WifiStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.3);e["Device.WiFi.SSID.1.MACAddress"]=c.addRow("AP MAC","TODO");e["Device.WiFi.SSID.1.Name"]=c.addRow("SSID","TODO");e["Device.WiFi.Radio.1.OperatingFrequencyBand"]=c.addRow("Frequency","TODO");c.addRow("Channel","TODO");c.addRow("SNR","TODO");e["Device.DeviceInfo.X_RDKCENTRAL-COM_xBlueTooth.DeviceInfo.RSSI"]=c.addRow("RSSI","TODO");
c.addRow("Security","TODO")};this.updateData=function(){d.doHttpPost({hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}},'{"paramList" : [               {"name" : "Device.WiFi.SSID.1.Name"},               {"name" : "Device.DeviceInfo.X_RDKCENTRAL-COM_xBlueTooth.DeviceInfo.RSSI"},               {"name" : "Device.WiFi.SSID.1.MACAddress"},               {"name" : "Device.WiFi.Radio.1.OperatingFrequencyBand"}               ]}').then(function(a){for(var b=0;b<a.paramList.length;b++)void 0!==
e[a.paramList[b].name]&&(e[a.paramList[b].name].text=a.paramList[b].value)},function(a){})}};module.exports.WifiStatus=WifiStatus;
var WifiStatus_1=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.3);e["Device.WiFi.SSID.1.Stats.BytesSent"]=c.addRow("BytesSent","TODO");e["Device.WiFi.SSID.1.Stats.BytesReceived"]=c.addRow("BytesReceived","TODO");e["Device.WiFi.SSID.1.Stats.PacketsSent"]=c.addRow("PacketsSent","TODO");e["Device.WiFi.SSID.1.Stats.PacketsReceived"]=c.addRow("PacketsReceived","TODO");c.addRow("RetransCount","TODO");
c.addRow("FailedRetransCount","TODO");c.addRow("RetryCount","TODO");c.addRow("MultipleRetryCount","TODO");c.addRow("ACKFailureCount","TODO");c.addRow("AggregatedPacketCount","TODO");e["Device.WiFi.SSID.1.Stats.ErrorsSent"]=c.addRow("ErrorsSent","TODO");e["Device.WiFi.SSID.1.Stats.ErrorsReceived"]=c.addRow("ErrorsReceived","TODO")};this.updateData=function(){d.doHttpPost({hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}},'{"paramList" : [               {"name" : "Device.WiFi.SSID.1.Stats.BytesSent"},               {"name" : "Device.WiFi.SSID.1.Stats.BytesReceived"},               {"name" : "Device.WiFi.SSID.1.Stats.PacketsSent"},               {"name" : "Device.WiFi.SSID.1.Stats.PacketsReceived"},               {"name" : "Device.WiFi.SSID.1.Stats.ErrorsSent"},               {"name" : "Device.WiFi.SSID.1.Stats.ErrorsReceived"}               ]}').then(function(a){for(var b=
0;b<a.paramList.length;b++)void 0!==e[a.paramList[b].name]&&(e[a.paramList[b].name].text=a.paramList[b].value)},function(a){})}};module.exports.WifiStatus_1=WifiStatus_1;
var XreStatus=function(a){var b=global.registry.all.DetailsItem,d=global.registry.all.Utils,e={};this.show=function(){var c=new b(d.scene,a);c.setSeparatorPlacement(.35);e["Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreVersion"]=c.addRow("XRE Server Version","TBD");e["Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreSessionLastModTs"]=c.addRow("Last XRE Reconnect Date/Time","TODO");e["Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreStatus"]=c.addRow("XRE Connection Status","TODO");e["Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreSessionUptime"]=
c.addRow("XRE Connection Uptime","TODO");e["Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreVodId"]=c.addRow("XRE VOD ID","TODO");e["Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreLastURLAccessed"]=c.addRow("XRE Last URL","https://nexus.teamccp.com/nexus/content/repositories/arris_brcm_xg1v3/images/signing_stage/ARRISXG1V3-Yocto-Build/76112/signed/")};this.updateData=function(){d.doHttpPost({hostname:"127.0.0.1",port:10999,method:"POST",headers:{"Content-Type":"application/json"}},'{"paramList" : [               {"name" : "Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreStatus"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreVersion"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreSessionUptime"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreLastURLAccessed"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreVodId"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreSessionLastModTs"},               {"name" : "Device.X_COMCAST-COM_Xcalibur.Client.XRE.xreLastURLAccessed"}               ]}').then(function(a){for(var b=
0;b<a.paramList.length;b++)void 0!==e[a.paramList[b].name]&&(e[a.paramList[b].name].text=a.paramList[b].value)},function(a){})}};module.exports.XreStatus=XreStatus;
